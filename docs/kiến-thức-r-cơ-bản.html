<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chương 3 Kiến thức R cơ bản | Khoa Học Dữ Liệu trong Kinh tế và Kinh doanh</title>
<meta name="author" content="Nguyễn Quang Huy">
<meta name="description" content="3.1 Làm quen với các dòng lệnh cơ bản Đây là cuốn sách dành cho sinh viên và học viên các ngành kinh tế, quản lý, và quản trị kinh doanh muốn tìm hiểu sang lĩnh vực khoa học dữ liệu. Những bạn đọc...">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="Chương 3 Kiến thức R cơ bản | Khoa Học Dữ Liệu trong Kinh tế và Kinh doanh">
<meta property="og:type" content="book">
<meta property="og:description" content="3.1 Làm quen với các dòng lệnh cơ bản Đây là cuốn sách dành cho sinh viên và học viên các ngành kinh tế, quản lý, và quản trị kinh doanh muốn tìm hiểu sang lĩnh vực khoa học dữ liệu. Những bạn đọc...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chương 3 Kiến thức R cơ bản | Khoa Học Dữ Liệu trong Kinh tế và Kinh doanh">
<meta name="twitter:description" content="3.1 Làm quen với các dòng lệnh cơ bản Đây là cuốn sách dành cho sinh viên và học viên các ngành kinh tế, quản lý, và quản trị kinh doanh muốn tìm hiểu sang lĩnh vực khoa học dữ liệu. Những bạn đọc...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Lora-0.4.8/font.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Source%20Code%20Pro:wght@400;450&amp;display=swap" rel="stylesheet">
<script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="libs/d3-bundle-5.16.0/d3-bundle.min.js"></script><script src="libs/d3-lasso-0.0.5/d3-lasso.min.js"></script><script src="libs/save-svg-as-png-1.4.17/save-svg-as-png.min.js"></script><script src="libs/flatbush-4.0.0/flatbush.min.js"></script><link href="libs/ggiraphjs-0.4.6/ggiraphjs.min.css" rel="stylesheet">
<script src="libs/ggiraphjs-0.4.6/ggiraphjs.min.js"></script><script src="libs/girafe-binding-0.8.8/girafe.js"></script><script src="libs/plotly-binding-4.10.3/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script><script>
        $(function() {
            $("#toc h2").html("TRONG CHƯƠNG NÀY"); // Change text for "View source"
        });
    </script><script>
        document.addEventListener('DOMContentLoaded', function() {
            var viewSourceElement = document.getElementById('book-source');
            var editPageElement = document.getElementById('book-edit');
            var viewBookSourceElement = document.getElementById('book-repo');

            if (viewSourceElement) {
                viewSourceElement.innerText = 'Xem nguồn trang'; // Change text for "View source"
            }

            if (editPageElement) {
                editPageElement.innerText = 'Chỉnh sửa trang'; // Change text for "Edit this page"
            }

            if (viewBookSourceElement) {
                viewBookSourceElement.innerText = 'Xem nguồn sách'; // Change text for "View book source"
            }
        });
    </script><script>
        document.addEventListener('DOMContentLoaded', (event) => {
          var tocElement = document.querySelector('nav[aria-label="Table of contents"] h2');
          if (tocElement) {
            tocElement.textContent = 'Mục lục'; // Replace 'Mục lục' (Table of contents) with your desired text
          }
        });
    </script><script>
      document.addEventListener('DOMContentLoaded', (event) => {
        var tocElement = document.querySelector('nav[aria-label="Table of contents"] h2');
        if (tocElement) {
          tocElement.textContent = 'NỘI DUNG CUỐN SÁCH'; // Ensure "NỘI DUNG CUỐN SÁCH" text remains
        }
      });
    </script><script>
        document.addEventListener('DOMContentLoaded', (event) => {
          // Find the paragraph containing the original text and date
          const paragraph = document.querySelector('footer.bg-primary.text-light div.container div.row div.col-12.col-md-6.mt-3 p');

          if (paragraph) {
            // Extract the date using a regular expression
            const dateRegex = /(\d{4}-\d{2}-\d{2})/;
            const matches = paragraph.innerHTML.match(dateRegex);

            if (matches && matches.length > 1) {
              // Reformat the date from yyyy-mm-dd to dd/mm/yyyy
              const originalDate = matches[1];
              const [year, month, day] = originalDate.split('-');
              const newDate = `${day}/${month}/${year}`;

              // Replace the entire paragraph content with the new Vietnamese format
              paragraph.innerHTML = `Cuốn sách "${paragraph.querySelector('strong').innerText}" được viết bởi TS. ${paragraph.innerHTML.split('was written by ')[1].split('. ')[0]} - Trường Công nghệ - Đại học Kinh tế Quốc dân`;
            }
          }
        });
    </script><script>
        document.addEventListener('DOMContentLoaded', (event) => {
          // Find the paragraph containing the specific text
          const paragraphs = document.querySelectorAll('footer.bg-primary.text-light div.container div.row div.col-12.col-md-6.mt-3 p');
          paragraphs.forEach(paragraph => {
            if(paragraph.innerHTML.includes('This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.')) {
              // Replace the paragraph content
              paragraph.innerHTML = 'Cuốn sách này được viết bằng hoàn toàn bằng ngôn ngữ R. Phiên bản hiện tại được cập nhật vào ngày ${newDate}.';
            }
          });
        });
    </script><script src="local_edit.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Khoa Học Dữ Liệu trong Kinh tế và Kinh doanh</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Lời nói đầu</a></li>
<li class="book-part">PHẦN I: GIỚI THIỆU CHUNG</li>
<li><a class="" href="gi%E1%BB%9Bi-thi%E1%BB%87u-v%E1%BB%81-cu%E1%BB%91n-s%C3%A1ch.html"><span class="header-section-number">1</span> Giới thiệu về cuốn sách</a></li>
<li><a class="" href="khdl-v%C3%A0-c%C3%A1c-kh%C3%A1i-ni%E1%BB%87m-c%C6%A1-b%E1%BA%A3n.html"><span class="header-section-number">2</span> KHDL và các khái niệm cơ bản</a></li>
<li class="book-part">PHẦN II: GIỚI THIỆU VỀ R</li>
<li><a class="active" href="ki%E1%BA%BFn-th%E1%BB%A9c-r-c%C6%A1-b%E1%BA%A3n.html"><span class="header-section-number">3</span> Kiến thức R cơ bản</a></li>
<li><a class="" href="ki%E1%BA%BFn-th%E1%BB%A9c-r-c%C6%A1-b%E1%BA%A3n-1.html"><span class="header-section-number">4</span> Kiến thức R cơ bản</a></li>
<li><a class="" href="ki%E1%BA%BFn-th%E1%BB%A9c-r-n%C3%A2ng-cao.html"><span class="header-section-number">5</span> Kiến thức R nâng cao</a></li>
<li class="book-part">PHẦN III: PHÂN TÍCH DỮ LIỆU</li>
<li><a class="" href="nh%E1%BA%ADp-d%E1%BB%AF-li%E1%BB%87u-v%C3%A0o-r.html"><span class="header-section-number">6</span> Nhập dữ liệu vào R</a></li>
<li><a class="" href="ti%E1%BB%81n-x%E1%BB%AD-l%C3%BD-d%E1%BB%AF-li%E1%BB%87u.html"><span class="header-section-number">7</span> Tiền xử lý dữ liệu</a></li>
<li><a class="" href="bi%E1%BA%BFn-%C4%91%E1%BB%95i-v%C3%A0-s%E1%BA%AFp-x%E1%BA%BFp-d%E1%BB%AF-li%E1%BB%87u.html"><span class="header-section-number">8</span> Biến đổi và sắp xếp dữ liệu</a></li>
<li><a class="" href="tr%E1%BB%B1c-quan-h%C3%B3a-d%E1%BB%AF-li%E1%BB%87u.html"><span class="header-section-number">9</span> Trực quan hóa dữ liệu</a></li>
<li class="book-part">PHẦN IV: MÔ HÌNH TUYẾN TÍNH</li>
<li><a class="" href="m%C3%B4-h%C3%ACnh-h%E1%BB%93i-quy-tuy%E1%BA%BFn-t%C3%ADnh.html"><span class="header-section-number">10</span> Mô hình hồi quy tuyến tính</a></li>
<li><a class="" href="c%C3%A1c-m%C3%B4-h%C3%ACnh-c%E1%BB%99ng-t%C3%ADnh-t%E1%BB%95ng-qu%C3%A1t.html"><span class="header-section-number">11</span> Các mô hình cộng tính tổng quát</a></li>
<li><a class="" href="m%C3%B4-h%C3%ACnh-tuy%E1%BA%BFn-t%C3%ADnh-t%E1%BB%95ng-qu%C3%A1t..html"><span class="header-section-number">12</span> Mô hình tuyến tính tổng quát.</a></li>
<li><a class="" href="m%C3%B4-h%C3%ACnh-t%E1%BA%A7n-su%E1%BA%A5t---m%E1%BB%A9c-%C4%91%E1%BB%99-nghi%C3%AAm-tr%E1%BB%8Dng..html"><span class="header-section-number">13</span> Mô hình tần suất - mức độ nghiêm trọng.</a></li>
<li><a class="" href="t%C3%ADnh-to%C3%A1n-ph%C3%AD-b%E1%BA%A3o-hi%E1%BB%83m-thu%E1%BA%A7n-b%E1%BA%B1ng-m%C3%B4-h%C3%ACnh-t%E1%BA%A7n-su%E1%BA%A5t---m%E1%BB%A9c-%C4%91%E1%BB%99-nghi%C3%AAm-tr%E1%BB%8Dng..html"><span class="header-section-number">14</span> Tính toán phí bảo hiểm thuần bằng mô hình tần suất - mức độ nghiêm trọng.</a></li>
<li class="book-part">PHẦN V: MÔ HÌNH CÂY QUYẾT ĐỊNH</li>
<li><a class="" href="m%C3%B4-h%C3%ACnh-c%C3%A2y-quy%E1%BA%BFt-%C4%91%E1%BB%8Bnh.html"><span class="header-section-number">15</span> Mô hình cây quyết định</a></li>
<li><a class="" href="boosting-v%C3%A0-c%C3%A2y-quy%E1%BA%BFt-%C4%91%E1%BB%8Bnh..html"><span class="header-section-number">16</span> Boosting và cây quyết định.</a></li>
<li><a class="" href="neuralnetwork.html"><span class="header-section-number">17</span> Mô hình mạng nơ-ron</a></li>
<li><a class="" href="neuralnetwork1.html"><span class="header-section-number">18</span> Các mạng học sâu điển hình</a></li>
<li><a class="" href="h%E1%BB%8Dc-m%C3%A1y-kh%C3%B4ng-c%C3%B3-gi%C3%A1m-s%C3%A1t.html"><span class="header-section-number">19</span> Học máy không có giám sát</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/NEUKhoaToanKT/Khoa_hoc_du_lieu_trong_KTKD">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="kiến-thức-r-cơ-bản" class="section level1" number="3">
<h1>
<span class="header-section-number">Chương 3</span> Kiến thức R cơ bản<a class="anchor" aria-label="anchor" href="#ki%E1%BA%BFn-th%E1%BB%A9c-r-c%C6%A1-b%E1%BA%A3n"><i class="fas fa-link"></i></a>
</h1>
<div id="làm-quen-với-các-dòng-lệnh-cơ-bản" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Làm quen với các dòng lệnh cơ bản<a class="anchor" aria-label="anchor" href="#l%C3%A0m-quen-v%E1%BB%9Bi-c%C3%A1c-d%C3%B2ng-l%E1%BB%87nh-c%C6%A1-b%E1%BA%A3n"><i class="fas fa-link"></i></a>
</h2>
<p>Đây là cuốn sách dành cho sinh viên và học viên các ngành kinh tế, quản lý, và quản trị kinh doanh muốn tìm hiểu sang lĩnh vực khoa học dữ liệu. Những bạn đọc đã có nền tảng kiến thức cơ bản về toán học, xác suất thống kê, và lập trình sẽ cảm thấy dễ dàng hơn khi bắt đầu. Cuốn sách sử dụng R làm ngôn ngữ và công cụ chính để thực hiện các thao tác trên dữ liệu.</p>
<p>Nếu bạn đọc đã có nền tảng cơ bản về lập trình thì cuốn sách này không giúp bạn lập trình tốt hơn. Mục đích chính của cuốn sách là giúp bạn có thể sử dụng được R và thực hiện được các thao tác trên dữ liệu trong môi trường R một cách nhanh nhất. Theo quan điểm của chúng tôi, R không phải là một ngôn ngữ thích hợp để bắt đầu cho học lập trình. Muốn trở thành một lập trình viên giỏi, bạn đọc nên bắt đầu với các ngôn ngữ lập trình cơ bản như Pascal, C++, Java, hay cũng có thể bắt đầu với ngôn ngữ Python.</p>
<p>Cách viết các dòng lệnh của R có thể nói là khá tùy tiện, thậm chí có thể làm cho những người có chuyên môn về lập trình cảm thấy khó chịu. Tuy nhiên, như đã đề cập trong phần giới thiệu của cuốn sách, R có các thế mạnh riêng mà các ngôn ngữ khác không có được và chúng tôi tin rằng R có thể giải quyết được tất cả những yêu cầu của bạn đọc từ những yêu cầu đơn giản đến những yêu cầu phức tạp nhất.</p>
<p>Cuốn sách hướng đến cả các bạn đọc chưa từng làm quen với lập trình. Với những ai đã có kinh nghiệm với lập trình có thể bỏ qua các phần không cần thiết như biến, vòng lặp, viết hàm số và có thể bắt đầu ngay kể từ phần phân tích dữ liệu.</p>
<div id="sử-dụng-r-như-một-máy-tính-cầm-tay" class="section level3" number="3.1.1">
<h3>
<span class="header-section-number">3.1.1</span> Sử dụng R như một máy tính cầm tay<a class="anchor" aria-label="anchor" href="#s%E1%BB%AD-d%E1%BB%A5ng-r-nh%C6%B0-m%E1%BB%99t-m%C3%A1y-t%C3%ADnh-c%E1%BA%A7m-tay"><i class="fas fa-link"></i></a>
</h3>
<p>Để R hiểu và thực hiện được các yêu cầu của mình, bạn đọc cần phải viết các câu lệnh dưới ngôn ngữ của phần mềm. Hãy bắt đầu với câu lệnh đầu tiên và đơn giản nhất: hiển thị một giá trị lên cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Console</span>. Trước hết bạn đọc hãy nhấp chuột vào cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Console</span>, sau đó gõ trực tiếp đoạn câu lệnh như ở dưới và kết thúc câu lệnh bằng cách sử dụng phím Enter:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"I am MFEer"</span><span class="op">)</span></span></code></pre></div>
<p>Bạn đọc có thể bắt đầu làm quen với các dòng lệnh của R bằng cách viết lên cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Console</span> các công thức để thực hiện tính toán các phép toán dưới đây. R có thể được sử dụng đơn giản như một máy tính cầm tay:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span><span class="op">+</span><span class="fl">0.001</span></span>
<span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span> <span class="op">-</span> <span class="fl">3</span> <span class="co"># Số pi trong R được viết là pi</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Hàm lũy thừa cơ số tự nhiên.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">3.2</span><span class="op">)</span> <span class="co"># Hàm logarit cơ số tự nhiên.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">10</span><span class="op">)</span> <span class="co"># Hàm logarit cơ số 10.</span></span></code></pre></div>
<p>Một vài lưu ý bạn đọc có thể nhận thấy khi gõ các dòng lệnh ở trên: các phép tính cộng trừ nhân chia, dấu thập phân, dấu lũy thừa,…, hoàn toàn giống như khi sử dụng máy tính cầm tay. Các hàm số quen thuộc như hàm logarit, hàm lũy thừa cơ số tự nhiên cũng không có gì đặc biệt.</p>
<p>Bạn đọc có thể tiếp tục thực hành các câu lệnh cơ bản bằng cách sử dụng R để tính toán kết quả của các biểu thức dưới đây:</p>
<p><span class="math display">\[\begin{align}
a) \ \cfrac{1}{4^{1/6}} \ \ \ b) \ \cfrac{7 - 4}{12 - 7} \ \ \ c) \ \sqrt{\cfrac{4}{22}} \ \ \ d) (12-5)^{4/3} \ \ \ e) \ \log\left( \cfrac{2 + 4}{2^5 -1} \right)
\end{align}\]</span></p>
<p>Khi viết câu lệnh trên cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Console</span>, R luôn thực hiện câu lệnh mỗi khi bạn đọc sử dụng phím Enter. Khi muốn viết hai hay nhiều câu lệnh trên một dòng trên cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Console</span>, bạn đọc hãy ngăn cách các câu lệnh bằng dấu <span style="color: #640514; font-family: Source Code Pro;"> ’’ ; ” </span>. Hãy thử câu lệnh ở dưới và quan sát R cách trả kết quả:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span> <span class="op">-</span> <span class="fl">3</span>; <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Một dòng lệnh thực hiện hai câu lệnh.</span></span></code></pre></div>
<pre><code>## [1] 3.283185</code></pre>
<pre><code>## [1] 2.350402</code></pre>
<p>Khi bạn đọc viết các câu lệnh đơn giản thì sử dụng nhiều phép tính trên một dòng lệnh có thể hạn chế việc dùng phím Enter nhiều lần. Tuy nhiên chúng tôi khuyên bạn đọc khi muốn thực hiện nhiều câu lệnh khác nhau hãy sử dụng cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Script</span> thay vì viết câu lệnh trực tiếp lên cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Console</span>. Phần tiếp theo của chương chúng tôi sẽ thảo luận về cách viết và thực thi câu lệnh trên cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Script</span>.</p>
</div>
<div id="sử-dụng-cửa-sổ-script-để-viết-câu-lệnh" class="section level3" number="3.1.2">
<h3>
<span class="header-section-number">3.1.2</span> Sử dụng cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Script</span> để viết câu lệnh<a class="anchor" aria-label="anchor" href="#s%E1%BB%AD-d%E1%BB%A5ng-c%E1%BB%ADa-s%E1%BB%95-script-%C4%91%E1%BB%83-vi%E1%BA%BFt-c%C3%A2u-l%E1%BB%87nh"><i class="fas fa-link"></i></a>
</h3>
<p>Cách tốt nhất để bạn đọc viết, quản lý, và thực thi câu lệnh đó là sử dụng cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Script</span>. Để mở cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Script</span> trên Rstudio, bạn đọc có thể tìm trên thanh công cụ theo trình tự <em>File</em> <span class="math inline">\(\rightarrow\)</span> <em>New file</em> <span class="math inline">\(\rightarrow\)</span> <em>R Script</em>, hoặc bạn đọc sử dụng tổ hợp phím tắt <em>Ctrl + Shift + N</em>. Khi viết câu lệnh trên cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Script</span>, R chỉ thực hiện câu lệnh khi bạn đọc yêu cầu. Do đó, bạn đọc có thể sử dụng cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Script</span> để viết các chương trình lớn với nhiều dòng lệnh kế tiếp nhau.</p>
<p>Sau khi mở của sổ <span style="color: #640514; font-family: Source Code Pro;">Script</span>, bạn có thể viết các dòng lệnh và sử dụng Enter để xuống dòng và không cần quan tâm đến việc R có thực thi câu lệnh đó hay không. Trong một dòng lệnh trên cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Script</span> mỗi khi bạn đọc sử dụng dấu ngắt câu lệnh “;” R vẫn hiểu rằng bạn đọc đang viết hai câu lệnh khác nhau trên một dòng. Bạn đọc có thể bắt đầu mở cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Script</span> và gõ các dòng lệnh dưới đây:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span><span class="op">+</span><span class="fl">0.001</span> ; <span class="fl">2</span><span class="op">*</span><span class="va">pi</span> <span class="op">-</span> <span class="fl">3</span> ; <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">3.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>Phím Enter cho phép xuống dòng và không thực thi câu lệnh khi bạn đọc viết trên cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Script</span>. Thay vào đó, để thực thi các dòng lệnh, bạn đọc có hai lựa chọn: thứ nhất, sử dụng con trỏ bấm vào nút <em>Run</em> nằm ở phía góc trên bên phải của cửa sổ này, và thứ hai các bạn sử dụng tổ hợp phím tắt <em>Ctrl + Enter</em> nếu bạn sử dụng R trên hệ điều hành Windows và <em>Cmd + Enter</em> nếu bạn sử dụng R trên hệ điều hành MacOS. Để thực thi một dòng lệnh riêng lẻ trên cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Script</span>, bạn đọc di chuyển con trỏ đến dòng lệnh đó và thực hiện thao tác như ở trên. Để thực thi nhiều dòng lệnh bạn đọc sử dụng chuột trái lựa chọn các dòng lệnh và sau đó thực hiện thao tác chạy. Khi lựa chọn nhiều dòng lệnh một lúc để thực thi, R sẽ thực hiện các câu lệnh lần lượt theo thứ tự từ trên xuống dưới và từ bên trái qua bên phải nếu một dòng có nhiều câu lệnh.</p>
<p>Lưu ý, khi bạn đọc viết một chương trình bao gồm nhiều dòng lệnh, bạn thường phải sử dụng ngôn ngữ thông thường và dễ hiểu bằng tiếng Việt, hoặc tiếng Anh, để ghi chú lại các dòng lệnh hoặc nhóm các dòng lệnh đó có ý nghĩa là gì. Việc này giúp cho bản thân bạn khi xem lại các dòng lệnh của mình và cho những người tiếp nhận khi đọc các dòng lệnh hiểu được ý nghĩa của các câu lệnh. Các câu ghi chú đó theo ngôn ngữ lập trình được gọi là các câu ghi chú, hay <em>comment</em>. Bạn đọc sử dụng dấu <span style="color: #640514; font-family: Source Code Pro;">Script</span> bắt đầu trước câu ghi chú:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Đây là cách tính xấp xỉ số e</span></span>
<span><span class="va">n</span><span class="op">&lt;-</span><span class="fl">1000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"e = "</span>, <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="va">n</span><span class="op">)</span><span class="op">^</span><span class="va">n</span><span class="op">)</span> <span class="co"># Khi n càng lớn thì kết quả càng chính xác</span></span></code></pre></div>
<p>Phần tiếp theo của chương sẽ thảo luận về các khái niệm cơ bản nhất trong lập trình, đó là khái niệm về các kiểu biến.</p>
</div>
</div>
<div id="biến-trong-ngôn-ngữ-r" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Biến trong ngôn ngữ R<a class="anchor" aria-label="anchor" href="#bi%E1%BA%BFn-trong-ng%C3%B4n-ng%E1%BB%AF-r"><i class="fas fa-link"></i></a>
</h2>
<p>Biến là khái niệm cơ bản nhất trong mọi ngôn ngữ lập trình. Có bốn loại biến cơ bản trong R bao gồm</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>Biến kiểu số, được gọi trong ngôn ngữ R là kiểu <span style="color: #640514; font-family: Source Code Pro;">numeric</span>;</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>Biến kiểu ký tự, hay chuỗi ký tự, được gọi trong ngôn ngữ R là kiểu <span style="color: #640514; font-family: Source Code Pro;">character</span>;</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>Biến kiểu logic, được gọi trong ngôn ngữ R là kiểu <span style="color: #640514; font-family: Source Code Pro;">logical</span>;</li>
</ol></li>
<li><ol start="4" style="list-style-type: decimal">
<li>Biến kiểu thời gian, được gọi trong ngôn ngữ R là kiểu <span style="color: #640514; font-family: Source Code Pro;">Date</span> và kiểu <span style="color: #640514; font-family: Source Code Pro;">POSIXct</span>.</li>
</ol></li>
</ul>
<p>Nhiều sách tham khảo khi viết về kiểu biến trong ngôn ngữ lập trình R phân loại biến thành nhiều kiểu hơn, chẳng hạn như có thêm kiểu số nguyên (<span style="color: #640514; font-family: Source Code Pro;">integer</span>), kiểu <span style="color: #640514; font-family: Source Code Pro;">factor</span>,… Tuy nhiên theo quan điểm của chúng tôi, phân loại biến quá chi tiết sẽ gây khó khăn cho bạn đọc, nhất là với bạn đọc mới làm quen với lập trình. Do đó, chúng tôi phân chia kiểu biến trong ngôn ngữ R thành bốn kiểu như ở trên. Trong các phần tiếp theo của chương chúng tôi sẽ thảo luận chi tiết về từng kiểu biến cụ thể và các kiểu biến khác có thể có liên quan.</p>
<p>Để tạo một biến trong R và gán giá trị cho biến đó, bạn đọc sử dụng một trong ba cách như sau:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cách thứ nhất</span></span>
<span><span class="va">tenbien</span> <span class="op">&lt;-</span> <span class="va">giatri</span> <span class="co"># dấu "&lt;-" là dấu gán giá trị</span></span>
<span></span>
<span><span class="co"># Cách thứ hai</span></span>
<span><span class="va">giatri</span> <span class="op">-&gt;</span> <span class="va">tenbien</span></span>
<span></span>
<span><span class="co"># Cách thứ ba</span></span>
<span><span class="va">tenbien</span> <span class="op">=</span> <span class="va">giatri</span> <span class="co"># dấu "=" cũng được sử dụng để gán giá trị</span></span></code></pre></div>
<p>Trong các dòng lệnh ở trên, <span style="color: #640514; font-family: Source Code Pro;">tenbien</span> là tên của biến mà bạn muốn đặt, <span style="color: #640514; font-family: Source Code Pro;">giatri</span> là giá trị mà bạn muốn gán cho biến. Ký tự <span style="color: #640514; font-family: Source Code Pro;">&lt;-</span> là ký tự gán giá trị được sử dụng trong các phiên bản R đầu tiên. Gán giá trị cho biến sử dụng ký tự <span style="color: #640514; font-family: Source Code Pro;">-&gt;</span> khi bạn đọc viết tên biến sang phía bên phải. Cách viết này hiếm khi được dùng. Từ các phiên bản 3.0 của phần mềm R trở đi, dấu <span style="color: #640514; font-family: Source Code Pro;">=</span> cũng có thể được sử dụng để gán giá trị cho biến. Tuy nhiên dấu <span style="color: #640514; font-family: Source Code Pro;">=</span> có thể gây nhầm lẫn khi sau này bạn đọc sử dụng cùng lúc với ký hiệu so sánh <span style="color: #640514; font-family: Source Code Pro;">==</span>. Đồng thời ký hiệu <span style="color: #640514; font-family: Source Code Pro;">=</span> cũng được sử dụng trong truyền giá trị cho tham số khi viết hàm số. Do đó, trong cuốn sách này, chúng tôi luôn sử dụng <span style="color: #640514; font-family: Source Code Pro;">&lt;-</span> để gán giá trị cho biến.</p>
<p>Dưới đây là một vài ví dụ về tạo biến và gán giá trị cho biến:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cách thứ nhất:</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">3</span>  <span class="co"># Tạo một biến tên là x có giá trị 3.</span></span>
<span></span>
<span><span class="co"># Cách thứ hai:</span></span>
<span><span class="st">"MFE"</span> <span class="op">-&gt;</span> <span class="va">y</span> <span class="co"># Tạo một biến tên y có giá trị bằng ký tự "MFE".</span></span>
<span></span>
<span><span class="co"># Cách thứ ba:</span></span>
<span><span class="va">z</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span></span>
<span><span class="co"># Tạo một biến tên z và nhận giá trị bằng kết quả của phép cộng.</span></span></code></pre></div>
<p>Trong các câu lệnh ở trên, <span style="color: #640514; font-family: Source Code Pro;">x</span>, <span style="color: #640514; font-family: Source Code Pro;">y</span> hay <span style="color: #640514; font-family: Source Code Pro;">z</span> là tên biến. Quy tắc đặt tên biến hay tên một đối tượng trong R cần tuân theo các quy tắc sau:</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>Tên biến có thể là tổ hợp của tất cả các chữ cái viết hoa, chữ cái viết thường và các chữ số.</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>Trong tên biến có thể chứa hai ký tự đặc biệt là “.” và “_“.</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>Tên biến không được phép bắt đầu bằng số hoặc ký tự “_“.</li>
</ol></li>
<li><ol start="4" style="list-style-type: decimal">
<li>Không được dùng từ khóa của R để đặt tên biến.</li>
</ol></li>
</ul>
<p>Để kiểm tra các quy tắc ở trên, bạn đọc có thể thử thực thi các câu lệnh tạo biến dưới đây và xem dòng lệnh nào báo lỗi và dòng lệnh nào không báo lỗi:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="ki%E1%BA%BFn-th%E1%BB%A9c-r-c%C6%A1-b%E1%BA%A3n.html#cb37-1" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># Biến tên x1 sẽ được tạo với giá trị bằng 3.</span></span>
<span id="cb37-2"><a href="ki%E1%BA%BFn-th%E1%BB%A9c-r-c%C6%A1-b%E1%BA%A3n.html#cb37-2" tabindex="-1"></a>1x <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># Sẽ có lỗi, tên biến không được phép bắt đầu bằng số.</span></span>
<span id="cb37-3"><a href="ki%E1%BA%BFn-th%E1%BB%A9c-r-c%C6%A1-b%E1%BA%A3n.html#cb37-3" tabindex="-1"></a>.x <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># Biến tên .x hợp lệ.</span></span>
<span id="cb37-4"><a href="ki%E1%BA%BFn-th%E1%BB%A9c-r-c%C6%A1-b%E1%BA%A3n.html#cb37-4" tabindex="-1"></a>_x <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># Sẽ báo lỗi, tên biến không được phép bắt đầu bằng _</span></span></code></pre></div>
<p>Lưu ý rằng R có phân biệt chữ viết hoa với chữ viết thường trong tên biến. Ví dụ như khi bạn đọc sử dụng <span style="color: #640514; font-family: Source Code Pro;">x</span> để đặt tên và sau đó dùng <span style="color: #640514; font-family: Source Code Pro;">X</span> để đặt tên thì R sẽ hiểu đây là hai biến khác nhau:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">&lt;-</span><span class="fl">3</span> <span class="co"># Tạo một biến tên x, giá trị bằng 3.</span></span>
<span><span class="va">X</span><span class="op">&lt;-</span><span class="fl">5</span> <span class="co"># Tạo một biến tên X, giá trị bằng 5.</span></span>
<span><span class="va">X</span><span class="op">-</span><span class="va">x</span> <span class="co"># Hiệu số cho kết quả bằng 2 do x và X là khác nhau.</span></span></code></pre></div>
<p>Để biết danh sách các tên biến đang tồn tại trên môi trường làm việc và giá trị của các biến đó, ngoài cách in giá trị biến lên cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Console</span>, bạn đọc có thể sử dụng cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Environment</span> ở góc phía trên bên phải, của Rstudio. Để xóa một biến hoặc một đối tượng đang tồn tại trong môi trường làm việc hiện tại, bạn đọc sử dụng câu lệnh <span style="color: #640514; font-family: Source Code Pro;">rm()</span>:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="co"># R trả lại giá trị bằng 3.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># Xóa biến x khỏi môi trường làm việc.</span></span>
<span><span class="va">x</span> <span class="co"># Sẽ báo lỗi vì biến x không còn tồn tại.</span></span></code></pre></div>
<p>Một điều cũng cần lưu ý khi đặt tên biến hay khi đặt tên các đối tượng khác trong R là tên biến không được phép trùng với các từ khóa. Danh sách các từ khóa thường sử dụng trong R nằm trong bảng <a href="#tab:tbbasic01"><strong>??</strong></a></p>
<div class="inline-table"><table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Từ khóa
</th>
<th style="text-align:left;">
Sử dụng trong ngữ cảnh
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
If, else
</td>
<td style="text-align:left;">
Câu lệnh điều kiện
</td>
</tr>
<tr>
<td style="text-align:left;">
for, while, in , repeat
</td>
<td style="text-align:left;">
Vòng lặp
</td>
</tr>
<tr>
<td style="text-align:left;">
function
</td>
<td style="text-align:left;">
Khai báo hàm số
</td>
</tr>
<tr>
<td style="text-align:left;">
break, next
</td>
<td style="text-align:left;">
Điều khiển vòng lặp
</td>
</tr>
<tr>
<td style="text-align:left;">
TRUE, FALSE
</td>
<td style="text-align:left;">
Tên các biến logic
</td>
</tr>
<tr>
<td style="text-align:left;">
Inf, -Inf, NaN, NA
</td>
<td style="text-align:left;">
Các biến kiểu số dạng đặc biệt
</td>
</tr>
</tbody>
</table></div>
<p>Trong phần tiếp theo, chúng ta sẽ thảo luận chi tiết về từng kiểu biến.</p>
<div id="biến-kiểu-số" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Biến kiểu số<a class="anchor" aria-label="anchor" href="#bi%E1%BA%BFn-ki%E1%BB%83u-s%E1%BB%91"><i class="fas fa-link"></i></a>
</h3>
<p>Biến kiếu số, được gọi trong R là kiểu <span style="color: #640514; font-family: Source Code Pro;">numeric</span>, là các biến nhận giá trị kiểu số thập phân. Để tạo một biến kiểu số, bạn đọc gán một giá trị kiểu số bất kỳ cho tên biến mà bạn muốn đặt. Đây cũng là cách tạo biến chung trong R. Câu lệnh dưới đây khởi tạo một biến tên <span style="color: #640514; font-family: Source Code Pro;">x</span> kiểu số và nhận giá trị bằng 5:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="co"># 5 là giá trị kiểu số nên R tự hiểu x là biến kiểu số.</span></span></code></pre></div>
<p>Để kiểm tra một biến tên <span style="color: #640514; font-family: Source Code Pro;">x</span> có phải là biến kiểu số không, bạn đọc sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">is.numeric()</span>. Hàm số này trả lại giá trị là kiểu logic. Giá trị <span style="color: #640514; font-family: Source Code Pro;">TRUE</span> cho biết biến được hỏi đúng là kiểu số trong khi giá trị <span style="color: #640514; font-family: Source Code Pro;">FALSE</span> cho biết biến được hỏi không phải là kiểu số. Ngoài sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">is.numeric()</span>, bạn đọc cũng có thể sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">class()</span>. Hàm <span style="color: #640514; font-family: Source Code Pro;">class()</span> cho biết kiểu giá trị của một đối tượng bất kỳ trong R. Cách sử dụng hai hàm này như sau:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># 5 là giá trị kiểu số nên R trả lại TRUE.</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># Cho biết kiểu giá trị của đối tượng x.</span></span></code></pre></div>
<pre><code>## [1] "numeric"</code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span><span class="op">&lt;-</span><span class="st">"abc"</span> <span class="co"># Khởi tạo một biến y kiểu ký tự.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="co"># Kết quả là FALSE vì y không phải số.</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Trong phép gán cho giá trị của biến <span style="color: #640514; font-family: Source Code Pro;">x</span> ở trên, mặc dù giá trị khởi tạo 5 là số nguyên nhưng R vẫn cho rằng <span style="color: #640514; font-family: Source Code Pro;">x</span> là kiểu số thập phân. Để tạo một biến kiểu số nguyên, bạn đọc cần phải sử dụng thêm chữ <span style="color: #640514; font-family: Source Code Pro;">L</span> phía sau số nguyên đó. Chữ <span style="color: #640514; font-family: Source Code Pro;">L</span> là viết tắt cho <em>Long</em> nghĩa là số nguyên kiểu <em>Long</em> trong các ngôn ngữ lập trình cơ bản như Pascal hay C. Số nguyên kiểu <em>Long</em> là các số nguyên cần 32 bytes để lưu và nhận <span class="math inline">\(2^{32}\)</span> giá trị từ −2,147,483,648 (<span class="math inline">\(-2^{31}\)</span>) đến 2,147,483,647 (<span class="math inline">\(2^{31}-1\)</span>). Để tạo biến <span style="color: #640514; font-family: Source Code Pro;">x</span> nhận giá trị là số nguyên bằng 5 chúng ta viết như sau:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">5L</span> <span class="co"># 5L nghĩa là số nguyên 5, L là viết tắt của Long.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># x là số tự nguyên (integer)</span></span></code></pre></div>
<pre><code>## [1] "integer"</code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># x không còn là số thập phân, nhưng vẫn là kiểu số.</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Phân biệt số nguyên và số thập phân trong các ngôn ngữ lập trình có ý nghĩa khi bạn đọc cần tiết kiệm bộ nhớ cho chương trình. Trong R, khi sử dụng số thập phân thay cho số nguyên, dung lượng bộ nhớ máy tính sẽ tăng gấp 2 lần. Hình vẽ dưới đây mô tả dung lượng bộ nhớ cần sử dụng cho các véc-tơ chứa các số nguyên và các véc-tơ chứa các số thập phân với số lượng phần tử chạy từ 1 đến 100. Từ hình <a href="ki%E1%BA%BFn-th%E1%BB%A9c-r-c%C6%A1-b%E1%BA%A3n.html#fig:fgbasic01">3.1</a> bạn đọc có thể thấy rằng không có sự khác biệt về bộ nhớ với các véc-tơ có độ dài dưới 10 nhưng khi véc-tơ có độ dài từ 10 trở lên, véc-tơ kiểu số thập phân cần trung bình khoảng 2 lần bộ nhớ so với véc-tơ kiểu số nguyên.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fgbasic01"></span>
<img src="07-lap-trinh-co-ban-voi-R_files/figure-html/fgbasic01-1.png" alt="Sự khác nhau về dung lượng bộ nhớ cần sử dụng để lưu véc-tơ kiểu số nguyên và véc-tơ kiểu số thập phân." width="672"><p class="caption">
Hình 3.1: Sự khác nhau về dung lượng bộ nhớ cần sử dụng để lưu véc-tơ kiểu số nguyên và véc-tơ kiểu số thập phân.
</p>
</div>
<p>Biến kiểu số được sử dụng chủ yếu để thực hiện trong các phép tính toán. Các phép tính toán thông thường được liệt kê trong bảng <a href="#tab:tbbasic02"><strong>??</strong></a></p>
<div class="inline-table"><table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Ký hiệu
</th>
<th style="text-align:left;">
Phép tính
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
+
</td>
<td style="text-align:left;">
Phép tính cộng
</td>
</tr>
<tr>
<td style="text-align:left;">
-
</td>
<td style="text-align:left;">
Phép tính trừ
</td>
</tr>
<tr>
<td style="text-align:left;">
*
</td>
<td style="text-align:left;">
Phép tính nhân
</td>
</tr>
<tr>
<td style="text-align:left;">
/
</td>
<td style="text-align:left;">
Phép tính chia
</td>
</tr>
<tr>
<td style="text-align:left;">
^
</td>
<td style="text-align:left;">
Phép tính lũy thừa
</td>
</tr>
<tr>
<td style="text-align:left;">
exp(x)
</td>
<td style="text-align:left;">
Phép tính lũy thừa cơ số e của số x
</td>
</tr>
<tr>
<td style="text-align:left;">
log()
</td>
<td style="text-align:left;">
Phép lấy loga cơ số tự nhiên của số x
</td>
</tr>
<tr>
<td style="text-align:left;">
log(.,a)
</td>
<td style="text-align:left;">
Phép lấy loga cơ số a của số x
</td>
</tr>
<tr>
<td style="text-align:left;">
%%
</td>
<td style="text-align:left;">
Phép lấy phần dư trong phép chia
</td>
</tr>
<tr>
<td style="text-align:left;">
%/%
</td>
<td style="text-align:left;">
Phép lấy phần nguyên của kết quả trong phép chia
</td>
</tr>
</tbody>
</table></div>
<p>Lưu ý rằng các phép toán lấy phần dư <span style="color: #640514; font-family: Source Code Pro;">%%</span>, và phép lấy thương số trong phép chia <span style="color: #640514; font-family: Source Code Pro;">%/%</span>, cũng có thể thực hiện được với cả số kiểu thập phân. Bạn đọc quan sát kết quả của các phép toán này trong ví dụ dưới đây:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">6.5</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">2</span> <span class="co"># Phần dư của phép chia 6.5 cho 2</span></span></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">6.5</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%/%</a></span> <span class="fl">2</span> <span class="co"># Phần nguyên của phép chia 6.5 cho 2</span></span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>Một cách viết số kiểu khoa học và các giá trị kiểu số đặc biệt được liệt kê trong bảng <a href="#tab:tbbasic03"><strong>??</strong></a>.</p>
<div class="inline-table"><table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Loại số
</th>
<th style="text-align:left;">
Ý nghĩa
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1.2e+08
</td>
<td style="text-align:left;">
nghĩa là nhân số 1.2 với 10 lũy thừa 8
</td>
</tr>
<tr>
<td style="text-align:left;">
1.2e-15
</td>
<td style="text-align:left;">
nghĩa là nhân số 1.2 với 10 lũy thừa -15
</td>
</tr>
<tr>
<td style="text-align:left;">
Inf
</td>
<td style="text-align:left;">
Số dương vô cùng
</td>
</tr>
<tr>
<td style="text-align:left;">
-Inf
</td>
<td style="text-align:left;">
Số âm vô cùng
</td>
</tr>
<tr>
<td style="text-align:left;">
NaN
</td>
<td style="text-align:left;">
là kết quả của các phép tính không có nghĩa, viết tắt của Not a Number
</td>
</tr>
</tbody>
</table></div>
<p>Bạn đọc cần đặc biệt lưu ý khi thực hiện các phép tính toán có kết quả là các giá trị đặc biệt. Dưới đây là các ví dụ:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span><span class="op">/</span><span class="fl">0</span> <span class="co"># Kết quả của 1/0 là dương vô cùng.</span></span>
<span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">0</span> <span class="co"># Kết quả của -1/0 là âm vô cùng.</span></span>
<span><span class="cn">Inf</span> <span class="op">-</span> <span class="fl">10</span><span class="op">^</span><span class="fl">10</span> <span class="co"># Trong các phép tính có Inf sẽ có kết quả Inf.</span></span>
<span><span class="fl">1</span><span class="op">/</span><span class="fl">0</span> <span class="op">+</span> <span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">0</span> <span class="co"># Inf + (-Inf) là không thể xác định được.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span> <span class="co"># Kết quả của các phép tính vô nghĩa là NaN.</span></span></code></pre></div>
</div>
<div id="biến-kiểu-logical" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> Biến kiểu <span style="color: #640514; font-family: Source Code Pro;">logical</span><a class="anchor" aria-label="anchor" href="#bi%E1%BA%BFn-ki%E1%BB%83u-logical"><i class="fas fa-link"></i></a>
</h3>
<p>Biến kiểu logic, được gọi là kiểu <span style="color: #640514; font-family: Source Code Pro;">logical</span>, là kiểu biến đơn giản nhất nhưng lại quan trọng nhất trong R nói riêng và trong đa số các ngôn ngữ lập trình nói chung. Biến kiểu <span style="color: #640514; font-family: Source Code Pro;">logical</span> chỉ nhận một trong hai giá trị là <span style="color: #640514; font-family: Source Code Pro;">TRUE</span> hoặc <span style="color: #640514; font-family: Source Code Pro;">FALSE</span>. Do R phân biệt chữ viết hoa và chữ viết thường nên khi viết giá trị cho biến kiểu logic bạn đọc cần viết bao gồm toàn bộ các chữ cái viết hoa. Để tạo một biến kiểu logic, chúng ta chọn tên biến và gán một trong hai giá trị logic. Việc này hoàn toàn giống như khi tạo một biến kiểu số:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></code></pre></div>
<p>Biến kiểu logic có thể đặt trong các phép tính toán giống như biến kiểu số. Khi gặp một công thức có bao gồm cả biến kiểu số và biến kiểu logic, R sẽ đổi biến kiểu logic có giá trị <span style="color: #640514; font-family: Source Code Pro;">TRUE</span> thành giá trị 1 và biến kiểu logic có giá trị <span style="color: #640514; font-family: Source Code Pro;">FALSE</span> thành giá trị 0 rồi thực hiện phép tính toán:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="cn">FALSE</span> <span class="op">+</span> <span class="cn">TRUE</span> <span class="op">*</span> <span class="fl">10</span> <span class="co"># Sẽ cho kết quả giống như 0 + 1 * 10</span></span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>Trong thực tế, ít khi chúng ta khởi tạo giá trị cho biến kiểu logic như trên. Biến kiểu logic thường nhận được từ kết quả các phép so sánh. Các phép toán so sánh thường được sử dụng trong R được liệt kê trong bảng <a href="#tab:tbbasic04"><strong>??</strong></a></p>
<div class="inline-table"><table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Phép so sánh
</th>
<th style="text-align:left;">
Ý nghĩa
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
&lt;
</td>
<td style="text-align:left;">
Có nhỏ hơn không?
</td>
</tr>
<tr>
<td style="text-align:left;">
&gt;
</td>
<td style="text-align:left;">
Có lớn hơn không?
</td>
</tr>
<tr>
<td style="text-align:left;">
&lt;=
</td>
<td style="text-align:left;">
Có nhỏ hơn hoặc bằng không?
</td>
</tr>
<tr>
<td style="text-align:left;">
&gt;=
</td>
<td style="text-align:left;">
Có lớn hơn hoặc bằng không?
</td>
</tr>
<tr>
<td style="text-align:left;">
==
</td>
<td style="text-align:left;">
Có bằng nhau không?
</td>
</tr>
<tr>
<td style="text-align:left;">
!=
</td>
<td style="text-align:left;">
Có khác nhau không?
</td>
</tr>
</tbody>
</table></div>
<p>Ngoài ra, các biến kiểu logic còn là kết quả của việc kết hợp <span class="math inline">\(|\)</span> nhiều biến kiểu logic khác bằng các toán tử logic. Các toán tử logic bao gồm có toán tử “và”, toán tử “hoặc”, và toán tử “phủ định”. Các toán tử này được liệt kê trong bảng <a href="#tab:tbbasic05"><strong>??</strong></a></p>
<div class="inline-table"><table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Toán tử logic
</th>
<th style="text-align:left;">
Ý nghĩa
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
&amp;
</td>
<td style="text-align:left;">
Toán tử Và; ký hiệu A&amp;B đọc là A và B
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(|\)</span>
</td>
<td style="text-align:left;">
Toán tử Hoặc; ký hiệuA|Bđọc là A hoặc B
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(!\)</span>
</td>
<td style="text-align:left;">
Toán tử Phủ định; Toán tử này phủ định lại biến logic đứng sau
</td>
</tr>
</tbody>
</table></div>
<p>Bạn đọc cần lưu ý rằng các biến logic khi kết hợp với nhau bằng các toán tử trong bảng <a href="#tab:tbbasic05"><strong>??</strong></a> sẽ cho kết quả là một biến kiểu logic. Quy tắc kết hợp các biến kiểu logic bằng các toán tử logic được tổng hợp trong bảng <a href="#tab:tbbasic06"><strong>??</strong></a></p>
<div class="inline-table"><table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Kết hợp
</th>
<th style="text-align:left;">
Kết quả
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
!TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
!FASLE
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
TRUE &amp; TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
TRUE &amp; FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
FALSE &amp; TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
TRUE | TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
TRUE | FALSE
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:left;">
FALSE | TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
</tbody>
</table></div>
<p>Như chúng tôi đã đề cập ở trên, các biến kiểu logic khi đặt trong các biểu thức tính toán sẽ được tự động đổi sang biến kiểu số trước khi thực hiện phép tính. Ngược lại, khi biến kiểu số xuất hiện trong các biểu thức có toán tử logic, biến kiểu số cũng sẽ được chuyển sang kiểu logic. R sẽ mặc định quy tắc đổi từ số sang kiểu logic như sau: chỉ có số 0 khi đặt trong biểu thức có toán tử logic mới được chuyển thành <span style="color: #640514; font-family: Source Code Pro;">FALSE</span>, mọi số khác 0 khi đổi sang kiểu logic đều được chuyển thành <span style="color: #640514; font-family: Source Code Pro;">TRUE</span>. Bạn đọc hãy quan sát nguyên tắc đổi từ biến kiểu số sang logic trong các phép toán dưới đây</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">10</span> <span class="op">&amp;</span> <span class="op">-</span><span class="fl">0.1</span> <span class="co"># Tương đương với TRUE &amp; TRUE</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">0</span> <span class="op">&amp;</span> <span class="op">-</span><span class="fl">0.1</span> <span class="co"># Tương đương với FALSE &amp; TRUE</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">0</span> <span class="op">|</span> <span class="fl">0.2</span> <span class="co"># Tương đương với FALSE | TRUE</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Bạn đọc có thể thực hành việc tính toán trên các toán tử logic như ở dưới đây. Trước khi sử dụng R để xem kết quả, hãy thử suy nghĩ xem các biểu thức từ 1. đến 4. dưới đây cho kết quả như thế nào?</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1.</span></span>
<span><span class="op">(</span><span class="fl">1</span><span class="op">&lt;=</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="fl">2</span><span class="op">&lt;=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co"># 2.</span></span>
<span><span class="op">(</span><span class="fl">1</span><span class="op">&lt;=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">2</span><span class="op">&lt;=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co"># 3.</span></span>
<span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">&lt;=</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span><span class="op">^</span><span class="fl">2</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="fl">2</span><span class="op">!=</span><span class="fl">3</span><span class="op">)</span> <span class="co">#</span></span>
<span><span class="co"># 4.</span></span>
<span><span class="op">!</span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">&lt;=</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span><span class="op">^</span><span class="fl">2</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="op">(</span><span class="fl">2</span><span class="op">!=</span><span class="fl">3</span><span class="op">)</span> <span class="co">#</span></span>
<span><span class="co"># 5.</span></span>
<span><span class="op">(</span><span class="op">(</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="op">(</span><span class="fl">2</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> <span class="co">#</span></span></code></pre></div>
</div>
<div id="biến-kiểu-chuỗi-ký-tự" class="section level3" number="3.2.3">
<h3>
<span class="header-section-number">3.2.3</span> Biến kiểu chuỗi ký tự<a class="anchor" aria-label="anchor" href="#bi%E1%BA%BFn-ki%E1%BB%83u-chu%E1%BB%97i-k%C3%BD-t%E1%BB%B1"><i class="fas fa-link"></i></a>
</h3>
<p>Biến kiểu ký tự hay chuỗi ký tự còn được gọi trong ngôn ngữ R là kiểu <span style="color: #640514; font-family: Source Code Pro;">character</span>. Biến kiểu chuỗi ký tự tương tự như biến kiểu xâu ký tự hay kiểu <em>string</em> trong các ngôn ngữ lập trình cơ bản. Biến kiểu chuỗi ký tự có thể chỉ ngắn gọn là một ký tự trống, một chữ cái, nhưng đôi khi có thể là một câu, hoặc cũng có thể là cả một đoạn văn bản. Khi làm việc với biến kiểu chuỗi ký tự, bạn đọc hãy luôn ghi nhớ rằng R phân biệt chữ viết hoa và chữ viết thường.</p>
<p>Để tạo một biến có kiểu ký tự trong R, bạn đọc chọn tên cho biến và gán giá trị kiểu chuỗi ký tự. R sẽ hiểu một biến là chuỗi ký tự khi chuỗi ký tự đó nằm trong dấu ngoặc kép " " hoặc trong dấu ngoặc đơn ' '.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="st">"Ice cream"</span> <span class="co"># "Ice cream" với chữ I viết hoa.</span></span>
<span><span class="va">x</span> <span class="op">==</span> <span class="st">"ice cream"</span> <span class="co"># Kết quả trả lại là FALSE</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Để biết một biến có phải kiểu chuỗi ký tự không, bạn đọc sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">is.character()</span> hoặc hàm <span style="color: #640514; font-family: Source Code Pro;">class()</span>. Hàm <span style="color: #640514; font-family: Source Code Pro;">is.character()</span> trả lại giá trị <span style="color: #640514; font-family: Source Code Pro;">TRUE</span> nếu một biến có kiểu chuỗi ký tự và trả lại giá trị <span style="color: #640514; font-family: Source Code Pro;">FALSE</span> trong các trường hợp còn lại. Hàm <span style="color: #640514; font-family: Source Code Pro;">class()</span>, như chúng tôi đã giới thiệu ở trên, cho biết một đối tượng bất kỳ là đối tượng có kiểu như thế nào:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p>Khi xử lý biến kiểu chuỗi ký tự, bạn đọc nên sử dụng các hàm số đã được xây dựng sẵn. Bảng <a href="#tab:tbbasic07"><strong>??</strong></a> liệt kê các hàm thường được sử dụng khi xử lý biến kiểu chuỗi ký tự và kết quả của các hàm này.</p>
<div class="inline-table"><table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Hàm số
</th>
<th style="text-align:left;">
Ý nghĩa
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
nchar(x)
</td>
<td style="text-align:left;">
Cho biêt biến x dạng chuỗi ký tự có bao nhiêu ký tự
</td>
</tr>
<tr>
<td style="text-align:left;">
paste(x1,x2,sep = a)
</td>
<td style="text-align:left;">
Ghép hai chuỗi ký tự x1 và x2 thành một chuỗi ký tự cách nhau chuỗi ký tự a
</td>
</tr>
<tr>
<td style="text-align:left;">
toupper(x)
</td>
<td style="text-align:left;">
Chuyển tất cả các chữ viêt thường trong x thành chữ viết hoa
</td>
</tr>
<tr>
<td style="text-align:left;">
tolower(x)
</td>
<td style="text-align:left;">
Chuyển tất cả các chữ viết hoa trong x thành chữ viết thường
</td>
</tr>
<tr>
<td style="text-align:left;">
chartr(a,b,x)
</td>
<td style="text-align:left;">
Thay thế trong x: từng ký tự trong chuỗi a tương ứng bằng từng ký tự trong chuỗi b, a và b phải có độ dài bằng nhau
</td>
</tr>
<tr>
<td style="text-align:left;">
substr(x,k,n)
</td>
<td style="text-align:left;">
Lấy ra chuỗi ký tự con từ x, lấy từ ký tự thứ k đến ký tự thứ n
</td>
</tr>
<tr>
<td style="text-align:left;">
sub(a, b, x)
</td>
<td style="text-align:left;">
Đoạn ký tự a đầu tiên trong x sẽ được thay thế bằng đoạn ký tự b
</td>
</tr>
<tr>
<td style="text-align:left;">
gsub(a, b, x)
</td>
<td style="text-align:left;">
Tất cả các đoạn ký tự giống a trong x sẽ được thay thế bằng b
</td>
</tr>
<tr>
<td style="text-align:left;">
grepl(a,x)
</td>
<td style="text-align:left;">
Trả lại giá trị là biến TRUE nếu đoạn ký tự a nằm trong biến x
</td>
</tr>
</tbody>
</table></div>
<p>Bạn đọc có thể thực thi các hàm liệt kê trong bảng <a href="#tab:tbbasic07"><strong>??</strong></a> và quan sát giá trị trả ra của các hàm đó trong các câu lệnh dưới đây để hiểu cách sử dụng của các hàm này:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo hai biến kiểu chuỗi ký tự x1 và x2</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="st">"I am an Actuary"</span>; <span class="va">x2</span><span class="op">&lt;-</span><span class="st">"I am Vietnamese"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="co"># Cho biết x1 có bao nhiêu ký tự.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, sep <span class="op">=</span> <span class="st">" and "</span><span class="op">)</span> <span class="co"># Ghép x1 và x2 lại và thêm " and " vào giữa.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="co"># Chuyển tất cả các ký tụ sang viết hoa/viết thường</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">chartr</a></span><span class="op">(</span><span class="st">"an"</span>,<span class="st">"bm"</span>,<span class="va">x1</span><span class="op">)</span> <span class="co"># Thay tất cả các chữ "a" trong x1 bằng "b" và "n" bằng "m"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fl">9</span>, <span class="fl">15</span><span class="op">)</span> <span class="co"># Lấy ra đoạn ký tự từ ký tự thứ 9 (chữ A) đến ký tự thứ 15 (chữ "y")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"XYZ"</span>, <span class="va">x1</span><span class="op">)</span> <span class="co"># Thay chữ "a" đầu tiên trong x1 bằng đoạn "XYZ"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"XYZ"</span>, <span class="va">x1</span><span class="op">)</span> <span class="co"># Thay tất cả chữ "a" trong x1 bằng đoạn "XYZ"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Vietnam"</span>, <span class="va">x2</span><span class="op">)</span> <span class="co"># Cho biết đoạn ký tự "Vietnam" có nằm trong x2 hay không</span></span></code></pre></div>
<p>Nhìn chung, trong bất kỳ ngôn ngữ lập trình nào, xử lý biến kiểu chuỗi ký tự sẽ luôn khó khăn hơn so với xử lý biến kiểu số. Để thực hiện được các yêu cầu phức tạp hơn, bạn đọc có thể kết hợp các hàm số ở trên để có hiệu quả tốt hơn. Có các thư viện được phát triển dành riêng cho việc xử lý các biến kiểu chuỗi ký tự mà tiêu biểu là thư viện <span style="color: #640514; font-family: Source Code Pro;">stringr</span>. Các hàm hữu ích trong thư viện <span style="color: #640514; font-family: Source Code Pro;">stringr</span> sẽ được thảo luận chi tiết trong phần phân tích dữ liệu.</p>
</div>
<div id="biến-kiểu-thời-gian" class="section level3" number="3.2.4">
<h3>
<span class="header-section-number">3.2.4</span> Biến kiểu thời gian<a class="anchor" aria-label="anchor" href="#bi%E1%BA%BFn-ki%E1%BB%83u-th%E1%BB%9Di-gian"><i class="fas fa-link"></i></a>
</h3>
<p>Trong ngôn ngữ R có hai kiểu biến thời gian là biến kiểu ngày tháng, được gọi trong ngôn ngữ R là kiểu <span style="color: #640514; font-family: Source Code Pro;">Date</span>) và biến kiểu thời gian chi tiết, được gọi trong ngôn ngữ R là kiểu <span style="color: #640514; font-family: Source Code Pro;">POSIXct</span>. Thời gian <em>POSIX</em> hay còn được biết đến với tên gọi là thời gian <em>Unix</em> là một cách quy ước về thời gian của một thời điểm cụ thể được tính bằng số giây từ cột mốc thời gian Unix đến thời điểm đó. Cột mốc thời gian Unix được các kỹ sư xây dựng hệ điều hành Unix lựa chọn là thời điểm 0 giờ, 0 phút, 0 giây, ngày 01 tháng 01 năm 1970 theo giờ phối hợp quốc tế (giờ UTC). Chữ “ct” là viết tắt của canlendar time. Bạn đọc cũng có thể gặp biến kiểu thời gian chi tiết trong R dưới dạng <span style="color: #640514; font-family: Source Code Pro;">POSIXlt</span> trong đó <span style="color: #640514; font-family: Source Code Pro;">lt</span> là chữ viết tắt của local time. Sự khác biệt của biến kiểu <span style="color: #640514; font-family: Source Code Pro;">POSIct</span> và <span style="color: #640514; font-family: Source Code Pro;">POSIXlt</span> chỉ là cách R lưu trữ các biến này dưới dạng số nguyên hay dưới dạng véc-tơ. Trong cuốn sách này khi nói đến biến kiểu thời gian chúng tôi luôn sử dụng biến kiểu <span style="color: #640514; font-family: Source Code Pro;">POSIXct</span>.</p>
<p>Để tạo biến kiểu thời gian trong R, bạn đọc sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">as.Date()</span> cho biến kiểu ngày tháng và hàm <span style="color: #640514; font-family: Source Code Pro;">as.POSIXct()</span> cho biến kiểu thời gian chi tiết:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tạo biến date1 nhận giá trị là ngày 31/08/2023</span></span>
<span><span class="va">date1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-08-31"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Biến time1 là 16 giờ, 41 phút, 30 giây ngày 31/08/2023</span></span>
<span><span class="va">time1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">"2023-08-31 16:41:30"</span><span class="op">)</span></span></code></pre></div>
<p>Khi xử lý biến kiểu thời gian, bạn đọc nên đổi sang dạng số hoặc lưu biến kiểu thời gian dưới dạng một véc-tơ số lưu lại các thành phần của thời gian theo một thứ tự nhất định. Hàm <span style="color: #640514; font-family: Source Code Pro;">as.numeric()</span> sẽ đổi các biến kiểu ngày tháng hoặc thời gian chi tiết ra thành số ngày đối với biến kiểu ngày tháng, hoặc số giây đối với biến kiểu thời gian chi tiết, tính từ mốc thời gian Unix.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cho biết số ngày tính từ 01/01/1970 đến date1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">date1</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 19600</code></pre>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cho biết số giây tính từ 7 giờ, 0 phút, 0 giây ngày 01/01/1970 đến time1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">time1</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1693474890</code></pre>
<p>Do múi giờ UTC của Việt Nam là <em>UTC + 7</em> nên thời điểm tính làm mốc sẽ là 7 giờ, 0 phút, 0 giây, ngày 01 tháng 01 năm 1970. Điều này giải thích tại sao khi đổi biến <span style="color: #640514; font-family: Source Code Pro;">time2</span> dưới đây thành dạng số ta sẽ thu được kết quả là 30 giây.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cho biết số giây tính từ 7 giờ, 0 phút, 0 giây ngày 01/01/1970 đến time2</span></span>
<span><span class="va">time2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">"1970-01-01 07:00:30"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">time2</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] -3570</code></pre>
<p>Khi sử dụng các hàm <span style="color: #640514; font-family: Source Code Pro;">as.Date()</span> hoặc <span style="color: #640514; font-family: Source Code Pro;">as.POSIXct()</span> giá trị được đưa vào phải là biến dạng chuỗi ký tự được viết theo đúng quy tắc <span style="color: #640514; font-family: Source Code Pro;">YYYY-MM-DD</span> và <span style="color: #640514; font-family: Source Code Pro;">YYYY-MM-DD hh:mm:ss</span>. Trong trường hợp chuỗi ký tự được đưa vào không đúng định dạng, bạn đọc cần phải thông báo cho R biết định dạng của biến chuỗi ký tự đó bằng cách sử dụng thêm tham số <span style="color: #640514; font-family: Source Code Pro;">format</span>. Bạn đọc có thể tham khảo cách khai báo định dạng của biến chuỗi ký tự trong các hàm <span style="color: #640514; font-family: Source Code Pro;">as.Date()</span> hoặc <span style="color: #640514; font-family: Source Code Pro;">as.POSIXct()</span> như sau:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># date1 là ngày 27 tháng 02 năm 1992</span></span>
<span><span class="va">date1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"02/27/92"</span>, format <span class="op">=</span> <span class="st">"%m/%d/%y"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># date2 là ngày 02 tháng 01 năm 2010</span></span>
<span><span class="va">date2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"02 Jan 2010"</span>, format <span class="op">=</span> <span class="st">"%d %b %Y"</span><span class="op">)</span></span></code></pre></div>
<p>Trong rất nhiều trường hợp, biến kiểu thời gian sẽ được lấy từ các nguồn khác nhau vào R và được lưu dưới dạng số tự nhiên. Điển hình là khi bạn đọc lấy dữ liệu từ các file được lưu từ phần mềm Microsoft Excel. Các hàm <span style="color: #640514; font-family: Source Code Pro;">as.Date()</span> và <span style="color: #640514; font-family: Source Code Pro;">as.POSIXct()</span> cũng có thể chuyển giá trị số biến kiểu ngày tháng và biến kiểu thời gian chi tiết. Bạn đọc cần sử dụng thêm tham số biến <span style="color: #640514; font-family: Source Code Pro;">origin</span> trong các hàm này để quy định mốc thời gian.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">date1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fl">19000</span>, origin <span class="op">=</span> <span class="st">"1970-01-01"</span><span class="op">)</span></span>
<span><span class="va">time1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">9</span>, origin <span class="op">=</span> <span class="st">"1970-01-01 07:00:00"</span><span class="op">)</span></span></code></pre></div>
<p>Sau khi thực thi các câu lệnh ở trên, biến <span style="color: #640514; font-family: Source Code Pro;">date1</span> tương ứng với ngày thứ 19,000 tính từ mốc ngày 1 tháng 1 năm 1970 và biến <span style="color: #640514; font-family: Source Code Pro;">time1</span> tương ứng với thời điểm giây thứ 1 tỷ tính từ 07 giờ 00 phút 00 giây ngày 1 tháng 1 năm 1970.</p>
<p>Vấn đề thường gặp phải khi lấy dữ liệu từ các nguồn ngoài là cách chuyển đổi từ thời gian thành số của phần mềm lưu dữ liệu gốc có mốc thời gian khác với R. Chẳng hạn như biến kiểu thời gian từ Microsoft Excel khi chuyển đổi thành số sử dụng mốc thời gian là ngày 30 tháng 12 năm 1899. Giả sử khi bạn đọc lấy một biến thời gian từ Microsoft Excel vào R và thấy giá trị là 45678. Nếu không sử dụng mốc thời gian của Microsoft Excel để chuyển đổi, giá trị thời gian nhận được sẽ không đúng. Để biến ngày tháng nhận giá trị đúng, chúng ta cần khai báo tham số <span style="color: #640514; font-family: Source Code Pro;">origin</span> như sau:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 45678 là giá trị của biến lấy từ nguồn Microsoft Excel</span></span>
<span><span class="va">date1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fl">45678</span>, origin <span class="op">=</span> <span class="st">"1970-01-01"</span><span class="op">)</span></span>
<span><span class="va">date1</span> <span class="co"># date1 sai do sử dụng mốc thời gian ngày 01 tháng 01 năm 1970.</span></span></code></pre></div>
<pre><code>## [1] "2095-01-23"</code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">date2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fl">45678</span>, origin <span class="op">=</span> <span class="st">"1899-12-30"</span><span class="op">)</span></span>
<span><span class="va">date2</span> <span class="co"># date2 có giá trị ĐÚNG do dùng đúng mốc thời gian của Excel.</span></span></code></pre></div>
<pre><code>## [1] "2025-01-21"</code></pre>
<p>Nguyên tắc cơ bản khi xử lý và tính toán với biến kiểu thời gian trong R là luôn luôn đổi biến sang kiểu số nguyên hoặc đổi một biến kiểu thời gian thành một véc-tơ chứa các thành phần ngày, tháng, năm, giờ, phút, giây dưới dạng số. Để tách biến kiểu ngày tháng ra thành ngày, tháng, năm bạn đọc có thể sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">sub.str()</span> để lấy ra các đoạn ký tự chứa giá trị ngày, tháng, và năm rồi sau đó sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">as.numeric()</span> để đổi các biến thành biến kiểu số:</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lấy ra giá trị năm trong biến date2</span></span>
<span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">date2</span>,<span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Lấy ra giá trị tháng trong biến date2</span></span>
<span><span class="va">month</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">date2</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Lấy ra giá trị ngày trong biến date2</span></span>
<span><span class="va">day</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">date2</span>,<span class="fl">9</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Xử lý biến kiểu ngày tháng và biến kiểu thời gian phức tạp hơn so với xử lý biến kiểu số và thường cần thêm các thư viện bổ sung. Thư viện chúng tôi thường sử dụng khi làm việc với biến kiểu thời gian là thư viện <span style="color: #640514; font-family: Source Code Pro;">lubridate</span> hoặc thư viện <span style="color: #640514; font-family: Source Code Pro;">hms</span>. Bạn đọc sẽ sử dụng các thư viện này để thực hành với biến kiểu thời gian trong chương phân tích dữ liệu.</p>
</div>
</div>
<div id="véc-tơ" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Véc-tơ<a class="anchor" aria-label="anchor" href="#v%C3%A9c-t%C6%A1"><i class="fas fa-link"></i></a>
</h2>
<p>Trong phần này của cuốn sách chúng tôi giới thiệu các khái niệm cơ bản về véc-tơ và giải thích tại sao xử lý véc-tơ lại là thế mạnh của ngôn ngữ R. Chúng tôi sẽ không đi quá chi tiết vào các kỹ thuật xử lý véc-tơ mà chỉ tập trung vào các công cụ cơ bản. Các yêu cầu về xử lý véc-tơ sẽ được lặp lại trong tất cả các chương tiếp sau của cuốn sách, do đó đi quá sâu vào chi tiết trong phần này là không cần thiết.</p>
<div id="tại-sao-xử-lý-véc-tơ-là-thế-mạnh-của-r" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Tại sao xử lý véc-tơ là thế mạnh của R?<a class="anchor" aria-label="anchor" href="#t%E1%BA%A1i-sao-x%E1%BB%AD-l%C3%BD-v%C3%A9c-t%C6%A1-l%C3%A0-th%E1%BA%BF-m%E1%BA%A1nh-c%E1%BB%A7a-r"><i class="fas fa-link"></i></a>
</h3>
<p>Véc-tơ là một tập hợp các phần tử có cùng kiểu được sắp xếp theo một thứ tự nhất định. Thứ tự của một phần tử trong véc-tơ được gọi là chỉ số của phần tử đó. Phần tử đầu tiên trong một véc-tơ của R có chỉ số là 1. Bạn đọc lưu ý điều này bởi trong một vài ngôn ngữ khác chỉ số của phần tử đầu tiên trong véc-tơ sẽ là 0. Véc-tơ là đối tượng quan trọng nhất trong R và xử lý vec-tơ chính là một thế mạnh của R, giúp cho R có thể thực hiện được những phân tích mà nhiều ngôn ngữ khác không đáp ứng được.</p>
<p>Khi bạn đọc làm việc với dữ liệu, các thao tác biến đổi hay phân tích dữ liệu thường sẽ là được thực hiện đồng thời trên các giá trị trên cùng một hàng hoặc một cột dữ liệu. Hiếm khi các thao tác này được thực hiện với một giá trị riêng lẻ. Đối tượng véc-tơ là một công cụ hiệu quả để thực hiện các công việc này. Hiệu quả ở đây không chỉ bao gồm sự tiện lợi khi viết các câu lệnh, mà còn hiệu quả ở cả thời gian thực hiện tính toán. Trong phần Lập trình với R, chúng tôi sẽ thảo luận kỹ hơn về hiệu quả về thời gian tính toán. Hãy nói về sự tiện lợi khi sử dụng véc-tơ trước. Chúng ta hãy lấy ví dụ khi thực hiện một phân tích trên dữ liệu có tên là <span style="color: #640514; font-family: Source Code Pro;">trump_tweets</span> bằng cách thực thi một đoạn lệnh sau</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dslabs</span><span class="op">)</span> <span class="co"># cần gọi thư viện dslabs chứa dữ liệu trump_tweets</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">trump_tweets</span><span class="op">$</span><span class="va">created_at</span>,<span class="fl">12</span>,<span class="fl">13</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Tổng thống Trump viết tweet vào thời gian nào trong ngày"</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"white"</span>, border <span class="op">=</span> <span class="st">"#640514"</span>, xlabs <span class="op">=</span> <span class="st">"Giờ trong ngày"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="07-lap-trinh-co-ban-voi-R_files/figure-html/unnamed-chunk-29-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Dữ liệu <span style="color: #640514; font-family: Source Code Pro;">trump_tweets</span> trong thư viện <span style="color: #640514; font-family: Source Code Pro;">dslabs</span> là dữ liệu chứa 20.761 câu trạng thái trên các nền tảng mạng xã hội của cựu tổng thống Mỹ Donald Trump trong khoảng thời gian từ năm 2009 đến năm 2017. Đoạn câu lệnh trên thực hiện một phân tích cho biết cựu tổng thống Donald Trump có thói quen viết các câu trạng thái trên các nền tảng mạng xã hội vào các khoảng thời gian nào trong ngày. Kết quả này thu được bằng việc thực hiện 1 chuỗi các phép biến đổi và tính toán trên cột dữ liệu có tên là <span style="color: #640514; font-family: Source Code Pro;">created_at</span>. Các biến đổi và tính toán được liệt kê như sau:</p>
<ol style="list-style-type: decimal">
<li>Lấy ra đoạn ký tự chứa giá trị là giờ của cột <span style="color: #640514; font-family: Source Code Pro;">created_at</span>. Được thực hiện bằng cách dùng hàm <span style="color: #640514; font-family: Source Code Pro;">substr()</span>;</li>
<li>Chuyển đổi dữ liệu kiểu chuỗi ký sang kiểu số sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">as.numeric()</span>;</li>
<li>Chuyển đổi dữ liệu kiểu số sang kiểu <span style="color: #640514; font-family: Source Code Pro;">factor</span> sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">as.factor()</span>;</li>
<li>Tổng hợp lại dữ liệu kiểu <span style="color: #640514; font-family: Source Code Pro;">factor</span> theo các nhóm bằng hàm <span style="color: #640514; font-family: Source Code Pro;">table()</span>;</li>
<li>Vẽ đồ thị kiểu <em>Barplot</em> để người đọc hiểu về dữ liệu một cách nhanh chóng và trực quan hơn.</li>
</ol>
<p>Để biến đổi từ cột dữ liệu <span style="color: #640514; font-family: Source Code Pro;">created_at</span> có kiểu <span style="color: #640514; font-family: Source Code Pro;">as.POSIXct()</span> đến kết quả là đồ thị Barplot mà chỉ cần một dòng lệnh là việc gần như không thể đối với đa số các ngôn ngữ lập trình. Các ngôn ngữ lập trình cơ bản chỉ cho phép người sử dụng tác động đển từng phần tử của véc-tơ một cách lần lượt và riêng lẻ. Điều thú vị là khi bạn đọc thực hiện một phép biến đổi hay tính toán trên đối tượng là véc-tơ trong R, các phép tính toán hay biến đổi này sẽ được thực hiện một cách đồng thời cho tất cả các phần tử trong véc-tơ. Ngoài việc giúp cho các câu lệnh trở nên đơn giản, dể hiểu, R cũng được phát triển để những tính toán trên véc-tơ được thực hiện theo cơ chế song song. Cơ chế song song hiểu một cách đơn giản là việc thực hiện các phép toán trên các phần tử của một véc-tơ sẽ diễn ra cùng một lúc chứ không thực hiện một cách lần lượt. Việc này cho phép rút ngắn được thời gian tính toán.</p>
<p>Hầu hết các hàm số trên R đều được phát triển theo cơ chế lập trình véc-tơ, nghĩa là các hàm số được dùng cho một biến kiểu số đều có thể áp dụng được cho một véc-tơ kiểu số, các hàm số được dùng cho một biến kiểu chuỗi ký tự đều có thể áp dụng được cho một véc-tơ kiểu chuỗi ký tự, tương tự với các véc-tơ kiểu logic hay kiểu ngày tháng. Trong ví dụ trên, cột (véc-tơ) <span style="color: #640514; font-family: Source Code Pro;">created_at</span> của dữ liệu <span style="color: #640514; font-family: Source Code Pro;">trump_tweets</span> là một véc-tơ kiểu thời gian chi tiết đã liên tục được biến đổi bằng các hàm số như <span style="color: #640514; font-family: Source Code Pro;">substr()</span>, <span style="color: #640514; font-family: Source Code Pro;">as.numeric()</span>,… Các hàm này đều cho phép đầu vào là một véc-tơ và trả lại giá trị cũng là một véc-tơ có độ dài tương ứng.</p>
<p>Ngoài việc thực hiện tính toán trên các véc-tơ riêng lẻ, cơ chế hoạt động của ngôn ngữ R cũng cho phép thực hiện tính toán tương tác giữa các véc-tơ với nhau. Tương tác giữa hai hay nhiều véc-tơ với nhau luôn được thực hiện trên nguyên tắc các phần tử có cùng chỉ số của các véc-tơ sẽ tương tác với nhau. Thậm chí các véc-tơ tương tác với nhau có thể không có cùng kích thước mà vẫn cho kết quả. Chi tiết sẽ được thảo luận trong các phần tiếp theo.</p>
</div>
<div id="khởi-tạo-véc-tơ-và-các-phép-toán-trên-véc-tơ" class="section level3" number="3.3.2">
<h3>
<span class="header-section-number">3.3.2</span> Khởi tạo véc-tơ và các phép toán trên véc-tơ<a class="anchor" aria-label="anchor" href="#kh%E1%BB%9Fi-t%E1%BA%A1o-v%C3%A9c-t%C6%A1-v%C3%A0-c%C3%A1c-ph%C3%A9p-to%C3%A1n-tr%C3%AAn-v%C3%A9c-t%C6%A1"><i class="fas fa-link"></i></a>
</h3>
<div id="khởi-tạo-véc-tơ-bằng-các-hàm-có-sẵn" class="section level4" number="3.3.2.1">
<h4>
<span class="header-section-number">3.3.2.1</span> Khởi tạo véc-tơ bằng các hàm có sẵn<a class="anchor" aria-label="anchor" href="#kh%E1%BB%9Fi-t%E1%BA%A1o-v%C3%A9c-t%C6%A1-b%E1%BA%B1ng-c%C3%A1c-h%C3%A0m-c%C3%B3-s%E1%BA%B5n"><i class="fas fa-link"></i></a>
</h4>
<p>Để khởi tạo một véc-tơ trong R, bạn đọc có thể sử dụng bất kỳ một hàm số có sẵn miễn là có đầu ra là một véc-tơ với kiểu giá trị phù hợp. Hàm số thông dụng nhất được dùng để tạo véc-tơ trong R là hàm <span style="color: #640514; font-family: Source Code Pro;">c()</span>; <span style="color: #640514; font-family: Source Code Pro;">c</span> là viết tắt của concatenate, hoặc một vài tài liệu cho rằng <span style="color: #640514; font-family: Source Code Pro;">c</span> là viết tắt của combine. Về mặt ý nghĩa, hàm <span style="color: #640514; font-family: Source Code Pro;">c()</span> tập hợp các đối tượng được liệt kê trong dấu ngoặc <span class="math inline">\(()\)</span> lại để tạo thành một véc-tơ duy nhất. Nếu các phần tử được liệt kê ra có cùng kiểu dữ liệu, đối tượng tượng tạo thành sẽ là một véc-tơ</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo x là một vec-tơ kiểu số</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">13</span>,<span class="fl">21</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Khởi tạo "qua" là vec-tơ chứa tên các loại quả</span></span>
<span><span class="va">qua</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chuối"</span>, <span class="st">"táo"</span>, <span class="st">"cam"</span>, <span class="st">"chanh"</span><span class="op">)</span></span></code></pre></div>
<p>Khi các biến được liệt kê bên trong hàm <span style="color: #640514; font-family: Source Code Pro;">c()</span> không cùng kiểu, R sẽ cố gắng phân tích các giá trị đó để đưa ra kết quả phù hợp. Nguyên tắc chung là nếu các giá trị được liệt kê bên trong hàm <span style="color: #640514; font-family: Source Code Pro;">c()</span> bao gồm kiểu số, kiểu logic, và kiểu thời gian thì véc-tơ được tạo thành sẽ là véc-tơ kiểu số. Trong trường hợp có 1 biến được liệt kê ra là kiểu chuỗi ký tự, véc-tơ được tạo thành sẽ là véc-tơ kiểu chuỗi ký tự. Bạn đọc có thể kiểm tra giá trị của các véc-tơ sau:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Véc-tơ bao gồm kiểu số và logic</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "numeric"</code></pre>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Véc-tơ bao gồm kiểu logic và ngày tháng</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-12-31"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Véc-tơ bao gồm kiểu số,logic,ngày tháng, và chuỗi ký tự</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">TRUE</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-12-31"</span><span class="op">)</span>,<span class="st">"MFE"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "character"</code></pre>
<p>Các giá trị bên trong hàm <span style="color: #640514; font-family: Source Code Pro;">c()</span> cũng có thể là một véc-tơ khác, thậm chí có thể là một ma trận (<span style="color: #640514; font-family: Source Code Pro;">matrix</span>), hoặc là một đối tượng kiểu mảng (<span style="color: #640514; font-family: Source Code Pro;">array</span>). Giá trị đầu ra của hàm <span style="color: #640514; font-family: Source Code Pro;">c()</span> luôn luôn là một véc-tơ. Nếu là ma trận hoặc mảng hàm <span style="color: #640514; font-family: Source Code Pro;">c()</span> sẽ chuyển hóa các phần tử ra thành 1 véc-tơ theo thứ tự các cột bắt đầu từ cột có chỉ số 1. Chúng ta sẽ quay lại vấn đề này khi thảo luận về ma trận và mảng trong phần kiến thức R nâng cao.</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khai báo véc-tơ x</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">TRUE</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-12-31"</span><span class="op">)</span>,<span class="st">"MFE"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Khai báo véc-tơ y chứa x</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x</span>,<span class="st">"Actuary"</span>,<span class="va">x</span><span class="op">)</span> <span class="co"># dùng véc-tơ x trong khai báo véc-tơ y</span></span></code></pre></div>
<p>Như chúng tôi đã nói ở trên, bất kỳ hàm số sẵn có nào có đầu ra là một véc-tơ đều có thể dùng để tạo thành véc-tơ. Các hàm mà chúng tôi hay sử dụng để khởi tạo véc-tơ, ngoài hàm <span style="color: #640514; font-family: Source Code Pro;">c()</span>, còn có các hàm <span style="color: #640514; font-family: Source Code Pro;">rep()</span> và hàm <span style="color: #640514; font-family: Source Code Pro;">seq()</span>.</p>
<ul>
<li>Hàm số <span style="color: #640514; font-family: Source Code Pro;">rep()</span> có thể được sử dụng để lặp đi lặp lại một biến, một véc-tơ nào đó nhiều lần. Cụ thể <span style="color: #640514; font-family: Source Code Pro;">rep(x,n)</span> với <em>n</em> là một số nguyên dương và <span style="color: #640514; font-family: Source Code Pro;">x</span> là một biến hoặc một véc-tơ sẽ cho kết quả là một véc-tơ được tạo thành bằng cách lặp lại giá trị <span style="color: #640514; font-family: Source Code Pro;">x</span> theo thứ tự từ trái sang phải <em>n</em> lần.</li>
<li>Hàm số <span style="color: #640514; font-family: Source Code Pro;">seq()</span> được dành riêng cho véc-tơ kiểu số. Câu lệnh <span style="color: #640514; font-family: Source Code Pro;">seq(from = a, to = b,length = n)</span> tạo thành một dãy số tăng dần (hoặc giảm dần) bắt đầu từ <em>a</em> kết thúc tại <em>b</em> và véc-tơ có độ dài là <em>n</em>.</li>
</ul>
<p>Các hàm <span style="color: #640514; font-family: Source Code Pro;">rep()</span> và <span style="color: #640514; font-family: Source Code Pro;">seq()</span> được sử dụng như sau:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Véc-tơ x kiểu số, các giá trị đều là 1, độ dài 1000</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Véc-tơ y kiểu chuỗi ký tự, độ dài 200 vì lặp lại véc-tơ ("a","b") 100 lần</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span><span class="op">)</span>,<span class="fl">100</span><span class="op">)</span> <span class="co">#</span></span>
<span></span>
<span><span class="co"># z là cấp số cộng từ 0 đến 1, độ dài là 101</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>,to <span class="op">=</span> <span class="fl">1</span>,length <span class="op">=</span> <span class="fl">101</span><span class="op">)</span></span></code></pre></div>
<p>Đầu ra của hàm <span style="color: #640514; font-family: Source Code Pro;">seq()</span> luôn là một véc-tơ kiểu số. Nếu không sử dụng tham số <span style="color: #640514; font-family: Source Code Pro;">length</span>, bạn đọc có thể sử dụng tham số là khoảng cách giữa hai số liên tiếp trong dãy số như ví dụ dưới đây</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># z1 là cấp số cộng từ 0 đến 1, tăng dần 0.01</span></span>
<span><span class="va">z1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>,to <span class="op">=</span> <span class="fl">1</span>, <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># z2 là cấp số trừ từ 1 về 0, giảm dần 0.01</span></span>
<span><span class="va">z2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>,to <span class="op">=</span> <span class="fl">0</span>, <span class="op">-</span><span class="fl">0.01</span><span class="op">)</span></span></code></pre></div>
<p>Khi thực hiện các phép tính toán tổng hợp các véc-tơ kiểu số, chúng ta thường quan tâm đến các giá trị như tổng, giá trị trung bình, tích, độ lệch chuẩn, hoặc quan tâm đến việc sắp xếp các giá trị trong véc-tơ đó. Các hàm số được liệt kê trong bảng <a href="#tab:tbbasic08"><strong>??</strong></a> là các hàm số thường sử dụng để thực hiện các tính toán như vậy,</p>
<div class="inline-table"><table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Hàm số
</th>
<th style="text-align:left;">
Ý nghĩa
</th>
<th style="text-align:left;">
Áp dụng trên
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
length(x)
</td>
<td style="text-align:left;">
Số lượng phần tử trong véc-tơ <span class="math inline">\(x\)</span>
</td>
<td style="text-align:left;">
Mọi kiểu véc-tơ
</td>
</tr>
<tr>
<td style="text-align:left;">
sum(x)
</td>
<td style="text-align:left;">
Tổng các số trong véc-tơ <span class="math inline">\(x\)</span>
</td>
<td style="text-align:left;">
Kiểu số, logic, thời gian
</td>
</tr>
<tr>
<td style="text-align:left;">
prod(x)
</td>
<td style="text-align:left;">
Tích các số trong véc-tơ <span class="math inline">\(x\)</span>
</td>
<td style="text-align:left;">
Kiểu số, logic, thời gian
</td>
</tr>
<tr>
<td style="text-align:left;">
mean()
</td>
<td style="text-align:left;">
Giá trị trung bình của các số trong véc-tơ <span class="math inline">\(x\)</span>
</td>
<td style="text-align:left;">
Kiểu số, logic, thời gian
</td>
</tr>
<tr>
<td style="text-align:left;">
var(x)
</td>
<td style="text-align:left;">
Phương sai của các số trong véc-tơ <span class="math inline">\(x\)</span>
</td>
<td style="text-align:left;">
Kiểu số, logic, thời gian
</td>
</tr>
<tr>
<td style="text-align:left;">
sd(x)
</td>
<td style="text-align:left;">
Độ lệch chuẩn của các số trong véc-tơ <span class="math inline">\(x\)</span>
</td>
<td style="text-align:left;">
Kiểu số, logic, thời gian
</td>
</tr>
<tr>
<td style="text-align:left;">
min(x)
</td>
<td style="text-align:left;">
Giá trị nhỏ nhất trong <span class="math inline">\(x\)</span>
</td>
<td style="text-align:left;">
Mọi kiểu véc-tơ
</td>
</tr>
<tr>
<td style="text-align:left;">
max(x)
</td>
<td style="text-align:left;">
Giá trị lớn nhất trong <span class="math inline">\(x\)</span>
</td>
<td style="text-align:left;">
Mọi kiểu véc-tơ
</td>
</tr>
<tr>
<td style="text-align:left;">
quantile(x,p)
</td>
<td style="text-align:left;">
Giá trị tại mức xác suất <span class="math inline">\(p\)</span> của véc-tơ <span class="math inline">\(x\)</span>
</td>
<td style="text-align:left;">
Kiểu số, logic, thời gian
</td>
</tr>
<tr>
<td style="text-align:left;">
sort(x)
</td>
<td style="text-align:left;">
Sắp xếp các phần tử của <span class="math inline">\(x\)</span> theo thứ tự TĂNG dần
</td>
<td style="text-align:left;">
Mọi kiểu véc-tơ
</td>
</tr>
<tr>
<td style="text-align:left;">
table(x)
</td>
<td style="text-align:left;">
Cho biết tần suất xuất hiện của mỗi phần tử
</td>
<td style="text-align:left;">
Mọi kiểu véc-tơ
</td>
</tr>
</tbody>
</table></div>
<p>Bạn đọc lưu ý rằng còn nhiều hàm số hữu ích khác được xây dựng sẵn khi tính toán với véc-tơ mà chúng tôi không liệt kê ở đây. Đồng thời, mỗi hàm số trong bảng kể trên còn có các tham số để có thể sử dụng trong các hoàn cảnh khác nhau. Chẳng hạn khi trong véc-tơ <span class="math inline">\(x\)</span> có các giá trị không có ý nghĩa <span style="color: #640514; font-family: Source Code Pro;">NaN</span> hoặc không quan sát được <span style="color: #640514; font-family: Source Code Pro;">NA</span> thì các hàm như <span style="color: #640514; font-family: Source Code Pro;">sum(x)</span>, <span style="color: #640514; font-family: Source Code Pro;">mean(x)</span>, … sẽ không thực hiện tính toán được. Trong trường hợp này, bạn đọc cần sử dụng thêm tham số <span style="color: #640514; font-family: Source Code Pro;">na.rm=TRUE</span> để R hiểu rằng các phép tính toán chỉ thực hiện trên các giá trị có ý nghĩa.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ x có chứa NA</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Hàm sum trả lại giá trị NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tham số na.rm = TRUE loại NA ra khỏi tổng</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 15</code></pre>
<p>Cách tốt nhất để hiểu và sử dụng hiệu quả và đúng mục đích các hàm số liệt kê ở trên là đọc hướng dẫn của hàm số đó. Trong cuốn sách này chúng tôi chỉ nhấn mạnh những hàm số và tham số của nó mà chúng tôi cho rằng quan trọng khi ứng dụng các hàm số trong thực tế.</p>
<p>Các hàm số sử dụng trên các véc-tơ kiểu số như <span style="color: #640514; font-family: Source Code Pro;">sum()</span>, <span style="color: #640514; font-family: Source Code Pro;">mean()</span>, hay thậm chí cả <span style="color: #640514; font-family: Source Code Pro;">var()</span> hay <span style="color: #640514; font-family: Source Code Pro;">sd()</span> đều có thể hoạt động trên véc-tơ kiểu thời gian hoặc kiểu logic. Nếu phép toán thực hiện không thể giữ nguyên kiểu dữ liệu của véc-tơ, R sẽ đổi véc-tơ kiểu thời gian và véc-tơ kiểu logic sang kiểu số để thực hiện tính toán như ví dụ dưới đây:</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo x là véc-tơ kiểu thời gian</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2023-12-31"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Hàm mean trên véc-tơ kiểu thời gian</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "2023-07-02"</code></pre>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Hàm sd trên véc-tơ kiểu thời gian</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 257.3869</code></pre>
<p>Ngoài các nguyên tắc tính toán thông thường, bạn đọc thấy rằng R có thể sắp xếp thứ tự các phần tử trong một véc-tơ bất kỳ tăng dần hoặc giảm dần bằng hàm <span style="color: #640514; font-family: Source Code Pro;">sort()</span>. Hoặc R cũng có thể lấy ra giá trị lớn nhất hoặc nhỏ nhất của một véc-tơ bằng hàm <span style="color: #640514; font-family: Source Code Pro;">max()</span> hoặc hàm <span style="color: #640514; font-family: Source Code Pro;">min()</span>. Điều này là khá hiển nhiên với các véc-tơ kiểu số. Trong trường hợp véc-tơ là véc-tơ kiểu logic hay kiểu ngày tháng, R sẽ đổi giá trị của véc-tơ đó sang kiểu số để tiến hành sắp xếp hay tìm ra giá trị lớn nhất hoặc giá trị nhỏ nhất. Điều gì sẽ xảy ra nếu véc-tơ cần được sắp xếp, hay tìm giá trị lớn nhất và nhỏ nhất là véc-tơ kiểu chuỗi ký tự. Đây là một vấn đề phức tạp liên quan đến việc mã hóa các ký tự trên máy tính và vượt quá phạm vi của cuốn sách. Bạn đọc chỉ cần ghi nhớ các nguyên tắc sau khi sắp xếp một véc-tơ kiểu chuỗi ký tự:</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>Nếu véc-tơ kiểu chuỗi ký tự được biến đổi thành kiểu <span style="color: #640514; font-family: Source Code Pro;">factor</span> thì thứ tự sắp xếp tăng dần sẽ phụ thuộc vào cách định nghĩa các mức độ (level) của véc-tơ kiểu <span style="color: #640514; font-family: Source Code Pro;">factor</span>.</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>Khi so sánh hai chuỗi ký tự, phép so sánh sẽ được thực hiện ở ký tự thứ nhất trước, nếu hai ký tự đầu tiên giống nhau thì sẽ so sánh ký tự tiếp theo, và tiếp tục như thế đến khi có sự khác biệt.</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>Các ký tự đặc biệt luôn được xếp trước (nhỏ hơn), sau đó đến các ký tự là các số, rồi đến chữ cái. Thứ tự sắp xếp của các ký tự số theo đúng thứ tự tăng dần từ 0 đến 9 trong khi thứ tự sắp xếp của các chữ cái là tăng dần theo bảng chữ cái. Chữ viết thường được viết trước (nhỏ hơn) chữ viết hoa của chữ cái đó. Chữ viết hoa của chữ cái đứng trước lại “nhỏ hơn” chữ viết thường của chữ đứng sau trong bảng chữ cái.</li>
</ol></li>
</ul>
<p>Trước khi sử dụng R để in ra kết quả, bạn đọc hãy thử đoán xem R sẽ cho kết quả như thế nào khi chạy các câu sắp xếp các véc-tơ sau theo thứ tự tăng dần:</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Xếp véc-tơ kiểu ký tự tăng dần</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"az"</span>,<span class="st">"z"</span><span class="op">)</span><span class="op">)</span> <span class="co"># chữ cái đầu tiên để so sánh</span></span>
<span></span>
<span><span class="co"># Xếp chữ cái đứng trước trong bảng chữ cái nhỏ hơn</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"az"</span>,<span class="st">"z"</span>,<span class="st">"A"</span>,<span class="st">"Z"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Xếp số đứng trước chữ cái</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"az"</span>,<span class="st">"z"</span>,<span class="st">"A"</span>,<span class="st">"Z"</span>,<span class="st">"1a"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Xếp ký tự đặc biệt trước ký tự số</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"az"</span>,<span class="st">"z"</span>,<span class="st">"A"</span>,<span class="st">"Z"</span>,<span class="st">"1a"</span>,<span class="st">"@a"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ký tự đặc biệt trước số, số trước chữ cái</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"az"</span>,<span class="st">"z"</span>,<span class="st">"A"</span>,<span class="st">"Z"</span>,<span class="st">"1a"</span>,<span class="st">"@a"</span>, <span class="st">"0123"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Hàm <span style="color: #640514; font-family: Source Code Pro;">sort()</span> nếu không sử dụng thêm tham số sẽ luôn sắp xếp véc-tơ theo thứ tự tăng dần. Để sắp xếp véc-tơ theo thứ tự giảm dần, bạn đọc có thể sử dụng thêm tham số <span style="color: #640514; font-family: Source Code Pro;">decreasing = TRUE</span> hoặc ngắn gọn hơn là <span style="color: #640514; font-family: Source Code Pro;">decreasing = T</span> trong hàm <span style="color: #640514; font-family: Source Code Pro;">sort()</span>.</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Xếp véc-tơ theo thứ tự giảm dần</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">13</span>,<span class="fl">21</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 21 13  8  5  3  2  1  1</code></pre>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Viết ngắn gọn TRUE bằng T</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"az"</span>,<span class="st">"z"</span>,<span class="st">"A"</span>,<span class="st">"Z"</span>,<span class="st">"1a"</span>,<span class="st">"@a"</span>, <span class="st">"0123"</span><span class="op">)</span>,decreasing <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Z"    "z"    "az"   "A"    "a"    "1a"   "0123" "@a"</code></pre>
</div>
<div id="tính-toán-trên-véc-tơ" class="section level4" number="3.3.2.2">
<h4>
<span class="header-section-number">3.3.2.2</span> Tính toán trên véc-tơ<a class="anchor" aria-label="anchor" href="#t%C3%ADnh-to%C3%A1n-tr%C3%AAn-v%C3%A9c-t%C6%A1"><i class="fas fa-link"></i></a>
</h4>
<p>Như chúng tôi đã đề cập ở trên, R là ngôn ngữ lập trình véc-tơ, nghĩa là bạn đọc có thể sử dụng véc-tơ như một đối tượng trong các phép tính toán hoặc so sánh mà không cần phải tác động đến từng phần tử riêng lẻ của véc-tơ đó. Đây chính là thế mạnh của R mà nhiều ngôn ngữ lập trình khác không thực hiện được.</p>
<p>Trước hết, chúng ta có thể cho một véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> kiểu số vào trong các phép tính toán thông thường như cộng, trừ, nhân, chia, lũy thừa với các số thực. Kết quả thu được sẽ là một véc-tơ có độ dài bằng với véc-tơ ban đầu:</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ kiểu số x</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span>
<span></span>
<span><span class="co"># Nhân véc-tơ x với một số</span></span>
<span><span class="va">x</span> <span class="op">*</span> <span class="fl">2</span></span></code></pre></div>
<pre><code>## [1]  2  4  6  8 10</code></pre>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Phép lũy thừa trên đối tượng véc-tơ</span></span>
<span><span class="va">x</span> <span class="op">^</span> <span class="fl">2</span></span></code></pre></div>
<pre><code>## [1]  1  4  9 16 25</code></pre>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Phép lấy phần dư trên đối tượng véc-tơ</span></span>
<span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">2</span></span></code></pre></div>
<pre><code>## [1] 1 0 1 0 1</code></pre>
<p>Quan sát kết quả được in ra, bạn đọc có thể nhận thấy rằng nguyên tắc R thực hiện phép tính nhân véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> với số 2, hay bất kỳ phép tính nào khác giữa véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> với một số, là lấy lần lượt các phần tử riêng lẻ trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> nhân lên 2 và tạo thành một véc-tơ mới theo đúng thứ tự như trong <span style="color: #640514; font-family: Source Code Pro;">x</span>. Tương tự như phép tính toán, phép so sánh cũng có thể thực hiện giữa một véc-tơ với một biến để cho kết quả là một véc-tơ kiểu logic:</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ kiểu số x</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">13</span>,<span class="fl">21</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># So sánh véc-tơ x với một số, kết quả là véc-tơ logic</span></span>
<span><span class="va">x</span> <span class="op">==</span> <span class="fl">1</span></span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Kết hợp các véc-tơ logic bằng toán tử logic</span></span>
<span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE FALSE FALSE FALSE  TRUE  TRUE</code></pre>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ s kiểu chuỗi kỹ tự</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"az"</span>,<span class="st">"z"</span>,<span class="st">"A"</span>,<span class="st">"Z"</span>,<span class="st">"1a"</span>,<span class="st">"@a"</span>, <span class="st">"0123"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># So sánh s với một biến kiểu chuỗi ký tự</span></span>
<span><span class="va">s</span> <span class="op">==</span> <span class="st">"a"</span></span></code></pre></div>
<pre><code>## [1]  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<p>Hầu hết các hàm số sẵn có trong R, hoặc các hàm số được phát triển trong các thư viện của R, đều có thể áp dụng trên đối tượng là véc-tơ và nguyên tắc áp dụng hàm số trên véc-tơ cũng tương tự như nguyên tắc tính toán giữa véc-tơ với một số. Việc thực hiện tính toán sẽ được thực hiện trên các phần tử riêng lẻ của véc-tơ và sau đó lưu lại trong một véc-tơ mới có độ dài bằng với véc-tơ ban đầu. Ví dụ như hàm <span style="color: #640514; font-family: Source Code Pro;">nchar()</span> cho biết một biến kiểu chuỗi ký tự có bao nhiêu ký tự. Khi sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">nchar()</span> với một véc-tơ kiểu chuỗi ký tự sẽ cho kết quả là một véc-tơ kiểu số mà mỗi phần tử là số ký tự của phần tử tương ứng trong véc-tơ kiểu chuỗi ký tự</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ s kiểu chuỗi kỹ tự</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"az"</span>,<span class="st">"z"</span>,<span class="st">"A"</span>,<span class="st">"Z"</span>,<span class="st">"1a"</span>,<span class="st">"@a"</span>, <span class="st">"0123"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Áp dụng hàm nchar trên véc-tơ s</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1 2 1 1 1 2 2 4</code></pre>
<p>Bằng cách kết hợp các hàm số trên véc-tơ và tương tác giữa véc-tơ với một biến, bạn đọc có thể tự tạo ra các hàm số, các phương pháp của riêng mình để giải quyết các vấn đề phức tạp hơn. Chẳng hạn như chúng ta muốn biết có bao nhiêu phần tử trong véc-tơ thỏa mãn một điều kiện nào đó, chúng ta có thể kết hợp hàm <span style="color: #640514; font-family: Source Code Pro;">sum()</span> với một biểu thức so sánh giữa véc-tơ với một số:</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ x kiểu số</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">13</span>,<span class="fl">21</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Đếm xem có phần tử trong x lớn hơn 10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tính tỷ lệ số phần tử lớn hơn 10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.25</code></pre>
<p>Khi thực hiện phép so sánh <span style="color: #640514; font-family: Source Code Pro;">x &gt; 10</span> , do <span style="color: #640514; font-family: Source Code Pro;">x</span> là một véc-tơ kiểu số nên phép so sánh sẽ trả lại giá trị <span style="color: #640514; font-family: Source Code Pro;">TRUE</span> tại các vị trí mà kết quả so sánh là đúng và trả lại giá trị <span style="color: #640514; font-family: Source Code Pro;">FALSE</span> tại các vị trí còn lại. Khi kết hợp với hàm <span style="color: #640514; font-family: Source Code Pro;">sum()</span>, các giá trị <span style="color: #640514; font-family: Source Code Pro;">TRUE</span> sẽ được đổi thành số 1 và <span style="color: #640514; font-family: Source Code Pro;">FALSE</span> được đổi thành 0. Kết quả thu được sẽ là số lượng các giá trị <span style="color: #640514; font-family: Source Code Pro;">TRUE</span> trong phép so sánh, hay nói một cách khác, là số các phần tử trong <span style="color: #640514; font-family: Source Code Pro;">x</span> thỏa mãn điều kiện lớn hơn 10.</p>
<p>Tất nhiên với véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> có độ dài nhỏ như ở trên, bạn đọc có thể nhìn được một cách trực quan mà không cần hỗ trợ của máy tính. Nhưng thực tế thì các véc-tơ mà chúng ta cần thực hiện tính toán trên thực tế sẽ có độ dài lớn hơn rất nhiều và bạn đọc không thể tính toán trực quan như với véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> kể trên. Chẳng hạn như bạn muốn biết có bao nhiêu câu đăng trạng thái của cựu tổng thống Donald Trump mà có nhiều hơn 10.000 lượt yêu thích. Bạn có thể kết hợp <span style="color: #640514; font-family: Source Code Pro;">sum()</span> với biểu thức so sánh để trả lời câu hỏi này. Lưu ý rằng véc-tơ chứa số lượt yêu thích với mỗi câu đăng trạng thái là cột <span style="color: #640514; font-family: Source Code Pro;">favorite_count</span> trong dữ liệu:</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ x chứa số lượt yêu thích</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">trump_tweets</span><span class="op">$</span><span class="va">favorite_count</span></span>
<span></span>
<span><span class="co"># Đếm xem có bao nhiêu phần tử trong x lớn hơn 10^4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">&gt;</span><span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 4958</code></pre>
<p>Thay vì tính số tổng, bạn đọc cũng có thể tính tỷ lệ số câu đăng trạng thái có số lượt yêu thích nhiều hơn 10.000 bằng cách kết hợp thêm với hàm <span style="color: #640514; font-family: Source Code Pro;">length()</span> :</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tính tỷ lệ phần tử trong x lớn hơn 10^4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">&gt;</span><span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.2388132</code></pre>
<p>Có rất nhiều cách kết hợp các hàm số trong bảng <a href="#tab:tbbasic08"><strong>??</strong></a> lại để đạt được kết quả mong muốn. Một kết quả phân tích có thể đạt được bằng các cách kết hợp khác nhau. Để sử dụng thành thạo các hàm này chỉ có một cách duy nhất là hãy thực hành nhiều trên R và tự đúc kết kinh nghiệm cho chính mình!</p>
</div>
</div>
<div id="lấy-các-thành-phần-con-từ-một-véc-tơ" class="section level3" number="3.3.3">
<h3>
<span class="header-section-number">3.3.3</span> Lấy các thành phần con từ một véc-tơ<a class="anchor" aria-label="anchor" href="#l%E1%BA%A5y-c%C3%A1c-th%C3%A0nh-ph%E1%BA%A7n-con-t%E1%BB%AB-m%E1%BB%99t-v%C3%A9c-t%C6%A1"><i class="fas fa-link"></i></a>
</h3>
<p>Khi làm việc với véc-tơ, chúng ta thường phải lấy các phần tử của véc-tơ ra theo một thứ tự hoặc lấy các phần tử con thỏa mãn các điều kiện nào đó và lưu kết quả vào một véc-tơ mới. Các kỹ thuật này liên quan đến chỉ số của các phần tử trong véc-tơ và sẽ được thảo luận trong phần dưới đây.</p>
<div id="hai-cách-lấy-véc-tơ-con-từ-một-véc-tơ" class="section level4" number="3.3.3.1">
<h4>
<span class="header-section-number">3.3.3.1</span> Hai cách lấy véc-tơ con từ một véc-tơ<a class="anchor" aria-label="anchor" href="#hai-c%C3%A1ch-l%E1%BA%A5y-v%C3%A9c-t%C6%A1-con-t%E1%BB%AB-m%E1%BB%99t-v%C3%A9c-t%C6%A1"><i class="fas fa-link"></i></a>
</h4>
<p>Để lấy một phần tử con của một véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> chúng ta sử dụng dấu ngoặc vuông <span style="color: #640514; font-family: Source Code Pro;">[]</span> . Chẳng hạn như để lấy ra phần tử thứ nhất của véc-tơ, chúng ta sử dụng <span style="color: #640514; font-family: Source Code Pro;">x[1]</span> . Số 1 nằm trong dấu ngoặc vuông được gọi là chỉ số. Nhắc lại với bạn đọc rằng chỉ số của các phần tử của một véc-tơ trong R bắt đầu từ 1 và phần tử cuối cùng trong véc-tơ có chỉ số bằng với độ dài của véc-tơ đó. Nếu chúng ta sử dụng chỉ số lớn hơn độ dài của véc-tơ, R sẽ trả lại giá trị là <span style="color: #640514; font-family: Source Code Pro;">NA</span>.</p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ x kiểu số</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">13</span>,<span class="fl">21</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Lấy ra phần tử thứ nhất trong x</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lấy ra phần tử có chỉ số lớn hơn độ dài</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>Bạn đọc có thể đặt câu hỏi là điều gì xảy ra nều sử dụng chỉ số 0 hoặc chỉ số là số âm. Hãy nói về chỉ số 0 trước; khi gọi phần tử ở vị trí thứ 0 trong một véc-tơ bất kỳ bạn sẽ nhận được một phần tử rỗng. Khái niệm rỗng có thể hiểu giống như khái niệm rỗng khi nói về một tập hợp không có phần tử. Tùy theo kiểu giá trị của véc-tơ ta sẽ có một phần tử rỗng với kiểu giá trị tương ứng như bảng <a href="#tab:tbbasic09"><strong>??</strong></a></p>
<div class="inline-table"><table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Kiểu véc-tơ
</th>
<th style="text-align:left;">
Giá trị tại chỉ số 0
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Kiểu số nguyên
</td>
<td style="text-align:left;">
integer(0)
</td>
</tr>
<tr>
<td style="text-align:left;">
Kiểu số thực
</td>
<td style="text-align:left;">
numeric(0)
</td>
</tr>
<tr>
<td style="text-align:left;">
Kiểu logical
</td>
<td style="text-align:left;">
logical(0)
</td>
</tr>
<tr>
<td style="text-align:left;">
Kiểu chuỗi ký tự
</td>
<td style="text-align:left;">
character(0)
</td>
</tr>
<tr>
<td style="text-align:left;">
Kiểu ngày tháng
</td>
<td style="text-align:left;">
Date of length 0
</td>
</tr>
<tr>
<td style="text-align:left;">
Kiểu thời gian chính xác
</td>
<td style="text-align:left;">
POSIXct of length 0
</td>
</tr>
</tbody>
</table></div>
<p>Khi sử dụng chỉ số âm đối với véc-tơ, R hiểu rằng chúng ta đang loại đi các phần tử. Thật vậy, <span style="color: #640514; font-family: Source Code Pro;">x[-1]</span> sẽ trả lại kết quả là một véc-tơ giống với véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> sau khi loại đi phần tử thứ nhất. Với số tự nhiên <span class="math inline">\(k, (k \in \mathbb{N}),\)</span>, câu lệnh <span style="color: #640514; font-family: Source Code Pro;">x[-k]</span> sẽ trả lại kết quả là véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> sau khi loại đi phần tử thứ <span class="math inline">\(k\)</span>. Nếu <span class="math inline">\(k\)</span> lớn hơn độ dài của véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span>, véc-tơ nhận được sẽ vẫn là <span style="color: #640514; font-family: Source Code Pro;">x</span>. Sử dụng chỉ số âm cũng có thể hiểu là một cách để lấy một véc-tơ con từ một véc-tơ ban đầu bằng cách sử dụng véc-tơ chỉ số kiểu số nguyên.</p>
<p>Ngoài cách lấy một véc-tơ con từ một véc-tơ bằng chỉ số kiểu số nguyên, chúng ta cũng có thể lấy một véc-tơ con từ một véc-tơ bằng cách sử dụng chỉ số là một véc-tơ kiểu logic. Hai cách lấy véc-tơ con sẽ được thảo luận ngay dưới đây.</p>
<p>Trước hết, từ véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> ban đầu, để lấy ra một véc-tơ con, trong trường hợp chúng ta đã biết chính xác các vị trí và thứ tự của các phần tử con mà chúng ta muốn lấy ra, chúng ta có thể lưu vị trí, hay chỉ số của các phần tử con này vào một véc-tơ tạm gọi là véc-tơ <span style="color: #640514; font-family: Source Code Pro;">y</span>. Véc-tơ <span style="color: #640514; font-family: Source Code Pro;">y</span> còn được gọi là véc-tơ chỉ số. Sau đó, chúng ta chỉ cần sử dụng câu lệnh <span style="color: #640514; font-family: Source Code Pro;">x[y]</span> để lấy ra các phần tử của <span style="color: #640514; font-family: Source Code Pro;">x</span> tại các vị trí được lưu ở véc-tơ <span style="color: #640514; font-family: Source Code Pro;">y</span>. Thật vậy, hãy thử quan sát ví dụ sau</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ kiểu chuỗi ký tự</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cam"</span>,<span class="st">"táo"</span>,<span class="st">"kiwi"</span>,<span class="st">"chuối"</span>,<span class="st">"nho"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tạo véc-tơ chỉ số y tại các vị trí muốn lấy</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Lấy ra các phần tử con của x theo chỉ số y</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">y</span><span class="op">]</span> <span class="co"># thứ thự là x[3] -&gt; x[5] -&gt; x[2] -&gt; x[3] -&gt; x[1]</span></span></code></pre></div>
<pre><code>## [1] "kiwi" "nho"  "táo"  "kiwi" "cam"</code></pre>
<p>Nếu trong véc-tơ chỉ số có giá trị lớn hơn độ dài của véc-tơ ban đầu, R sẽ trả lại giá trị là <span style="color: #640514; font-family: Source Code Pro;">NA</span> tại vị trí đó</p>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ kiểu chuỗi ký tự</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cam"</span>,<span class="st">"táo"</span>,<span class="st">"kiwi"</span>,<span class="st">"chuối"</span>,<span class="st">"nho"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tạo véc-tơ chỉ số y tại các vị trí muốn lấy</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">10</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span> <span class="co"># Có chỉ số 10 lớn hơn độ dài của x</span></span>
<span></span>
<span><span class="co"># Lấy ra các phần tử con của x theo chỉ số y</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">y</span><span class="op">]</span> <span class="co"># Vị trí thứ tư (chỉ số 10) là NA</span></span></code></pre></div>
<pre><code>## [1] "kiwi" "nho"  "táo"  NA     "kiwi" "cam"</code></pre>
<p>Nếu chúng ta sử dụng véc-tơ chỉ số là số âm, R sẽ hiểu rằng chúng ta đang muốn loại đi một hay một số phần tử nào đó.</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ kiểu chuỗi ký tự</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cam"</span>,<span class="st">"táo"</span>,<span class="st">"kiwi"</span>,<span class="st">"chuối"</span>,<span class="st">"nho"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tạo véc-tơ chỉ số y gồm các chỉ số âm</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="op">-</span><span class="fl">5</span>,<span class="op">-</span><span class="fl">2</span>,<span class="op">-</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Lọc ra các phần tử con của x theo chỉ số y</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">y</span><span class="op">]</span> <span class="co"># loại đi phần tử thứ 2, 3, 5 của x (chỉ còn x[1] rồi x[4])</span></span></code></pre></div>
<pre><code>## [1] "cam"   "chuối"</code></pre>
<p>Bạn đọc cần lưu ý là R sẽ báo lỗi nếu véc-tơ chỉ số <span style="color: #640514; font-family: Source Code Pro;">y</span> chứa cả số âm và số dương. Trong thực tế thì hiếm khi chúng ta biết chính xác vị trí mà chúng ta muốn lấy ra, hay nói cách khác chúng ta không thể trực tiếp khai báo giá trị cho véc-tơ chỉ số <span style="color: #640514; font-family: Source Code Pro;">y</span> giống như ví dụ trên. Thông thường véc-tơ chỉ số <span style="color: #640514; font-family: Source Code Pro;">y</span> sẽ là kết quả của các hàm số tạo chỉ số. Các hàm <span style="color: #640514; font-family: Source Code Pro;">which()</span> và hàm <span style="color: #640514; font-family: Source Code Pro;">match()</span> được thảo luận ở phần tiếp theo của chương là các phương pháp tuyệt vời để tạo ra các véc-tơ chỉ số kiểu số như vậy.</p>
<p>Phương pháp thứ hai để lấy một véc-tơ con từ véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> đó là sử dụng véc-tơ chỉ số kiểu logic. Cách lấy này sẽ rất thuận tiện khi bạn đọc muốn lấy ra một véc-tơ con của <span style="color: #640514; font-family: Source Code Pro;">x</span> bao gồm các phần tử thỏa mãn một điều kiện nào đó. Véc-tơ chỉ số, tạm gọi tên là véc-tơ <span style="color: #640514; font-family: Source Code Pro;">y</span>, được tạo ra từ một phép so sánh, sau đó câu lệnh <span style="color: #640514; font-family: Source Code Pro;">x[y]</span> sẽ trả lại giá trị là một véc-tơ con của <span style="color: #640514; font-family: Source Code Pro;">x</span> bao gồm các phần tử mà vị trí tương ứng của nó trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">y</span> là <span style="color: #640514; font-family: Source Code Pro;">TRUE</span>. Lấy véc-tơ con bằng cách này, bạn đọc hãy luôn để độ dài của véc-tơ <span style="color: #640514; font-family: Source Code Pro;">y</span> bằng độ dài của véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span>. Khi độ dài của <span style="color: #640514; font-family: Source Code Pro;">y</span> không bằng độ dài của <span style="color: #640514; font-family: Source Code Pro;">x</span>, câu lệnh <span style="color: #640514; font-family: Source Code Pro;">x[y]</span> vẫn trả lại kết quả, tuy nhiên hiểu được kết quả là khá phức tạp. Do đó chúng tôi khuyên bạn đọc hãy luôn đảm bảo rằng véc-tơ chỉ số kiểu logic và véc-tơ ban đầu luôn có cùng độ dài.</p>
<p>Giả sử với véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x[y]</span> chứa tên các loại quả, chúng ta muốn lấy ra tên các loại quả có tên dài hơn 3 ký tự. Chúng ta không biết chính xác các quả này nằm ở vị trí nào trong <span style="color: #640514; font-family: Source Code Pro;">x[y]</span> nên không thể tạo véc-tơ chỉ số kiểu số. Trong trường hợp này, chúng ta sẽ tạo một véc-tơ chỉ số <span style="color: #640514; font-family: Source Code Pro;">y</span> kiểu logic như sau</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ kiểu chuỗi ký tự</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cam"</span>,<span class="st">"táo"</span>,<span class="st">"kiwi"</span>,<span class="st">"chuối"</span>,<span class="st">"nho"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tạo véc-tơ chỉ số y kiểu logic</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">3</span><span class="op">)</span> <span class="co"># y có giá trị TRUE tại vị trí phần tử có độ dài &gt; 3</span></span>
<span></span>
<span><span class="co"># Hiển thị giá trị của y</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] FALSE FALSE  TRUE  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lấy phần tử con của x theo chỉ số y</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">y</span><span class="op">]</span> <span class="co"># Trả lại phần tử trong x có độ dài &gt; 3</span></span></code></pre></div>
<pre><code>## [1] "kiwi"  "chuối"</code></pre>
<p>Đây là cách lấy ra véc-tơ con rất hiệu quả khi làm việc với dữ liệu. Các cột dữ liệu là các véc-tơ có cùng độ dài, do đó chỉ số <span style="color: #640514; font-family: Source Code Pro;">y</span> có thể được tạo thành từ phép so sánh một cột dữ liệu trong khi véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> cần lấy các phần tử con lại là một cột dữ liệu khác. Chẳng hạn như chúng ta muốn lấy ra các câu đăng trạng thái của cựu tổng thống Donald Trump có nhiều hơn 10.000 lần like và sau đó lưu vào một véc-tơ mới có tên là <span style="color: #640514; font-family: Source Code Pro;">z</span>, chúng ta chỉ cần thực hiện như sau:</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ x chứa các câu status</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">trump_tweets</span><span class="op">$</span><span class="va">text</span></span>
<span></span>
<span><span class="co"># Tạo véc-tơ chỉ số kiểu logic y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">trump_tweets</span><span class="op">$</span><span class="va">favorite_count</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span></span>
<span></span>
<span><span class="co"># Lấy ra các câu status có nhiều hơn 10.000 like</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">y</span><span class="op">]</span></span></code></pre></div>
<p>Điều gì xảy ra nếu độ dài của <span style="color: #640514; font-family: Source Code Pro;">y</span> không giống như độ dài của <span style="color: #640514; font-family: Source Code Pro;">x</span>. Trong trường hợp <span style="color: #640514; font-family: Source Code Pro;">y</span> có độ dài nhỏ hơn độ dài của <span style="color: #640514; font-family: Source Code Pro;">x</span>, R sẽ tạo ra một véc-tơ, tạm gọi là <span style="color: #640514; font-family: Source Code Pro;">y1</span> có độ dài bằng với độ dài của <span style="color: #640514; font-family: Source Code Pro;">x</span> bằng cách lặp lại giá trị của <span style="color: #640514; font-family: Source Code Pro;">y</span> cho đến khi véc-tơ thu được có độ dài bằng <span style="color: #640514; font-family: Source Code Pro;">x</span>. Khi chúng ta gọi câu lệnh <span style="color: #640514; font-family: Source Code Pro;">x[y]</span>, R sẽ lấy chỉ số là véc-tơ <span style="color: #640514; font-family: Source Code Pro;">y1</span>. Hãy quan sát ví dụ sau</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ kiểu chuỗi ký tự độ dài 5</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cam"</span>,<span class="st">"táo"</span>,<span class="st">"kiwi"</span>,<span class="st">"chuối"</span>,<span class="st">"nho"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Khởi tạo véc-tơ chỉ số độ dài 2</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">FALSE</span><span class="op">)</span> <span class="co"># y có độ dài là 2</span></span>
<span></span>
<span><span class="co"># Lấy chỉ số của x theo y</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">y</span><span class="op">]</span> <span class="co"># Là véc-tơ có độ dài 5</span></span></code></pre></div>
<pre><code>## [1] "cam"  "kiwi" "nho"</code></pre>
<p>Kết quả thu được tương tự như khi chúng ta thực hiện phép lấy véc-tơ con thông qua một véc-tơ chỉ số <span style="color: #640514; font-family: Source Code Pro;">y1</span> có độ dài bằng 5 như sau</p>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tạo véc-tơ chỉ số độ dài 6</span></span>
<span><span class="va">y1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">y</span>,<span class="fl">3</span><span class="op">)</span> <span class="co"># lặp lại y cho đến khi có độ dài lớn hơn x</span></span>
<span></span>
<span><span class="co"># Cho độ dài của chỉ số bằng độ dài của x</span></span>
<span><span class="va">y1</span><span class="op">&lt;-</span><span class="va">y1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Lấy véc-tơ con theo chỉ số y1</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">y1</span><span class="op">]</span> <span class="co"># cho kết quả giống như x[y]</span></span></code></pre></div>
<pre><code>## [1] "cam"  "kiwi" "nho"</code></pre>
<p>Nếu độ dài của véc-tơ chỉ số <span style="color: #640514; font-family: Source Code Pro;">y</span> lớn hơn độ dài của <span style="color: #640514; font-family: Source Code Pro;">x</span>, tại các vị trí của <span style="color: #640514; font-family: Source Code Pro;">y</span> mà chỉ số vẫn nhỏ hơn hoặc bằng chiều dài của <span style="color: #640514; font-family: Source Code Pro;">x</span>, việc lấy ra phần tử con vẫn theo quy tắc thông thường, nghĩa là lấy ra các phần tử tương ứng với giá trị <span style="color: #640514; font-family: Source Code Pro;">TRUE</span> và bỏ qua các phần tử tương ứng với giá trị <span style="color: #640514; font-family: Source Code Pro;">FALSE</span>. Tại các vị trí của <span style="color: #640514; font-family: Source Code Pro;">y</span> mà chỉ số lớn hơn chiều dài của <span style="color: #640514; font-family: Source Code Pro;">x</span>, R sẽ bỏ qua các phần tử có giá trị là <span style="color: #640514; font-family: Source Code Pro;">FALSE</span> và sẽ trả lại giá trị là <span style="color: #640514; font-family: Source Code Pro;">NA</span> mỗi khi gặp giá trị <span style="color: #640514; font-family: Source Code Pro;">TRUE</span>. Bạn đọc có thể quan sát ví dụ sau</p>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ kiểu chuỗi ký tự độ dài 5</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cam"</span>,<span class="st">"táo"</span>,<span class="st">"kiwi"</span>,<span class="st">"chuối"</span>,<span class="st">"nho"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Khởi tạo véc-tơ chỉ số độ dài 7</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">3</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span><span class="op">)</span> <span class="co"># chỉ số thứ 6 là FALSE, thứ 7 là TRUE</span></span>
<span></span>
<span><span class="co"># Lấy véc-tơ con của x theo chỉ số y</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">y</span><span class="op">]</span></span></code></pre></div>
<pre><code>## [1] "kiwi"  "chuối" NA</code></pre>
<p>Do sự phức tạp khi tương tác giữa các véc-tơ có không cùng độ dài nên chúng tôi khuyên bạn đọc hãy luôn luôn thực hiện các phép tính toán với các véc-tơ có cùng độ dài để kiểm soát được kết quả khi làm việc với R. Trong phần tiếp theo chúng ta sẽ thảo luận về các hàm số để tạo ra véc-tơ chỉ số.</p>
</div>
</div>
<div id="các-hàm-tạo-chỉ-số" class="section level3" number="3.3.4">
<h3>
<span class="header-section-number">3.3.4</span> Các hàm tạo chỉ số<a class="anchor" aria-label="anchor" href="#c%C3%A1c-h%C3%A0m-t%E1%BA%A1o-ch%E1%BB%89-s%E1%BB%91"><i class="fas fa-link"></i></a>
</h3>
<p>Có một nhóm các hàm số thường được sử dụng khi làm việc với chỉ số của các phần tử trong véc-tơ. Các hàm số này có thể được phỏng theo bằng cách kết hợp một vài kỹ thuật chỉ số đã đề cập đến ở chương trước. Tuy nhiên chúng tôi khuyên bạn đọc nên sử dụng các hàm có sẵn được trình bày trong phần này bởi sự tiện lợi và sự dễ hiểu của các dòng lệnh. Các hàm số liên quan đến chỉ số của véc-tơ được liệt kê trong bảng <a href="#tab:tbbasic10"><strong>??</strong></a></p>
<div class="inline-table"><table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Hàm số
</th>
<th style="text-align:left;">
Ý nghĩa
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
which()
</td>
<td style="text-align:left;">
Chỉ số của các phần tử nhận giá trị là TRUE của một véc-tơ kiểu logical
</td>
</tr>
<tr>
<td style="text-align:left;">
match()
</td>
<td style="text-align:left;">
Cho biết chỉ số của một phần tử nằm trong một véc-tơ khác
</td>
</tr>
<tr>
<td style="text-align:left;">
%in%
</td>
<td style="text-align:left;">
Trả lại giá trị là TRUE nếu một phần tử của một véc-tơ có nằm trong một véc-tơ khác
</td>
</tr>
<tr>
<td style="text-align:left;">
rank()
</td>
<td style="text-align:left;">
Trả lại giá trị là thứ tự của phần tử khi xếp véc-tơ theo thứ tự TĂNG dần
</td>
</tr>
<tr>
<td style="text-align:left;">
order()
</td>
<td style="text-align:left;">
Trả lại giá trị là chỉ số của các phần tử sau khi xếp theo thứ tự TĂNG dần
</td>
</tr>
</tbody>
</table></div>
<div id="hàm-which" class="section level4" number="3.3.4.1">
<h4>
<span class="header-section-number">3.3.4.1</span> Hàm <span style="color: #640514; font-family: Source Code Pro;">which()</span><a class="anchor" aria-label="anchor" href="#h%C3%A0m-which"><i class="fas fa-link"></i></a>
</h4>
<p>Hàm <span style="color: #640514; font-family: Source Code Pro;">which()</span> áp dụng trên một véc-tơ kiểu logic và cho biết các vị trí nào trong véc-tơ có giá trị là <span style="color: #640514; font-family: Source Code Pro;">TRUE</span>. Có hai biến thể của hàm <span style="color: #640514; font-family: Source Code Pro;">which()</span> thường được sử dụng là <span style="color: #640514; font-family: Source Code Pro;">which.min()</span> và <span style="color: #640514; font-family: Source Code Pro;">which.max()</span> cho biết chỉ số của giá trị lớn nhất và chỉ số của giá trị nhỏ nhất.</p>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ x kiểu số</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">40</span>,<span class="fl">60</span>,<span class="fl">50</span>,<span class="fl">30</span>,<span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Các chỉ số trong véc-tơ x có giá trị &gt; 40</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">x</span><span class="op">&gt;</span><span class="fl">40</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 3 4</code></pre>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Chỉ số của số nhỏ nhất</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Chỉ số của số lớn nhất</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>Trong trường hợp <span style="color: #640514; font-family: Source Code Pro;">x</span> có nhiều giá trị bằng với giá trị lớn nhất, hoặc có nhiều giá trị bằng với giá trị nhỏ nhất, các hàm <span style="color: #640514; font-family: Source Code Pro;">which.min()</span> và <span style="color: #640514; font-family: Source Code Pro;">which.max()</span> luôn luôn trả lại giá trị là chỉ số nhỏ hơn.</p>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ x kiểu số</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">40</span>,<span class="fl">60</span>,<span class="fl">50</span>,<span class="fl">30</span>,<span class="fl">10</span>,<span class="fl">60</span>,<span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Số nhỏ nhất nằm ở vị trí nào đầu tiên</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Số lớn nhất nằm ở vị trí nào đầu tiên</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>Bạn đọc sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">which()</span> để tạo ra véc-tơ chỉ số khi muốn lấy ra các phần tử của một véc-tơ thỏa mãn một điều kiện nào đó. Ví dụ như chúng ta muốn lấy ra các các câu đăng trạng thái của cựu tổng thống Donald Trum có nhiểu hơn 10.000 lượt yêu thích bằng một véc-tơ chỉ số:</p>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tạo véc-tơ chứa tất cả các câu tweet</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">trump_tweets</span><span class="op">$</span><span class="va">text</span></span>
<span></span>
<span><span class="co"># Tạo chỉ số kiểu số cho các câu nhiều hơn 10.000 like</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">trump_tweets</span><span class="op">$</span><span class="va">favorite_count</span><span class="op">&gt;</span><span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Lấy ra véc-tơ con của x theo chỉ số y</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">y</span><span class="op">]</span> <span class="co"># z chứa các câu tweet nhiều hơn 10.000 like</span></span></code></pre></div>
</div>
<div id="hàm-match-và-toán-tử-in" class="section level4" number="3.3.4.2">
<h4>
<span class="header-section-number">3.3.4.2</span> Hàm <span style="color: #640514; font-family: Source Code Pro;">match()</span> và toán tử <span style="color: #640514; font-family: Source Code Pro;">%in%</span><a class="anchor" aria-label="anchor" href="#h%C3%A0m-match-v%C3%A0-to%C3%A1n-t%E1%BB%AD-in"><i class="fas fa-link"></i></a>
</h4>
<p>Hàm <span style="color: #640514; font-family: Source Code Pro;">match()</span> là hàm số cho phép tương tác giữa hai véc-tơ có độ dài khác nhau. Với <span style="color: #640514; font-family: Source Code Pro;">x</span> và <span style="color: #640514; font-family: Source Code Pro;">y</span> là hai véc-tơ có cùng kiểu biến, câu lệnh <span style="color: #640514; font-family: Source Code Pro;">z &lt;- match(y,x)</span> sẽ trả lại giá trị là một véc-tơ, tạm gọi là <span style="color: #640514; font-family: Source Code Pro;">z</span> có các tính chất sau đây</p>
<ul>
<li>Có độ dài bằng với độ dài của véc-tơ <span style="color: #640514; font-family: Source Code Pro;">y</span>
</li>
<li>Giá trị <span style="color: #640514; font-family: Source Code Pro;">z[i]</span> cho biết <span style="color: #640514; font-family: Source Code Pro;">y[i]</span> có chỉ số, hay nằm ở vị trí nào, trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span>; ví dụ, <span style="color: #640514; font-family: Source Code Pro;">z[1]</span> bằng 3 nghĩa là <span style="color: #640514; font-family: Source Code Pro;">y[1]</span> nằm ở vị trí, hay chỉ số thứ 3, trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span>
</li>
<li>Giá trị <span style="color: #640514; font-family: Source Code Pro;">z[i]</span> bằng <span style="color: #640514; font-family: Source Code Pro;">NA</span> có nghĩa là <span style="color: #640514; font-family: Source Code Pro;">y[i]</span> không xuất hiện trong <span style="color: #640514; font-family: Source Code Pro;">x</span>.</li>
</ul>
<p>Bạn đọc quan sát ví dụ về hàm <span style="color: #640514; font-family: Source Code Pro;">match()</span> như sau:</p>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ x và véc-tơ y kiểu số</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">40</span>,<span class="fl">60</span>,<span class="fl">50</span>,<span class="fl">30</span>,<span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">60</span>,<span class="fl">10</span>,<span class="fl">70</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Chỉ số của các phần tử của y trong véc-tơ x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">y</span>,<span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1]  3  6 NA</code></pre>
<p>Chúng ta có thể thấy rằng giá trị 70 không xuất hiện trong <span style="color: #640514; font-family: Source Code Pro;">x</span> nên giá trị thứ 3 trong véc-tơ kết quả là <span style="color: #640514; font-family: Source Code Pro;">NA</span>. Lưu ý rằng hàm <span style="color: #640514; font-family: Source Code Pro;">match()</span> luôn luôn tìm đến chỉ số đầu tiên trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> có giá trị khớp với giá trị của véc-tơ <span style="color: #640514; font-family: Source Code Pro;">y</span>, nghĩa là nếu trong <span style="color: #640514; font-family: Source Code Pro;">x</span> có nhiều hơn một giá trị khớp với giá trị của <span style="color: #640514; font-family: Source Code Pro;">y</span>, hàm<span style="color: #640514; font-family: Source Code Pro;">match()</span>cho kết quả là chỉ số nhỏ hơn. Bạn đọc quan sát ví dụ dưới đây khi véc-tơ <span style="color: #640514; font-family: Source Code Pro;">y</span> có các phần tử xuất hiện nhiều hơn một lần trong <span style="color: #640514; font-family: Source Code Pro;">x</span>:</p>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ x và véc-tơ y kiểu số</span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">40</span>,<span class="fl">60</span>,<span class="fl">50</span>,<span class="fl">30</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">10</span><span class="op">)</span> <span class="co"># 10 và 20 xuất hiện nhiều lần</span></span>
<span><span class="va">y</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">20</span><span class="op">)</span> <span class="co"># các phần tử của y xuất hiện nhiều lần trong x</span></span>
<span></span>
<span><span class="co"># Chỉ số của các phần tử của y trong véc-tơ x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">y</span>,<span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 6 1</code></pre>
<p>Các giá trị 10 và 20 của <span style="color: #640514; font-family: Source Code Pro;">y</span> xuất hiện hai lần trong <span style="color: #640514; font-family: Source Code Pro;">x</span>, tuy nhiên hàm<span style="color: #640514; font-family: Source Code Pro;">match()</span>sẽ trả lại giá trị là 6 và 1 bởi vì số 10 xuất hiện lần đầu tiên ở vị trí thứ 6 trong <span style="color: #640514; font-family: Source Code Pro;">x</span> và số 20 xuất hiện lần đầu tiên ở vị trí thứ 1 trong <span style="color: #640514; font-family: Source Code Pro;">x</span>.</p>
<p>Hàm <span style="color: #640514; font-family: Source Code Pro;">match()</span> trả lại kết quả là véc-tơ chỉ số nên sẽ phù hợp với việc lấy véc-tơ con theo chỉ số kiểu số. Một phương pháp khác để tạo chỉ số của véc-tơ là toán tử <span style="color: #640514; font-family: Source Code Pro;">%in%</span>. Toán tử <span style="color: #640514; font-family: Source Code Pro;">%in%</span> được sử dụng để cho biết mỗi phần tử của một véc-tơ có nằm trong một véc-tơ khác hay không. Câu lệnh <span style="color: #640514; font-family: Source Code Pro;">y %in% x</span> sẽ trả lại giá trị là một véc-tơ kiểu logic, tạm gọi là <span style="color: #640514; font-family: Source Code Pro;">z</span>, có độ dài bằng với độ dài của <span style="color: #640514; font-family: Source Code Pro;">y</span>, đồng thời <span style="color: #640514; font-family: Source Code Pro;">z[i]</span> nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">TRUE</span> nếu <span style="color: #640514; font-family: Source Code Pro;">y[i]</span> có xuất hiện trong <span style="color: #640514; font-family: Source Code Pro;">x</span>, và nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">FALSE</span> nếu <span style="color: #640514; font-family: Source Code Pro;">y[i]</span> không xuất hiện trong <span style="color: #640514; font-family: Source Code Pro;">x</span>. Bạn đọc hãy quan sát ví dụ dưới đây:</p>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ x và véc-tơ y kiểu số</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">40</span>,<span class="fl">60</span>,<span class="fl">50</span>,<span class="fl">30</span>,<span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">60</span>,<span class="fl">10</span>,<span class="fl">70</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Cho biết các phần tử của y có nằm trong x hay không</span></span>
<span><span class="va">y</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">x</span></span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE FALSE</code></pre>
<p>Những bạn đọc mới làm quen với R thường dễ nhầm lẫn cách sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">match()</span> và toán tử <span style="color: #640514; font-family: Source Code Pro;">%in%</span>. Cách duy nhất để hiểu và thực hiện thành thạo đó là thực hành trên dữ liệu thực tế nhiều lần. Hình <a href="ki%E1%BA%BFn-th%E1%BB%A9c-r-c%C6%A1-b%E1%BA%A3n.html#fig:fgbasic1">3.2</a> dưới đây minh họa sự khác nhau trong kết quả được trả ra của hàm <span style="color: #640514; font-family: Source Code Pro;">match()</span>và toán tử <span style="color: #640514; font-family: Source Code Pro;">%in%</span></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fgbasic1"></span>
<img src="07-lap-trinh-co-ban-voi-R_files/figure-html/fgbasic1-1.png" alt="Sự khác nhau giữa hàm match() và toán tử %in%" width="960"><p class="caption">
Hình 3.2: Sự khác nhau giữa hàm match() và toán tử %in%
</p>
</div>
<p>Hàm <span style="color: #640514; font-family: Source Code Pro;">match()</span> và toán tử <span style="color: #640514; font-family: Source Code Pro;">%in%</span> cho phép tương tác giữa các véc-tơ có độ dài khác nhau nên rất hiệu quả khi bạn đọc muốn kết nối nhiều dữ liệu khác nhau. Bạn đọc hãy đọc ví dụ dưới đây để hình dung cách sử dụng hàm<span style="color: #640514; font-family: Source Code Pro;">match()</span>khi kết nối hai dữ liệu.</p>
<p>Giả sử chúng ta có danh sách điểm học tại trường đại học của ba sinh viên ngành actuary có mã sinh viên lần lượt là <span style="color: #640514; font-family: Source Code Pro;">MSV001</span>, <span style="color: #640514; font-family: Source Code Pro;">MSV002</span>, <span style="color: #640514; font-family: Source Code Pro;">MSV003</span> khi học các môn học <span style="color: #640514; font-family: Source Code Pro;">Xác suất</span>, <span style="color: #640514; font-family: Source Code Pro;">Toán tài chính</span>, và <span style="color: #640514; font-family: Source Code Pro;">Đầu tư và thị trường tài chính</span>. Thông tin được lưu trong một dữ liệu tên là <span style="color: #640514; font-family: Source Code Pro;">diem_hoc_DH</span>. Sinh viên ngành actuary ngoài các môn học ở trường đại học có thể thi các môn học tại các hiệp hội nghề nghiệp actuary để lấy chứng chỉ hành nghề. Thông tin về điểm thi chứng chỉ được lưu trong dữ liệu có tên là <span style="color: #640514; font-family: Source Code Pro;">diem_chung_chi_Actuary</span>. Khi xét tốt nghiệp, sinh viên có quyền lấy điểm thi chứng chỉ tại các hiệp hội để thay thế cho điểm học tại trường đại học của môn học tương ứng nếu điểm thi chứng chỉ cao hơn. Dữ liệu về điểm thi tại trường đại học và thi chứng chỉ hành nghề như sau:</p>
<div class="inline-table"><table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Mã sinh viên
</th>
<th style="text-align:left;">
Môn học
</th>
<th style="text-align:right;">
Điểm thi
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
MSV001
</td>
<td style="text-align:left;">
Xác suất
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV002
</td>
<td style="text-align:left;">
Xác suất
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV003
</td>
<td style="text-align:left;">
Xác suất
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV001
</td>
<td style="text-align:left;">
Toán tài chính
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV002
</td>
<td style="text-align:left;">
Toán tài chính
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV003
</td>
<td style="text-align:left;">
Toán tài chính
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV001
</td>
<td style="text-align:left;">
Đầu tư và thị trường tài chính
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV002
</td>
<td style="text-align:left;">
Đầu tư và thị trường tài chính
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV003
</td>
<td style="text-align:left;">
Đầu tư và thị trường tài chính
</td>
<td style="text-align:right;">
10
</td>
</tr>
</tbody>
</table></div>
<div class="inline-table"><table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Mã sinh viên
</th>
<th style="text-align:left;">
Môn học
</th>
<th style="text-align:right;">
Điểm thi
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
MSV005
</td>
<td style="text-align:left;">
Xác suất
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV002
</td>
<td style="text-align:left;">
Xác suất
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV004
</td>
<td style="text-align:left;">
Xác suất
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV003
</td>
<td style="text-align:left;">
Toán tài chính
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV002
</td>
<td style="text-align:left;">
Toán tài chính
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV001
</td>
<td style="text-align:left;">
Đầu tư và thị trường tài chính
</td>
<td style="text-align:right;">
8
</td>
</tr>
</tbody>
</table></div>
<p>Để tìm được điểm thi chứng chỉ của sinh viên trong bảng <span style="color: #640514; font-family: Source Code Pro;">diem_hoc_DH</span> chúng ta phải kết nối bảng này với bảng “diem_chung_chi_Actuary” thông qua mã sinh viên và tên môn học bằng cách sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">match()</span>. Việc kết nối sẽ được thực hiện bằng cách tạo ra trên mỗi bảng một biến có tên là <span style="color: #640514; font-family: Source Code Pro;">key</span> là tổ hợp của mã sinh viên và tên môn học.</p>
<p>Trước hết bạn đọc có thể tạo hai dữ liệu dựa trên thông tin của hai bảng bằng đoạn lệnh như dưới đây:</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># du lieu diem_hoc_DH</span></span>
<span><span class="va">MSV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"MSV001"</span>, <span class="st">"MSV002"</span>, <span class="st">"MSV003"</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">Mon_hoc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Xác suất"</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Toán tài chính"</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Đầu tư và thị trường tài chính"</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Diem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">6</span>,<span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">5</span>,<span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">diem_hoc_DH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">MSV</span>, <span class="va">Mon_hoc</span>, <span class="va">Diem</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># du lieu diem_chung_chi_Actuary</span></span>
<span><span class="va">MSV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MSV005"</span>, <span class="st">"MSV002"</span>, <span class="st">"MSV004"</span>, <span class="st">"MSV003"</span>, <span class="st">"MSV002"</span>, <span class="st">"MSV001"</span><span class="op">)</span></span>
<span><span class="va">Mon_hoc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Xác suất"</span>, <span class="st">"Xác suất"</span>, <span class="st">"Xác suất"</span>, <span class="st">"Toán tài chính"</span>, <span class="st">"Toán tài chính"</span>, <span class="st">"Đầu tư và thị trường tài chính"</span><span class="op">)</span></span>
<span><span class="va">Diem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">9</span>,<span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">diem_chung_chi_Actuary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">MSV</span>, <span class="va">Mon_hoc</span>, <span class="va">Diem</span><span class="op">)</span></span></code></pre></div>
<p>Chúng ta tạo ra biến <span style="color: #640514; font-family: Source Code Pro;">key</span> trêm hai bảng để kết nối hai bảng; véc-tơ tạo ra bằng cách kết hợp từ véc-tơ chứa mã sinh viên và véc-tơ tên môn học</p>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diem_hoc_DH_key</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">diem_hoc_DH</span><span class="op">$</span><span class="va">MSV</span>, <span class="va">diem_hoc_DH</span><span class="op">$</span><span class="va">Mon_hoc</span><span class="op">)</span></span>
<span><span class="va">diem_chung_chi_Actuary_key</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">diem_chung_chi_Actuary</span><span class="op">$</span><span class="va">MSV</span>, <span class="va">diem_chung_chi_Actuary</span><span class="op">$</span><span class="va">Mon_hoc</span><span class="op">)</span></span></code></pre></div>
<p>Toán tử <span style="color: #640514; font-family: Source Code Pro;">%in%</span> sẽ cho chúng ta biết những phần tử nào trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">diem_hoc_DH_key</span> nằm trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">diem_chung_chi_Actuary_key</span> hay nói một cách khác, sinh viên nào trong bảng <span style="color: #640514; font-family: Source Code Pro;">diem_hoc_DH</span> có thi chứng chỉ tương ứng với môn học ở trường đại học:</p>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span><span class="op">&lt;-</span><span class="va">diem_hoc_DH_key</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">diem_chung_chi_Actuary_key</span></span></code></pre></div>
<p>Chỉ số <span style="color: #640514; font-family: Source Code Pro;">y</span> là kết quả của toán tử <span style="color: #640514; font-family: Source Code Pro;">%in%</span> nên sẽ là véc-tơ kiểu logic. <span style="color: #640514; font-family: Source Code Pro;">y</span> có độ dài là 9 bằng với số quan sát của dữ liệu <span style="color: #640514; font-family: Source Code Pro;">diem_hoc_DH</span> và cho biết tương ứng mỗi sinh viên có thi chứng chỉ môn học tương ứng hay không. Chẳng hạn như muốn tạo ra danh sách thi chứng chỉ của sinh viên lớp Actuary chúng ta sử dụng cách lấy véc-tơ con với chỉ số <span style="color: #640514; font-family: Source Code Pro;">y</span> như sau</p>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lọc véc-tơ cột MSV bằng véc-tơ kiểu logic y</span></span>
<span><span class="co"># Lọc véc-tơ cột tên môn học bằng véc-tơ kiểu logic y</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>MSV <span class="op">=</span> <span class="va">diem_hoc_DH</span><span class="op">$</span><span class="va">MSV</span><span class="op">[</span><span class="va">y</span><span class="op">]</span>,</span>
<span>           Diem <span class="op">=</span> <span class="va">diem_hoc_DH</span><span class="op">$</span><span class="va">Mon_hoc</span><span class="op">[</span><span class="va">y</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>##      MSV                           Diem
## 1 MSV002                       Xác suất
## 2 MSV002                 Toán tài chính
## 3 MSV003                 Toán tài chính
## 4 MSV001 Đầu tư và thị trường tài chính</code></pre>
<p>Để tìm được điểm thi chứng chỉ của các sinh viên lớp Actuary chúng ta cần biết kết nối mã sinh viên và môn học từ bảng <span style="color: #640514; font-family: Source Code Pro;">diem_hoc_DH</span> đến bảng <span style="color: #640514; font-family: Source Code Pro;">diem_chung_chi_Actuary</span> bằng cách sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">match()</span></p>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">diem_hoc_DH_key</span>,<span class="va">diem_chung_chi_Actuary_key</span><span class="op">)</span></span></code></pre></div>
<p>Véc-tơ <span style="color: #640514; font-family: Source Code Pro;">y</span> có độ dài bằng 9, cho biết mỗi quan sát của dữ liệu <span style="color: #640514; font-family: Source Code Pro;">diem_hoc_DH</span> tương ứng với dòng thứ bao nhiêu (chỉ số) của dữ liệu <span style="color: #640514; font-family: Source Code Pro;">diem_chung_chi_Actuary</span>. Giá trị <span style="color: #640514; font-family: Source Code Pro;">NA</span> trong <span style="color: #640514; font-family: Source Code Pro;">y</span> có ý nghĩa là quan sát đó của dữ liệu <span style="color: #640514; font-family: Source Code Pro;">diem_hoc_DH</span> không xuất hiện trong <span style="color: #640514; font-family: Source Code Pro;">diem_chung_chi_Actuary</span>, hay nói cách khác sinh viên không thi chứng chỉ môn học tương ứng. Chúng ta có thể thêm một cột (véc-tơ) gọi là <span style="color: #640514; font-family: Source Code Pro;">diem_CT</span> cho bảng <span style="color: #640514; font-family: Source Code Pro;">diem_hoc_DH</span></p>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lọc véc-tơ con bằng véc-tơ chỉ số y kiểu số</span></span>
<span><span class="va">diem_hoc_DH</span><span class="op">$</span><span class="va">diem_CT</span><span class="op">&lt;-</span><span class="va">diem_chung_chi_Actuary</span><span class="op">$</span><span class="va">Diem</span><span class="op">[</span><span class="va">y</span><span class="op">]</span></span></code></pre></div>
<p>Như vậy chúng ta đã có một dữ liệu với điểm học trên lớp và điểm thi chứng chỉ của các sinh viên</p>
<div class="inline-table"><table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Mã sinh viên
</th>
<th style="text-align:left;">
Môn học
</th>
<th style="text-align:right;">
Điểm thi
</th>
<th style="text-align:right;">
Điểm chứng chỉ
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
MSV001
</td>
<td style="text-align:left;">
Xác suất
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV002
</td>
<td style="text-align:left;">
Xác suất
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV003
</td>
<td style="text-align:left;">
Xác suất
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV001
</td>
<td style="text-align:left;">
Toán tài chính
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV002
</td>
<td style="text-align:left;">
Toán tài chính
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV003
</td>
<td style="text-align:left;">
Toán tài chính
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV001
</td>
<td style="text-align:left;">
Đầu tư và thị trường tài chính
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV002
</td>
<td style="text-align:left;">
Đầu tư và thị trường tài chính
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
MSV003
</td>
<td style="text-align:left;">
Đầu tư và thị trường tài chính
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="hàm-rank-và-hàm-order" class="section level4" number="3.3.4.3">
<h4>
<span class="header-section-number">3.3.4.3</span> Hàm <span style="color: #640514; font-family: Source Code Pro;">rank()</span> và hàm <span style="color: #640514; font-family: Source Code Pro;">order()</span><a class="anchor" aria-label="anchor" href="#h%C3%A0m-rank-v%C3%A0-h%C3%A0m-order"><i class="fas fa-link"></i></a>
</h4>
<p>Hàm <span style="color: #640514; font-family: Source Code Pro;">rank()</span> trả lại giá trị là thứ tự (rank) của một phần tử trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> khi sắp xếp <span style="color: #640514; font-family: Source Code Pro;">x</span> theo thứ tự tăng dần. Thứ tự tăng dần ở đây được hiểu đối với cả các véc-tơ kiểu chuỗi ký tự. Bạn đọc có thể quan sát kết quả của hàm <span style="color: #640514; font-family: Source Code Pro;">rank()</span> trong ví dụ dưới đây:</p>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ x kiểu số</span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">40</span>,<span class="fl">60</span>,<span class="fl">50</span>,<span class="fl">30</span>,<span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Áp dụng hàm rank trên véc-tơ x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># số lớn nhất (60) có chỉ số 6, số nhỏ nhất (10) có chỉ số 1</span></span></code></pre></div>
<pre><code>## [1] 2 4 6 5 3 1</code></pre>
<p>Lưu ý rằng hàm <span style="color: #640514; font-family: Source Code Pro;">rank()</span> có một tham số quan trọng là <span style="color: #640514; font-family: Source Code Pro;">ties.method</span>. Khi bạn đọc không sử dụng tùy chọn này, giá trị mặc định là <span style="color: #640514; font-family: Source Code Pro;">average</span>. Tham số <span style="color: #640514; font-family: Source Code Pro;">ties.method</span> chỉ có ý nghĩa khi trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> có các giá trị giống nhau. Nếu các phần tử trong <span style="color: #640514; font-family: Source Code Pro;">x</span> là đôi một khác nhau, bất kỳ tùy chọn nào đối với <span style="color: #640514; font-family: Source Code Pro;">ties.method</span> cũng trả lại một kết quả duy nhất.</p>
<p>Khi <span style="color: #640514; font-family: Source Code Pro;">x</span> có các giá trị bị lặp lại, các giá trị khác nhau của <span style="color: #640514; font-family: Source Code Pro;">ties.method</span> sẽ cho kết quả khác nhau. Bạn đọc hãy quan sát ví dụ sau để thấy sự khác biệt:</p>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ x kiểu số</span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ties.method = "first" -&gt; giá trị xuất hiện TRƯỚC có rank NHỎ hơn</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span>,ties.method <span class="op">=</span> <span class="st">"first"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ties.method = "last" -&gt; giá trị xuất hiện TRƯỚC có rank LỚN hơn</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span>,ties.method <span class="op">=</span> <span class="st">"last"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 3 2 1 5 4</code></pre>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ties.method = "min" -&gt; các số bằng nhau có rank bằng nhau và bằng min</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span>,ties.method <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1 1 1 4 4</code></pre>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ties.method = "max" -&gt; các số bằng nhau có rank bằng nhau và bằng max</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span>,ties.method <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 3 3 3 5 5</code></pre>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ties.method = "average" -&gt; các số bằng nhau có rank bằng nhau và bằng mean</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span>,ties.method <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 2.0 2.0 2.0 4.5 4.5</code></pre>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ties.method = "average" -&gt; các số bằng nhau có rank là hoán vị ngẫu nhiên</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span>,ties.method <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<ul>
<li>Khi <span style="color: #640514; font-family: Source Code Pro;">ties.method</span> nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">first</span>, giá trị trả lại là <span style="color: #640514; font-family: Source Code Pro;">1, 2, 3, 4, 5</span>. Ba giá trị 10 liền nhau ở phần đầu của véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> được xếp thứ tự theo nguyên tắc số nào xuất hiện trước là có thứ tự nhỏ hơn, do đó thứ tự của ba giá trị trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> khi xếp <span style="color: #640514; font-family: Source Code Pro;">x</span> theo thứ tự tăng dần là <span style="color: #640514; font-family: Source Code Pro;">1, 2, 3</span>. Tương tự với hai giá trị 20 ở cuối vec-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span>, số 20 xuất hiện trước được hiểu là có thứ tự trước số 20 xuất hiện sau, do đó thứ tự của hai giá trị 20 sẽ là <span style="color: #640514; font-family: Source Code Pro;">4, 5</span>
</li>
<li>Khi <span style="color: #640514; font-family: Source Code Pro;">ties.method</span> nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">last</span> giá trị trả lại là <span style="color: #640514; font-family: Source Code Pro;">3, 2, 1, 5, 4</span>. Ba giá trị 10 liền nhau ở phần đầu của véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> được xếp thứ tự theo nguyên tắc số nào xuất hiện trước là có thử tự lớn hơn, do đó thứ tự của ba số 10 này trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> khi xếp <span style="color: #640514; font-family: Source Code Pro;">x</span> theo thứ tự tăng dần là <span style="color: #640514; font-family: Source Code Pro;">3, 2, 1</span>. Tương tự với hai số 20 ở cuối vec-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span>, số 20 xuất hiện trước được hiểu là có thứ tự lớn hơn số 20 xuất hiện sau, do đó thứ tự của hai số 20 sẽ là <span style="color: #640514; font-family: Source Code Pro;">5, 4</span>
</li>
<li>Khi <span style="color: #640514; font-family: Source Code Pro;">ties.method</span> nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">min</span>, giá trị trả lại là <span style="color: #640514; font-family: Source Code Pro;">1, 1, 1, 4, 4</span>. Ba số 10 liền nhau ở phần đầu của véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> có thứ tự bằng nhau là 1. Đây chính là thứ tự nhỏ nhất của ba số khi xếp các số này theo tùy chọn <span style="color: #640514; font-family: Source Code Pro;">ties.method</span> nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">first</span>. Tương tự ta có thứ tự của hai số 20 tiếp theo bằng nhau và bằng <span style="color: #640514; font-family: Source Code Pro;">4</span>.</li>
<li>Tham số <span style="color: #640514; font-family: Source Code Pro;">ties.method</span> nhận giá trị <span style="color: #640514; font-family: Source Code Pro;">max</span> sẽ cho kết quả ngược lại với <span style="color: #640514; font-family: Source Code Pro;">min</span>. Thứ tự của ba số 10 đầu tiên trong <span style="color: #640514; font-family: Source Code Pro;">x</span> đều bằng <span style="color: #640514; font-family: Source Code Pro;">3</span> - là số lớn nhất trong (1, 2, 3) đồng thời thứ tự của hai số 20 tiếp theo đều là <span style="color: #640514; font-family: Source Code Pro;">5</span> - là số lớn nhất trong (4,5).</li>
<li>Khi <span style="color: #640514; font-family: Source Code Pro;">ties.method</span> nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">average</span>, cũng là giá trị mặc định khi sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">rank()</span>, thứ tự của ba số 10 ở đầu véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> được tính là trung bình của thứ tự khi xếp theo giá trị <span style="color: #640514; font-family: Source Code Pro;">first</span>. Thứ tự của ba giá trị 10 khi <span style="color: #640514; font-family: Source Code Pro;">ties.method</span> nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">first</span> là <span style="color: #640514; font-family: Source Code Pro;">1, 2, 3</span>. Thứ tự khi <span style="color: #640514; font-family: Source Code Pro;">ties.method</span> nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">average</span> là
<span class="math display">\[\begin{align}
\cfrac{1 + 2 + 3}{3} = 2
\end{align}\]</span>
và thứ tự của hai số 20 ở cuối véc-tơ là</li>
</ul>
<p><span class="math display">\[\begin{align}
\cfrac{4 + 5}{2} = 4.5
\end{align}\]</span></p>
<ul>
<li>Cuối cùng, khi <span style="color: #640514; font-family: Source Code Pro;">ties.method</span> nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">random</span>, thứ tự của ba số 10 ở đầu véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> là một hoán vị ngẫu nhiên của (1,2,3) cũng là thứ tự của ba số khi <span style="color: #640514; font-family: Source Code Pro;">ties.method</span> nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">first</span>. Bạn đọc có thể thấy rằng hai lần gọi hàm <span style="color: #640514; font-family: Source Code Pro;">rank()</span> với tham số <span style="color: #640514; font-family: Source Code Pro;">ties.method = random</span> có thể cho kết quả là khác nhau.</li>
</ul>
<p>Một hàm số khác trả lại giá trị là chỉ số của véc-tơ là hàm <span style="color: #640514; font-family: Source Code Pro;">order()</span>. Câu lệnh <span style="color: #640514; font-family: Source Code Pro;">y &lt;- order(x)</span> trả lại giá trị là một véc-tơ <span style="color: #640514; font-family: Source Code Pro;">y</span> là các chỉ số của <span style="color: #640514; font-family: Source Code Pro;">x</span> sao cho:</p>
<ul>
<li><p><span style="color: #640514; font-family: Source Code Pro;">y[1]</span> là chỉ số của số nhỏ nhất trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span>;</p></li>
<li><p><span style="color: #640514; font-family: Source Code Pro;">y[2]</span> là chỉ số của số nhỏ thứ hai trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span>; …</p></li>
<li><p>Số cuối cùng trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">y</span> là chỉ số của số lớn nhất trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span>.</p></li>
</ul>
<p>Khi muốn lấy chỉ số của véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> nhưng theo thứ tự giảm dần, bạn đọc sử dụng tham số <span style="color: #640514; font-family: Source Code Pro;">decreasing = TRUE</span> trong hàm <span style="color: #640514; font-family: Source Code Pro;">order()</span>. Khái niệm tăng dần và giảm dần cũng có thể hiểu cho các véc-tơ kiểu thời gian, kiểu <span style="color: #640514; font-family: Source Code Pro;">factor</span> hay kiểu chuỗi ký tự.</p>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ x kiểu số</span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">40</span>,<span class="fl">60</span>,<span class="fl">50</span>,<span class="fl">30</span>,<span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Áp dụng hàm order trên x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># chỉ số khi xếp x theo thứ tự TĂNG dần</span></span></code></pre></div>
<pre><code>## [1] 6 1 5 2 4 3</code></pre>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Áp dụng hàm order trên x, với tham số decreasing = TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">x</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># chỉ số khi xếp x theo thứ tự GIẢM dần</span></span></code></pre></div>
<pre><code>## [1] 3 4 2 5 1 6</code></pre>
<p>Câu lệnh <span style="color: #640514; font-family: Source Code Pro;">order(x)</span> cho kết quả là 6 tại vị trí thứ nhất có nghĩa là số nhỏ nhất trong <span style="color: #640514; font-family: Source Code Pro;">x</span> nằm ở vị trí thứ sáu trong véc-tơ này (số 10). Vị trí thứ hai trong <span style="color: #640514; font-family: Source Code Pro;">order(x)</span> nhận giá trị là 1 có nghĩa là số nhỏ thứ hai trong <span style="color: #640514; font-family: Source Code Pro;">x</span> nằm ở vị trí thứ nhất trong véc-tơ này, và cứ tiếp tục như thế. Vị trí cuối cùng trong <span style="color: #640514; font-family: Source Code Pro;">order(x)</span> có giá trị là 3 có nghĩa là số lớn nhất trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> nằm ở vị trí thứ 3 trong véc-tơ này.</p>
<p>Câu lệnh <span style="color: #640514; font-family: Source Code Pro;">order(x)</span> có thể được phỏng theo được bằng cách khớp chỉ số của véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> với véc-tơ được tạo thành từ câu lệnh <span style="color: #640514; font-family: Source Code Pro;">rank(x, ties.method = ‘first’)</span>, thật vậy:</p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ x kiểu số</span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">20</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span> <span class="co"># véc-tơ x kiểu số có các giá trị lặp lại</span></span>
<span></span>
<span><span class="co"># Khởi tạo chỉ số tăng dần</span></span>
<span><span class="va">chiso</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># match véc-tơ chiso với rank của x để được order của x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">chiso</span>,<span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">x</span>, ties.method <span class="op">=</span> <span class="st">"first"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 3 4 5 1 2</code></pre>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Áp dụng order trên x cho kết quả tương tự</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 3 4 5 1 2</code></pre>
<p>Sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">order()</span> bạn đọc có thể dễ dàng lấy ra các giá trị nhỏ (hoặc lớn) thứ <em>k</em> trong một véc-tơ. Chẳng hạn như bạn đọc muốn lấy ra câu status có số lượt yêu thích nhiều thứ hai của cựu tổng thống Donald Trump trong dữ liệu <span style="color: #640514; font-family: Source Code Pro;">trump_tweet</span>, bạn có thể sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">order()</span> như sau:</p>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cột chứa số lượng like là cột favorite_count</span></span>
<span><span class="co"># Chỉ số của câu status được like nhiều thứ hai</span></span>
<span><span class="va">y</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">trump_tweets</span><span class="op">$</span><span class="va">favorite_count</span>, decreasing <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Lấy ra câu status tại vị trí y</span></span>
<span><span class="va">trump_tweets</span><span class="op">$</span><span class="va">text</span><span class="op">[</span><span class="va">y</span><span class="op">]</span> <span class="co"># là câu tweet được like nhiều thứ hai</span></span></code></pre></div>
<pre><code>## [1] "Why would Kim Jong-un insult me by calling me \"old,\" when I would NEVER call him \"short and fat?\" Oh well, I try so hard to be his friend - and maybe someday that will happen!"</code></pre>
<p>Như vậy, chúng tôi đã giới thiệu với bạn đọc những khái niệm cơ bản nhất của R, bao gồm có biến, véc-tơ và các phép tính toán trên các đối tượng này. Trong phần tiếp theo, chúng tôi sẽ nói về lập trình với ngôn ngữ R. Mặc dù R được phát triển để các câu lệnh được viết dưới dạng đơn giản nhất có thể, nhưng trong đa số các dự án liên quan đến dữ liệu, yêu cầu về viết các vòng lặp, hay viết hàm số là không thể tránh khỏi. Phần tiếp theo của cuốn sách sẽ thảo luận về các khái niệm cơ bản về cách lập trình trong ngôn ngữ R.</p>
</div>
</div>
</div>
<div id="ngôn-ngữ-lập-trình-r" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Ngôn ngữ lập trình R<a class="anchor" aria-label="anchor" href="#ng%C3%B4n-ng%E1%BB%AF-l%E1%BA%ADp-tr%C3%ACnh-r"><i class="fas fa-link"></i></a>
</h2>
<p>Để viết các chương trình phức tạp, bạn đọc sẽ cần kiểm soát tốt trình tự mà các dòng lệnh thực thi. Một cách cơ bản để làm được việc này là thực hiện một số câu lệnh nhất định phụ thuộc vào một hoặc một số điều kiện hay còn gọi là viết các câu lệnh rẽ nhánh. Một cách kiểm soát khác là sử dụng vòng lặp nhằm lặp lại một nhóm các câu lệnh một số lần nhất định. Trong phần này, chúng ta sẽ khám phá những kiến thức lập trình cơ bản này trong ngôn ngữ lập trình R. Các kiến thức về lập trình bao gồm có cách sử dụng câu lệnh rẽ nhánh (if-else), cách sử dụng vòng lặp (for, while, và repeat) và một vài cấu trúc khác giúp bạn đọc điều khiển được cách thực hiện các dòng lệnh của mình. Bạn đọc đã có kiến thức về lập trình trong bất kỳ ngôn ngữ nào khác có thể chỉ cần xem qua để nắm được cách viết ngôn ngữ lập trình của R. Với các bạn đọc mới làm quen với lập trình, hãy cố gắng đọc kỹ từng phần dưới đây để có thể tự viết được các chương trình phức tạp.</p>
<div id="câu-lệnh-điều-kiện" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Câu lệnh điều kiện<a class="anchor" aria-label="anchor" href="#c%C3%A2u-l%E1%BB%87nh-%C4%91i%E1%BB%81u-ki%E1%BB%87n"><i class="fas fa-link"></i></a>
</h3>
<div id="câu-lệnh-if-và-if-else" class="section level4" number="3.4.1.1">
<h4>
<span class="header-section-number">3.4.1.1</span> Câu lệnh <span style="color: #640514; font-family: Source Code Pro;">if</span> và <span style="color: #640514; font-family: Source Code Pro;">if</span>-<span style="color: #640514; font-family: Source Code Pro;">else</span><a class="anchor" aria-label="anchor" href="#c%C3%A2u-l%E1%BB%87nh-if-v%C3%A0-if-else"><i class="fas fa-link"></i></a>
</h4>
<p>Bạn đọc sử dụng câu lệnh điều kiệu để thông báo cho R biết một câu lệnh, hay một nhóm câu lệnh chỉ thực hiện khi một điều kiện nào đó được thực thi. Dưới đây là cách viết của câu lệnh <span style="color: #640514; font-family: Source Code Pro;">if</span> trong ngôn ngữ R</p>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="st">"Biểu thức điều kiện"</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="st">"Nhóm các câu lệnh thực hiện khi biểu thức điều kiện là ĐÚNG"</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Bạn đọc có thể thực hiện một đoạn lệnh có biểu thức điều kiện cụ thể như sau trên cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Console</span></p>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">&lt;-</span><span class="fl">1</span>; <span class="va">y</span><span class="op">&lt;-</span><span class="fl">2</span> <span class="co"># Dòng lệnh 1: tạo biến x = 1 và biến y = 2</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">x</span><span class="op">&lt;</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span> <span class="co"># Dòng lệnh 2: Nếu x &lt; 10 thì thực hiện các câu lệnh nằm trong {}</span></span>
<span>  <span class="va">y</span><span class="op">&lt;-</span><span class="fl">4</span> <span class="co"># Dòng lệnh 3: Gán giá trị y bằng 4</span></span>
<span><span class="op">}</span> <span class="co"># Dòng lệnh 4: kết thúc câu lệnh if</span></span></code></pre></div>
<p>Khi thực hiện nhóm các câu lệnh ở trên, dòng lệnh thứ 3 chỉ được thực hiện nếu biểu thức điều kiện được viết trong dấu ngoặc <span style="color: #640514; font-family: Source Code Pro;">()</span> sau từ khóa <span style="color: #640514; font-family: Source Code Pro;">if</span> ở dòng lệnh thứ 2 nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">TRUE</span>. Nếu biểu thức điều kiện đó nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">FALSE</span>, R sẽ không thực hiện các dòng lệnh thứ 3. Sau khi R thực thi các dòng lệnh 1, biến <span style="color: #640514; font-family: Source Code Pro;">x</span> nhận giá trị là 1 nên phép so sánh <span style="color: #640514; font-family: Source Code Pro;">(x&lt;10)</span> sẽ cho kết quả là <span style="color: #640514; font-family: Source Code Pro;">TRUE</span>. Do đó, dòng lệnh 3 gán giá trị mới bằng 4 cho biến <span style="color: #640514; font-family: Source Code Pro;">y</span> sẽ được thực hiện. Bạn đọc có thể kiểm tra được rằng sau khi thực hiện đoạn lệnh ở trên, giá trị của biến <span style="color: #640514; font-family: Source Code Pro;">y</span> sẽ bằng 4 chứ không phải là 2 như khởi tạo ở dòng lệnh số 1.</p>
<p>Khi sử dụng câu lệnh điều kiện <span style="color: #640514; font-family: Source Code Pro;">if</span>, sẽ không có câu lệnh nào được thực hiện trong trường hợp biểu thức điều kiện nhận giá trị là sai. Trong thực tế, đa phần các đoạn lệnh rẽ nhánh sẽ có các câu lệnh phải thực thi khi biểu thức điều kiện nhận giá trị là sai. Để thực hiện được việc này, bạn đọc sử dụng câu lệnh <span style="color: #640514; font-family: Source Code Pro;">if</span> kết hợp với <span style="color: #640514; font-family: Source Code Pro;">else</span> như sau</p>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="st">"Biểu thức điều kiện"</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="st">"Nhóm các câu lệnh thực hiện khi biểu thức điều kiện là ĐÚNG"</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="st">"Nhóm các câu lệnh thực hiện khi biểu thức điều kiện là SAI"</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Bạn đọc có thể quan sát sự thay đổi giá trị của biến <span style="color: #640514; font-family: Source Code Pro;">y</span> sau khi thực hiện đoạn lệnh như sau</p>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">&lt;-</span><span class="fl">1</span>; <span class="va">y</span><span class="op">&lt;-</span><span class="fl">2</span> <span class="co"># Dòng lệnh 1: tạo biến x = 1 và biến y = 2</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">x</span><span class="op">==</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span> <span class="co"># Dòng 2: Nếu x bằng 10 thì thực hiện các câu lệnh của if</span></span>
<span>  <span class="va">y</span><span class="op">&lt;-</span><span class="fl">4</span> <span class="co"># Dòng 3: Gán giá trị y bằng 4</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span> <span class="co"># Dòng 4: Nếu x KHÁC 10 thì thực hiện các câu lệnh của else</span></span>
<span>  <span class="va">y</span><span class="op">&lt;-</span><span class="fl">8</span> <span class="co"># Dòng 5: gán giá trị y bằng 4</span></span>
<span><span class="op">}</span> <span class="co"># Dòng lệnh 6: kết thúc câu lệnh if-else</span></span></code></pre></div>
<p>Do biểu thức điều kiện <span style="color: #640514; font-family: Source Code Pro;">(x==10)</span> nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">FALSE</span> nên R sẽ không thực hiện dòng lệnh số 3 mà chuyển qua thực hiện dòng lệnh số 5. Giá trị của <span style="color: #640514; font-family: Source Code Pro;">y</span> sau khi thực hiện dòng lệnh thứ 5 ở trên sẽ là 8. Nếu trong dòng lệnh 1, bạn đọc sửa giá trị của <span style="color: #640514; font-family: Source Code Pro;">x</span> thành 10 thay vì 1, dòng lệnh 3 sẽ được thực hiện và dòng lệnh số 5 không được thực hiện do đó giá trị của <span style="color: #640514; font-family: Source Code Pro;">y</span> sau khi thực hiện đoạn lệnh lúc này sẽ là 4.</p>
<p>Biểu thức điều kiện trong dấu ngoặc <span style="color: #640514; font-family: Source Code Pro;">()</span> đứng sau <span style="color: #640514; font-family: Source Code Pro;">if</span> phải là một biến kiểu logic. Nếu do sơ ý, biểu thức điều kiện là một véc-tơ của các biến kiểu logic, câu lệnh <span style="color: #640514; font-family: Source Code Pro;">if</span> sẽ chỉ tính đến giá trị đầu tiên trong véc-tơ.</p>
<div class="sourceCode" id="cb201"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dieukien</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">dieukien</span><span class="op">)</span><span class="op">{</span> <span class="co"># dieukien là một véc-tơ kiểu logic</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"Xin chào"</span><span class="op">)</span> <span class="co">#R CÓ chạy dòng lệnh này</span></span>
<span><span class="op">}</span> <span class="co"># kết thúc câu lệnh if</span></span></code></pre></div>
<p>Bạn đọc có thể sẽ gặp câu lệnh <span style="color: #640514; font-family: Source Code Pro;">ifelse()</span> trong các đoạn câu lệnh của R. Tuy nhiên đây không phải là cách viết của câu lệnh rẽ nhánh. Hàm <span style="color: #640514; font-family: Source Code Pro;">ifelse()</span> được sử dụng khi muốn tạo ra một véc-tơ từ hai véc-tơ dựa trên giá trị của một véc-tơ kiểu logic. Cách sử dụng <span style="color: #640514; font-family: Source Code Pro;">ifelse()</span> được minh họa thông qua ví dụ dưới đây</p>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ x là số tự nhiên từ 1 đến 10</span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span></span>
<span><span class="co"># Áp dụng hàm ifelse trên véc-tơ x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span><span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span><span class="fl">2</span><span class="op">==</span><span class="fl">0</span>,<span class="st">"chẵn"</span>,<span class="st">"lẻ"</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] "lẻ"   "chẵn" "lẻ"   "chẵn" "lẻ"   "chẵn" "lẻ"   "chẵn" "lẻ"   "chẵn"</code></pre>
<p>Hàm <span style="color: #640514; font-family: Source Code Pro;">ifelse()</span> ở trên sẽ tạo ra một véc-tơ có độ dài bằng với véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> và tương ứng với các vị trí <span style="color: #640514; font-family: Source Code Pro;">x</span> chia hết cho 2 sẽ cho kết quả là “chẵn” và tương ứng với các vị trí mà <span style="color: #640514; font-family: Source Code Pro;">x</span> không chia hết cho 2 sẽ cho kết quả là “lẻ”.</p>
<p>Khi sử dụng câu lệnh rẽ nhánh để thực hiện các yêu cầu phức tạp hơn, bạn đọc thường phải sử dụng các câu lệnh <span style="color: #640514; font-family: Source Code Pro;">if</span> và <span style="color: #640514; font-family: Source Code Pro;">else</span> lồng vào nhau để có được kết quả. Hãy lấy một ví dụ như sau: để viết một đoạn câu lệnh để trả lại giá trị giá vé vào rạp chiếu phim của một khách hàng dựa trên hai yếu tố là độ tuổi và việc có thẻ thành viên hay không, bạn đọc không thể chỉ dùng một câu lệnh điều kiện duy nhất.</p>
<div class="inline-table"><table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Độ tuổi
</th>
<th style="text-align:left;">
Có phải thành viên
</th>
<th style="text-align:left;">
Giá vé
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Trẻ em (dưới 6 tuổi)
</td>
<td style="text-align:left;">
Thành viên
</td>
<td style="text-align:left;">
70.000 đồng
</td>
</tr>
<tr>
<td style="text-align:left;">
Người lớn
</td>
<td style="text-align:left;">
Thành vien
</td>
<td style="text-align:left;">
120.000 đồng
</td>
</tr>
<tr>
<td style="text-align:left;">
Trẻ em (dưới 6 tuổi)
</td>
<td style="text-align:left;">
Không phải thành viên
</td>
<td style="text-align:left;">
100.000 đồng
</td>
</tr>
<tr>
<td style="text-align:left;">
Người lớn
</td>
<td style="text-align:left;">
Không phải thành viên
</td>
<td style="text-align:left;">
150.000 đồng
</td>
</tr>
</tbody>
</table></div>
<p>Giả sử biến Age là biến kiểu số cho biết độ tuổi của khách hàng và biến Member là biến kiểu logic nhận giá trị <span style="color: #640514; font-family: Source Code Pro;">TRUE</span> nếu khách hàng là thành viên và <span style="color: #640514; font-family: Source Code Pro;">FALSE</span> nếu khách hàng không phải là thành viên. Bạn đọc có thể sử dụng câu lệnh điều kiện để in ra màn hình giá vé của khách hàng đó bằng một trong hai cách như sau</p>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cách thứ nhất: sử dụng bốn câu lệnh if</span></span>
<span><span class="va">Age</span><span class="op">&lt;-</span><span class="fl">50</span>; <span class="va">Member</span><span class="op">&lt;-</span><span class="cn">TRUE</span> <span class="co"># tạo giá trị cho các biến Age, Member</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">Age</span> <span class="op">&lt;</span> <span class="fl">6</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">Member</span><span class="op">)</span><span class="op">{</span> <span class="co"># nếu khách hàng dưới 6 tuổi và là thành viên</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"70.000 đồng"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">Age</span> <span class="op">&lt;</span> <span class="fl">6</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">Member</span><span class="op">)</span><span class="op">{</span> <span class="co"># nếu khách hàng trên 6 tuổi và là thành viên</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"100.000 đồng"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">Age</span> <span class="op">&lt;</span> <span class="fl">6</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">Member</span><span class="op">)</span><span class="op">{</span> <span class="co"># nếu khách hàng dưới 6 tuổi và không phải thành viên</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"120.000 đồng"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">Age</span> <span class="op">&lt;</span> <span class="fl">6</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">Member</span><span class="op">)</span><span class="op">{</span> <span class="co"># nếu khách hàng trên 6 tuổi và không phải thành viên</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"150.000 đồng"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cách thứ hai: câu lệnh if-else</span></span>
<span><span class="va">Age</span><span class="op">&lt;-</span><span class="fl">50</span>; <span class="va">Member</span><span class="op">&lt;-</span><span class="cn">TRUE</span> <span class="co"># tạo giá trị cho các biến Age, Member</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">Age</span><span class="op">&lt;</span><span class="fl">6</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">Member</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"70.000 đồng"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"100.000 đồng"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">Member</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"120.000 đồng"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">"150.000 đồng"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div id="viết-vòng-lặp" class="section level3" number="3.4.2">
<h3>
<span class="header-section-number">3.4.2</span> Viết vòng lặp<a class="anchor" aria-label="anchor" href="#vi%E1%BA%BFt-v%C3%B2ng-l%E1%BA%B7p"><i class="fas fa-link"></i></a>
</h3>
<p>Vòng lặp là một cơ chế lập trình với mục đích để R lặp lại việc chạy một dòng lệnh hay một đoạn lệnh cụ thể. Có hai kiểu viết lặp đó là vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> hoạt động theo cách cho một phần tử nhận lần lượt từng giá trị trong một véc-tơ và vòng lặp <span style="color: #640514; font-family: Source Code Pro;">while</span> hoạt động theo cách lặp lại một đoạn mã cho đến khi một điều kiện cụ thể nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">FALSE</span>. Cách thức hoạt động kiểu vòng lặp cũng có thể được áp dụng khi sử dụng nhóm các hàm <span style="color: #640514; font-family: Source Code Pro;">apply()</span> trong R và sẽ được thảo luận ở một phần riêng của cuốn sách.</p>
<div id="vòng-lặp-for" class="section level4" number="3.4.2.1">
<h4>
<span class="header-section-number">3.4.2.1</span> Vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span><a class="anchor" aria-label="anchor" href="#v%C3%B2ng-l%E1%BA%B7p-for"><i class="fas fa-link"></i></a>
</h4>
<p>Những câu lệnh sau dùng để in ra màn hình tất cả các giá trị nằm trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">qua</span> bằng cách sử dụng một vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span></p>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khởi tạo véc-tơ qua chứa tên các loại quả</span></span>
<span><span class="va">qua</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chuối"</span>, <span class="st">"táo"</span>, <span class="st">"cam"</span>, <span class="st">"chanh"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Viết vòng lặp for</span></span>
<span><span class="co"># Cho một biến ten nhận lần lượt các giá trị trong qua</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">ten</span> <span class="kw">in</span> <span class="va">qua</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ten</span><span class="op">)</span> <span class="co"># in ten ra màn hình</span></span>
<span><span class="op">}</span> <span class="co"># kết thúc vòng lặp for</span></span></code></pre></div>
<pre><code>## [1] "chuối"
## [1] "táo"
## [1] "cam"
## [1] "chanh"</code></pre>
<p>Các dòng lệnh bắt đầu từ <span style="color: #640514; font-family: Source Code Pro;">for</span> đến kết thúc dấu ngoặc <span style="color: #640514; font-family: Source Code Pro;">{}</span> của vòng lặp có ý nghĩa như sau: cho một biến <span style="color: #640514; font-family: Source Code Pro;">ten</span> nhận lần lượt các giá trị trong véc-tơ <span style="color: #640514; font-family: Source Code Pro;">qua</span> từ giá trị ở vị trí thứ nhất đến giá trị ở vị trí cuối cùng; với mỗi giá trị mà biến <span style="color: #640514; font-family: Source Code Pro;">ten</span> nhận được, đoạn lệnh thực hiện nhóm các câu lệnh nằm trong dấu ngoặc <span style="color: #640514; font-family: Source Code Pro;">{}</span> của vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> một lần. Trong đoạn lệnh ở trên các câu lệnh được lặp lại là câu lệnh <span style="color: #640514; font-family: Source Code Pro;">print()</span> với tham số là biến <span style="color: #640514; font-family: Source Code Pro;">ten</span>.</p>
<p>Bạn đọc hãy thử một ví dụ khó hơn một chút, chẳng hạn như bạn muốn tính tổng các số trong một véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> và không sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">sum()</span>. Bạn có thể thực hiện việc này bẳng một vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> như sau:</p>
<ol style="list-style-type: decimal">
<li>Cho biến tên <span style="color: #640514; font-family: Source Code Pro;">tong</span> nhận giá trị bằng 0. <span style="color: #640514; font-family: Source Code Pro;">tong</span> sẽ là giá trị của tổng sau khi kết thúc vòng lặp</li>
</ol>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tong</span><span class="op">&lt;-</span><span class="fl">0</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Cho một biến tên là <span style="color: #640514; font-family: Source Code Pro;">gia_tri</span> nhận lần lượt các giá trị trong véc-tơ bắt đầu từ vị trí thứ nhất, tại mỗi lần lặp tăng giá trị biến <span style="color: #640514; font-family: Source Code Pro;">tong</span> lên đúng bằng giá trị của <span style="color: #640514; font-family: Source Code Pro;">gia_tri</span>
</li>
</ol>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">gia_tri</span> <span class="kw">in</span> <span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">tong</span><span class="op">&lt;-</span><span class="va">tong</span> <span class="op">+</span> <span class="va">gia_tri</span></span>
<span><span class="op">}</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Sau khi vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> chạy qua tất cả các giá trị trong véc-tơ cần tính tổng, biến <span style="color: #640514; font-family: Source Code Pro;">tong</span> sẽ chứa giá trị của tổng các số trong véc-tơ.</li>
</ol>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tong</span><span class="op">)</span></span></code></pre></div>
<p>Giả sử <span style="color: #640514; font-family: Source Code Pro;">x</span> là véc-tơ <span style="color: #640514; font-family: Source Code Pro;">Airpassengers</span> là một dữ liệu có sẵn trong R. Đây là một véc-tơ kiểu số, ở dạng chuỗi thời gian chứa thông tin về số lượng khách hàng đi máy bay hàng tháng, đơn vị là nghìn người, tính từ tháng 1 năm 1949 đến tháng 12 năm 1960. Chúng ta sử dụng vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> để tính tổng các số trong véc-tơ sau đó so sánh kết quả với hàm <span style="color: #640514; font-family: Source Code Pro;">sum()</span> có sẵn.</p>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tạo biến có tên tong nhận giá trị 0</span></span>
<span><span class="va">tong</span><span class="op">&lt;-</span><span class="fl">0</span></span>
<span><span class="co"># Dùng vòng lặp for</span></span>
<span><span class="co"># Cho biến gia_tri nhận lần lượt các giá trị trong Airpassengers</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">gia_tri</span> <span class="kw">in</span> <span class="va">AirPassengers</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">tong</span><span class="op">&lt;-</span><span class="va">tong</span> <span class="op">+</span> <span class="va">gia_tri</span> <span class="co"># tăng tong thêm giá trị bằng gia_tri</span></span>
<span><span class="op">}</span> <span class="co"># kết thúc vòng lặp</span></span>
<span><span class="va">tong</span> <span class="co"># in tong ra màn hình</span></span></code></pre></div>
<pre><code>## [1] 40363</code></pre>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># So sánh kết quả ở trên với hàm sum()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span> <span class="co"># cho kết quả tương tự</span></span></code></pre></div>
<pre><code>## [1] 40363</code></pre>
<p>Mặc dù đây là chương giới thiệu về viết vòng lặp, nhưng lời khuyên của chúng tôi là bạn đọc hãy luôn cố gắng viết câu lệnh trên các đối tượng vec-tơ nếu có thể thay vì viết vòng lặp. Sử dụng véc-tơ trong R hiệu quả hơn nhiều cả về thời gian chạy lẫn sự đơn giản của các dòng lệnh. Để đánh giá về hiệu quả thời gian, bạn đọc có thể xem ví dụ dưới đây khi sử dụng vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> cho những véc-tơ có độ dài lớn và so sánh với thời gian tính toán nếu viết dưới dạng đối tượng véc-tơ. Véc-tơ được sử dụng để kiểm tra tính hiệu quả là véc-tơ có độ dài <span class="math inline">\(10^8\)</span>:</p>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Khời tạo véc-tơ my_vector có độ dài 10^8</span></span>
<span><span class="va">my_vector</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">^</span><span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Tính tổng véc-tơ có độ dài 10^8 bằng vòng lặp</span></span>
<span><span class="va">start</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">tong</span><span class="op">&lt;-</span><span class="fl">0</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">value</span> <span class="kw">in</span> <span class="va">my_vector</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">tong</span><span class="op">&lt;-</span><span class="va">tong</span><span class="op">+</span><span class="va">value</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="va">start</span></span></code></pre></div>
<pre><code>##    user  system elapsed 
##   1.037   0.038   1.075</code></pre>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Tính tổng véc-tơ có độ dài 10^8 bằng véc-tơ</span></span>
<span><span class="va">start</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">tong</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">my_vector</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="va">start</span></span></code></pre></div>
<pre><code>##    user  system elapsed 
##   0.163   0.000   0.163</code></pre>
<p>Bạn đọc có thể thấy rằng trên máy tính của chúng tôi, sử dụng vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> để tính tổng các số trong véc-tơ có độ dài <span class="math inline">\(10^8\)</span> mất khoảng 2 giây trong khi dùng hàm <span style="color: #640514; font-family: Source Code Pro;">sum()</span> trực tiếp trên véc-tơ chỉ mất 0.1 giây. Nghĩa là thời gian để thực hiện tính toán trên véc-tơ nhanh hơn gấp 20 lần nếu bạn đọc viết dưới dạng đối tượng véc-tơ. Ngoài ra, sử bạn đọc cũng có thể thấy rằng câu lệnh gọi hàm <span style="color: #640514; font-family: Source Code Pro;">sum()</span> là đơn giản hơn nhiều so với viết vòng lặp.</p>
<p>Trong các ví dụ ở trên, chúng tôi sử dụng trực tiếp giá trị trong véc-tơ để thực hiện vòng lặp. Bạn đọc cũng có thể sử dụng vòng lặp theo chỉ số của véc-tơ và cho kết quả tương tự. Chẳng hạn như đối với véc-tơ <span style="color: #640514; font-family: Source Code Pro;">qua</span>, bạn đọc có thể cho một chỉ số nhận giá trị lần lượt từ 1 đến độ dài của véc-tơ <span style="color: #640514; font-family: Source Code Pro;">qua</span> để lấy từng phần tử của véc-tơ <span style="color: #640514; font-family: Source Code Pro;">qua</span>:</p>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">qua</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> <span class="co"># i sẽ nhận giá trị lần lượt 1,2,3,4</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">qua</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="co"># in ra giá trị thứ i trong véc-tơ qua</span></span>
<span><span class="op">}</span> <span class="co"># kết thúc vòng lặp</span></span></code></pre></div>
<pre><code>## [1] "chuối"
## [1] "táo"
## [1] "cam"
## [1] "chanh"</code></pre>
<p>Trong nhiều trường hợp, bạn đọc cần phải sử dụng một vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> nằm trong một vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> khác để giải quyết được vấn đề của mình. Ví dụ như bạn cần in ra tất cả các cách kết hợp giữa hai cách pha chế là <span style="color: #640514; font-family: Source Code Pro;">Nước ép</span> và <span style="color: #640514; font-family: Source Code Pro;">Sinh tố</span> với bốn loại quả ở trên. Bạn đọc cần sử dụng 2 vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> lồng nhau để làm được việc này:</p>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pha_che</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Nước ép"</span>, <span class="st">"Sinh tố"</span><span class="op">)</span> <span class="co"># 2 cách pha chế</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">pha_che</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> <span class="co"># i sẽ nhận giá trị lần lượt 1,2</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">qua</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> <span class="co"># VỚI MỐI i, j sẽ nhận giá trị lần lượt 1,2,3,4</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">pha_che</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">qua</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,sep<span class="op">=</span><span class="st">" "</span><span class="op">)</span><span class="op">)</span> <span class="co"># in ra màn hình pha chế và quả</span></span>
<span>  <span class="op">}</span> <span class="co"># kết thúc vòng lặp của j với mỗi i</span></span>
<span><span class="op">}</span> <span class="co"># kết thúc vòng lặp của i</span></span></code></pre></div>
<pre><code>## [1] "Nước ép chuối"
## [1] "Nước ép táo"
## [1] "Nước ép cam"
## [1] "Nước ép chanh"
## [1] "Sinh tố chuối"
## [1] "Sinh tố táo"
## [1] "Sinh tố cam"
## [1] "Sinh tố chanh"</code></pre>
<p>Trong ví dụ ở trên, tổng số lần câu lệnh <span style="color: #640514; font-family: Source Code Pro;">print()</span> được lặp là <span class="math inline">\(4 \times 2 = 8 (\text{lần})\)</span>. Mỗi khi viết vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span>, đặc biệt là khi viết các vòng lặp lồng vào nhau, bạn đọc hãy luôn cân nhắc thời gian R chạy vòng lặp. Một cách để kiểm tra thời gian vòng lặp chạy là thay vì cho chỉ số chạy qua độ dài của cả véc-tơ thì hãy cho vòng lặp thực hiện với một số lượng nhỏ chỉ số ban đầu để ước tính ra tổng thời gian. Nói một cách đơn giản, vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> chạy qua 100 giá trị ban đầu của véc-tơ sẽ mất thời gian bằng khoảng <span class="math inline">\(\cfrac{1}{100}\)</span> thời gian để chạy vòng lặp qua 10.000 giá trị của toàn bộ véc-tơ. Thời gian để thực hiện các vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> lồng nhau sẽ tăng lên theo cấp số nhân.</p>
</div>
<div id="vòng-lặp-while" class="section level4" number="3.4.2.2">
<h4>
<span class="header-section-number">3.4.2.2</span> Vòng lặp <span style="color: #640514; font-family: Source Code Pro;">while</span><a class="anchor" aria-label="anchor" href="#v%C3%B2ng-l%E1%BA%B7p-while"><i class="fas fa-link"></i></a>
</h4>
<p>Vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> được gọi là vòng lặp xác định vì nếu không có thêm các câu lệnh đặc biệt, người viết câu lệnh sẽ biết trước được số lần vòng lặp thực hiện. Một cách khác để thực hiện vòng lặp là sử dụng vòng lặp <span style="color: #640514; font-family: Source Code Pro;">while</span>. Đây là kiểu vòng lặp không xác định, nghĩa là trong nhiều trường hợp người viết câu lệnh sẽ không biết trước được sẽ vòng lặp sẽ được thực hiện bao nhiêu lần. Trước khi nói kỹ hơn về khái niệm không xác định, bạn đọc hãy làm quen với cấu trúc của vòng lặp <span style="color: #640514; font-family: Source Code Pro;">while</span> trước. Cách viết một vòng lặp <span style="color: #640514; font-family: Source Code Pro;">while</span> như sau</p>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># y là một biến kiểu logic</span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="st">"Đoạn câu lệnh"</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Nguyên tắc hoạt động của vòng lặp <span style="color: #640514; font-family: Source Code Pro;">while</span> là tiếp tục thực hiện <span style="color: #640514; font-family: Source Code Pro;">Đoạn câu lệnh</span> nằm giữa dấu ngoặc <span style="color: #640514; font-family: Source Code Pro;">{}</span> nếu giá trị của <span style="color: #640514; font-family: Source Code Pro;">y</span> là <span style="color: #640514; font-family: Source Code Pro;">TRUE</span> và bỏ qua vòng lặp nếu giá trị của <span style="color: #640514; font-family: Source Code Pro;">y</span> là <span style="color: #640514; font-family: Source Code Pro;">FALSE</span>. Nếu <span style="color: #640514; font-family: Source Code Pro;">y</span> nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">TRUE</span> và trong <span style="color: #640514; font-family: Source Code Pro;">Đoạn câu lệnh</span> không có các dòng lệnh tác động làm thay đổi giá trị của <span style="color: #640514; font-family: Source Code Pro;">y</span>, thì <span style="color: #640514; font-family: Source Code Pro;">y</span> sẽ luôn luôn nhận giá trị là <span style="color: #640514; font-family: Source Code Pro;">TRUE</span> và khi đó vòng lặp sẽ lặp vô hạn, nghĩa là không bao giờ dừng lại được.</p>
<p>Vòng lặp <span style="color: #640514; font-family: Source Code Pro;">while</span> dưới đây sẽ in ra tên các phần tử của véc-tơ <span style="color: #640514; font-family: Source Code Pro;">qua</span> bằng cách sử dụng một chỉ số tăng dần và chỉ thoát ra khỏi vòng lặp nếu chỉ số đó vượt qua độ dài của véc-tơ:</p>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qua</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chuối"</span>, <span class="st">"táo"</span>, <span class="st">"cam"</span>, <span class="st">"chanh"</span><span class="op">)</span> <span class="co"># Véc-tơ chứa tên các loại quả</span></span>
<span><span class="va">i</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="va">i</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">qua</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> <span class="co"># TRUE cho đến khi i = 5</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">qua</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="co"># In ra màn hình phần tử thứ i</span></span>
<span>  <span class="va">i</span><span class="op">&lt;-</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span> <span class="co"># Tăng i lên dần để thoát ra khỏi vòng lặp</span></span>
<span><span class="op">}</span> <span class="co"># Kết thúc vòng lặp while</span></span></code></pre></div>
<pre><code>## [1] "chuối"
## [1] "táo"
## [1] "cam"
## [1] "chanh"</code></pre>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="co"># Kiểm tra giá trị của i khi thoát ra khỏi vòng lặp</span></span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>Trong ví dụ ở trên chúng ta đã biết chính xác khi nào chúng ta sẽ dừng lại vòng lặp nên việc sử dụng vòng lặp <span style="color: #640514; font-family: Source Code Pro;">while</span> sẽ phức tạp hơn vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span>. Vòng lặp <span style="color: #640514; font-family: Source Code Pro;">while</span> sẽ phát huy hiệu quả khi bạn đọc không biết chính xác khi nào chúng ta nên dừng việc thực hiện lặp các câu lệnh.</p>
<p>Hãy lấy ví dụ khi bạn đọc muốn kiểm tra xem một số tự nhiên <span class="math inline">\(n\)</span> bất kỳ có phải là số nguyên tố hay không. Xin được nhắc lại rằng số nguyên tố là các số tự nhiên chỉ có hai ước số là số 1 và chính nó. Để kiểm tra xem số <span class="math inline">\(n\)</span> có phải là số nguyên tố hay không, bạn đọc cần kiểm tra xem <span class="math inline">\(n\)</span> có chia hết cho số nguyên dương nào từ 2 đến số tự nhiên là phần nguyên của <span class="math inline">\(\sqrt{n}\)</span> hay không. Phần nguyên của <span class="math inline">\(\sqrt{n}\)</span> được ký hiệu là <span class="math inline">\([\sqrt{n}]\)</span>. Nếu <span class="math inline">\(n\)</span> chia hết cho một số bất kỳ từ 2 đến <span class="math inline">\([\sqrt{n}]\)</span>, <span class="math inline">\(n\)</span> không phải là số nguyên tố. Theo nguyên tắc này bạn đọc có thể viết một vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> bắt đầu từ <span class="math inline">\(2\)</span> đến <span class="math inline">\([\sqrt{n}]\)</span> và kiểm tra xem <span class="math inline">\(n\)</span> có chia hết cho số nào trong dãy này không. Tuy nhiên vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> như vậy sẽ luôn luôn phải lặp lại chính xác <span class="math inline">\([\sqrt{n}] - 1\)</span> lần. Viết vòng lặp <span style="color: #640514; font-family: Source Code Pro;">while</span> trong trường hợp này sẽ hiệu quả hơn rất nhiều bởi chỉ cần <span class="math inline">\(n\)</span> chia hết cho 1 số nào đó chúng ta có thể kết thúc ngay vòng lặp và kết luận <span class="math inline">\(n\)</span> không phải là số nguyên tố.</p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Nhập số n để kiểm tra</span></span>
<span><span class="va">n</span><span class="op">&lt;-</span><span class="fl">123454321</span></span>
<span></span>
<span><span class="co"># Biến điều kiện ket_qua</span></span>
<span><span class="va">ket_qua</span><span class="op">&lt;-</span><span class="cn">TRUE</span> <span class="co"># ket_qua sẽ đổi thành FALSE khi n chia hết cho 1 số</span></span>
<span><span class="va">uoc_so</span><span class="op">&lt;-</span><span class="fl">2</span> <span class="co"># Ước số đầu tiên cần kiểm tra</span></span>
<span></span>
<span><span class="co"># Vòng lặp ko xác định, lặp lại nếu ket_qua = TRUE VÀ ước số &lt; n^0.5</span></span>
<span><span class="kw">while</span><span class="op">(</span> <span class="va">ket_qua</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">uoc_so</span> <span class="op">&lt;</span> <span class="va">n</span><span class="op">^</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">n</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="va">uoc_so</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">ket_qua</span><span class="op">&lt;-</span><span class="cn">FALSE</span> <span class="co"># Thay đổi ket_qua nếu n chia hết cho uoc_so</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">uoc_so</span><span class="op">&lt;-</span><span class="va">uoc_so</span> <span class="op">+</span> <span class="fl">1</span> <span class="co"># Tăng ước số thêm 1</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># In ra kết quả cuối cùng</span></span>
<span><span class="va">ket_qua</span> <span class="co"># TRUE nến n nguyên tố</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Hãy thử áp dụng vòng lặp <span style="color: #640514; font-family: Source Code Pro;">while</span> trên một ví dụ khác liên quan đến dữ liệu <span style="color: #640514; font-family: Source Code Pro;">trump_tweet</span>. Chẳng hạn như bạn đọc muốn tìm ra thời điểm đầu tiên mà một câu đăng trạng thái được yêu thích nhiều hơn 10.000 lượt. Câu hỏi này khá dễ nếu chúng ta sử dụng đối tượng véc-tơ. Tuy nhiên chúng tôi muốn bạn đọc suy nghĩ theo hướng sử dụng vòng lặp. Chúng ta sẽ sử dụng một chỉ số tăng dần từ 1 và kiểm tra xem câu đăng trạng thái đó có nhiều hơn 10.000 lượt yêu thích hay không và chỉ dừng lại việc kiểm tra nếu gặp câu có nhiều hơn 10.000 yêu thích. Chúng ta không biết chính xác khi nào sẽ dừng lại, do đó sử dụng vòng lặp <span style="color: #640514; font-family: Source Code Pro;">while</span> sẽ hợp lý trong trường hợp này</p>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Biến điều kiện của vòng lặp while</span></span>
<span><span class="va">kiem_tra</span><span class="op">&lt;-</span><span class="cn">TRUE</span></span>
<span></span>
<span><span class="co"># Chỉ số dòng</span></span>
<span><span class="va">i</span><span class="op">&lt;-</span><span class="fl">0</span></span>
<span></span>
<span><span class="co"># Thực hiện vòng lặp, dừng lại khi kiem_tra là FALSE</span></span>
<span><span class="kw">while</span><span class="op">(</span><span class="va">kiem_tra</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">i</span><span class="op">&lt;-</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span> <span class="co"># tăng chỉ số i</span></span>
<span>  <span class="va">kiem_tra</span><span class="op">&lt;-</span><span class="va">trump_tweets</span><span class="op">$</span><span class="va">favorite_count</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">10</span><span class="op">^</span><span class="fl">4</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># In ra kết quả</span></span>
<span><span class="va">trump_tweets</span><span class="op">$</span><span class="va">favorite_count</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span></code></pre></div>
<pre><code>## [1] 15457</code></pre>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trump_tweets</span><span class="op">$</span><span class="va">created_at</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span></code></pre></div>
<pre><code>## [1] "2011-12-21 15:36:36 EST"</code></pre>
<p>Mặc dù phần này của cuốn sách đang viết về vòng lặp nhưng chúng tôi muốn nhắc lại rằng bạn đọc hãy cố gắng sử dụng véc-tơ để tìm lời giải thay vì sử dụng vòng lặp khi có thể. Cùng câu hỏi như trên, chúng ta có thể cho lời giải đơn giản hơn bằng cách sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">match()</span>.</p>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sử dụng hàm match trên véc-tơ logic</span></span>
<span><span class="co"># vitri là chỉ số nhỏ nhất mà số like nhiều hơn 10.000</span></span>
<span><span class="va">vitri</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="va">trump_tweets</span><span class="op">$</span><span class="va">favorite_count</span><span class="op">&gt;</span><span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># In ra kết quả</span></span>
<span><span class="va">trump_tweets</span><span class="op">$</span><span class="va">favorite_count</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span></code></pre></div>
<pre><code>## [1] 15457</code></pre>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trump_tweets</span><span class="op">$</span><span class="va">created_at</span><span class="op">[</span><span class="va">vitri</span><span class="op">]</span></span></code></pre></div>
<pre><code>## [1] "2011-12-21 15:36:36 EST"</code></pre>
<p>Khi làm việc với vòng lặp <span style="color: #640514; font-family: Source Code Pro;">while</span> những người mới làm quen với lập trình rất dễ rơi vào trạng thái vòng lặp vô hạn. Dưới đây là một ví dụ về một vòng lặp như vậy. Biến <span style="color: #640514; font-family: Source Code Pro;">kiem_tra</span> nhận giá trị ban đầu là <span style="color: #640514; font-family: Source Code Pro;">TRUE</span> và trong các câu lệnh nằm trong vòng lặp không có câu lệnh nào tác động đến giá trị của biến đó. Bạn đọc sẽ thấy giá trị <span style="color: #640514; font-family: Source Code Pro;">i</span> được in ra tăng dần và không bao giờ dừng lại. Bạn đọc chỉ có thể dừng chương trình chạy bằng cách nhấn vào biểu tượng <span style="color: #640514; font-family: Source Code Pro;">STOP</span> màu đỏ phía trên - bên phải cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Console</span>.</p>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># HÃY CẨN THẬN VÌ ĐÂY LÀ VÒNG LẶP VÔ HẠN</span></span>
<span></span>
<span><span class="co"># Biến điều kiện trong vòng lặp không xác định</span></span>
<span><span class="va">kiem_tra</span><span class="op">&lt;-</span><span class="cn">TRUE</span></span>
<span></span>
<span><span class="co"># Bắt đầu lặp</span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="va">kiem_tra</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># In ra màn hình phần tử thứ i</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Giá trị của i hiện tại: "</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Kinh nghiệm của chúng tôi khi sử dụng vòng lặp không xác định là luôn luôn sử dụng một biến, tạm gọi là <span style="color: #640514; font-family: Source Code Pro;">i</span>, không liên quan đến chương trình chạy và được gán cho giá trị tăng dần trong vòng lặp. Trong biển thức điều kiện luôn luôn kèm thêm một điều kiện là <span style="color: #640514; font-family: Source Code Pro;">i</span> nhỏ hơn số lần lặp tối đa mà người lập trình quy định. Bạn đọc có thể quan sát đoạn lệnh sau:</p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Quy định số lần lặp tối đa, biến i tăng dần sau mỗi lần lặp</span></span>
<span><span class="va">loop_max</span><span class="op">&lt;-</span><span class="fl">10</span><span class="op">^</span><span class="fl">4</span></span>
<span><span class="va">i</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span></span>
<span><span class="co"># Biến điều kiện trong vòng lặp</span></span>
<span><span class="va">kiem_tra</span><span class="op">&lt;-</span><span class="cn">TRUE</span></span>
<span></span>
<span><span class="co"># Thực thi vòng lặp</span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="va">kiem_tra</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">i</span><span class="op">&lt;=</span> <span class="va">loop_max</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">i</span><span class="op">&lt;-</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span> <span class="co"># luôn luôn tăng i</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Giá trị của i hiện tại: "</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Các đoạn câu lệnh kiểu trên sẽ lặp tối đa là 10.000 lần do chúng ta sử dụng thêm điều kiện <span style="color: #640514; font-family: Source Code Pro;">(i&lt;= loop_max)</span></p>
</div>
<div id="điều-khiển-vòng-lặp" class="section level4" number="3.4.2.3">
<h4>
<span class="header-section-number">3.4.2.3</span> Điều khiển vòng lặp<a class="anchor" aria-label="anchor" href="#%C4%91i%E1%BB%81u-khi%E1%BB%83n-v%C3%B2ng-l%E1%BA%B7p"><i class="fas fa-link"></i></a>
</h4>
<p>Khi bạn đọc viết các vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> hoặc <span style="color: #640514; font-family: Source Code Pro;">while</span>, R cung cấp các từ khóa để bạn đọc có thể điều khiển vòng lặp. Các từ khóa đó bao gồm <span style="color: #640514; font-family: Source Code Pro;">break</span> và <span style="color: #640514; font-family: Source Code Pro;">next</span>. Ý nghĩa của các từ khóa này như sau</p>
<div class="inline-table"><table class="table table-bordered table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Từ khóa
</th>
<th style="text-align:left;">
Ý nghĩa
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
next
</td>
<td style="text-align:left;">
Bỏ qua các câu lệnh còn lại trong vòng lặp hiện tại và chuyển tới vòng lặp tiếp theo
</td>
</tr>
<tr>
<td style="text-align:left;">
break
</td>
<td style="text-align:left;">
Dừng vòng lặp ngay lập tức
</td>
</tr>
</tbody>
</table></div>
<p>Bạn đọc quan sát giá trị trả ra màn hình của đoạn câu lệnh sau đề hiểu cách sử dụng <span style="color: #640514; font-family: Source Code Pro;">next</span> trong vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span> dưới đây</p>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qua</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chuối"</span>, <span class="st">"táo"</span>, <span class="st">"cam"</span>, <span class="st">"chanh"</span><span class="op">)</span> <span class="co"># Vec-tơ chứa tên các loại quả</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">ten</span> <span class="kw">in</span> <span class="va">qua</span><span class="op">)</span><span class="op">{</span> <span class="co"># cho biến ten nhận lần lượt các giá trị trong vec-tơ qua</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">ten</span> <span class="op">==</span> <span class="st">"cam"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">next</span> <span class="co"># nếu ten là "cam" thì chuyển qua vòng lặp tiếp theo</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ten</span><span class="op">)</span> <span class="co"># in ten ra màn hình</span></span>
<span><span class="op">}</span> <span class="co"># kết thúc vòng lặp for</span></span></code></pre></div>
<pre><code>## [1] "chuối"
## [1] "táo"
## [1] "chanh"</code></pre>
<p>Có thể thấy rằng trong các loại quả được in ra màn hình không có giá trị <span style="color: #640514; font-family: Source Code Pro;">cam</span> bởi vì khi biến <span style="color: #640514; font-family: Source Code Pro;">ten</span> bằng giá trị này từ khóa <span style="color: #640514; font-family: Source Code Pro;">next</span> đã kết thúc vòng lặp hiện tại, bỏ qua dòng lệnh <span style="color: #640514; font-family: Source Code Pro;">print()</span> và đi đến vòng lặp tiếp theo. Vẫn các câu lệnh như trên nhưng thay <span style="color: #640514; font-family: Source Code Pro;">next</span> bằng <span style="color: #640514; font-family: Source Code Pro;">break</span>, chúng ta có thể quan sát R trả ra kết quả như sau:</p>
<div class="sourceCode" id="cb242"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qua</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chuối"</span>, <span class="st">"táo"</span>, <span class="st">"cam"</span>, <span class="st">"chanh"</span><span class="op">)</span> <span class="co"># Vec-tơ chứa tên các loại quả</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">ten</span> <span class="kw">in</span> <span class="va">qua</span><span class="op">)</span><span class="op">{</span> <span class="co"># cho biến ten nhận lần lượt các giá trị trong vec-tơ qua</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">ten</span> <span class="op">==</span> <span class="st">"cam"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">break</span> <span class="co"># nếu ten là "cam" thì kết thúc vòng lặp ngay lập tức</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ten</span><span class="op">)</span> <span class="co"># in ten ra màn hình</span></span>
<span><span class="op">}</span> <span class="co"># kết thúc vòng lặp for</span></span></code></pre></div>
<pre><code>## [1] "chuối"
## [1] "táo"</code></pre>
<p>R chỉ trả ra tên hai loại quả là <span style="color: #640514; font-family: Source Code Pro;">chuối</span> và <span style="color: #640514; font-family: Source Code Pro;">táo</span> bởi vì khi gặp giá trị <span style="color: #640514; font-family: Source Code Pro;">cam</span> từ khóa <span style="color: #640514; font-family: Source Code Pro;">break</span> đã kết thúc vòng lặp <span style="color: #640514; font-family: Source Code Pro;">for</span>.</p>
<p>Trong R còn có một kiểu viết vòng lặp không xác định khác với vòng lặp <span style="color: #640514; font-family: Source Code Pro;">while</span> đó là viết vòng lặp sử dụng câu lệnh <span style="color: #640514; font-family: Source Code Pro;">repeat</span>. Khi sử dụng vòng lặp <span style="color: #640514; font-family: Source Code Pro;">repeat</span> bạn đọc luôn luôn phải sử dụng từ khóa <span style="color: #640514; font-family: Source Code Pro;">break</span> để kết thúc vòng lặp và tránh bị lặp vô hạn. Cách sử dụng <span style="color: #640514; font-family: Source Code Pro;">repeat</span> trong R như sau</p>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qua</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chuối"</span>, <span class="st">"táo"</span>, <span class="st">"cam"</span>, <span class="st">"chanh"</span><span class="op">)</span> <span class="co"># Vec-tơ chứa tên các loại quả</span></span>
<span><span class="va">i</span><span class="op">&lt;-</span><span class="fl">0</span></span>
<span><span class="kw">repeat</span><span class="op">{</span></span>
<span>  <span class="va">i</span><span class="op">&lt;-</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span> <span class="co"># luôn luôn tăng i</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">qua</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="co"># in tên ra màn hình</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">i</span><span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">qua</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="kw">break</span><span class="op">}</span></span>
<span><span class="op">}</span> <span class="co"># kết thúc vòng lặp repeat</span></span></code></pre></div>
<pre><code>## [1] "chuối"
## [1] "táo"
## [1] "cam"
## [1] "chanh"</code></pre>
<p>Trong vòng lặp <span style="color: #640514; font-family: Source Code Pro;">repeat</span> ở trên, chúng tôi sử dụng điều kiện là <span style="color: #640514; font-family: Source Code Pro;">i</span> bằng độ dài của véc-tơ để kết thúc vòng lặp. Những bạn đọc mới làm quen với lập trình sẽ dễ bị nhầm lẫn về cách kết thúc vòng lặp của <span style="color: #640514; font-family: Source Code Pro;">while</span> và <span style="color: #640514; font-family: Source Code Pro;">repeat</span>. Cách hoạt động của hai vòng lặp này là tương đương nhau nên chúng tôi cho rằng những bạn đọc chưa quen với lập trình nên chỉ chọn một trong hai cách viết trong quá trình viết câu lệnh.</p>
</div>
</div>
<div id="hàm-số" class="section level3" number="3.4.3">
<h3>
<span class="header-section-number">3.4.3</span> Hàm số<a class="anchor" aria-label="anchor" href="#h%C3%A0m-s%E1%BB%91"><i class="fas fa-link"></i></a>
</h3>
<p>Hàm số có vai trò quan trọng trong bất kỳ ngôn ngữ lập trình nào. Trước hết, hàm số công cụ hữu hiệu đảm bảo sự chính xác và tiện lợi khi lập trình. Thứ hai hàm số là phương pháp chuyển giao kiến thức và kinh nghiệm từ người dùng này đến người dùng khác một cách vô cùng hiệu quả.</p>
<ol style="list-style-type: decimal">
<li><p>Hàm số đặc biệt có ý nghĩa khi bạn phải thực hiện một đoạn câu lệnh một cách lặp đi lặp lại và do sự thay đổi của một số yếu tố đầu vào. Thay vì phải làm đi làm lại công việc đó một cách thủ công, bạn hãy viết quy trình đó thành một hàm số.</p></li>
<li><p>Khi chúng ta muốn chuyển giao kinh nghiệm, kiến thức của mình cho một người khác, hãy viết chương trình của bạn dưới dạng hàm số và chuyển giao. Người dùng có thể không hiểu được ý nghĩa của chương trình của bạn ngay thì ít nhất cũng có thể sử dụng được kiến thức của bạn. Nếu bạn đọc để ý, các thư viện cài đặt thêm trên R đều là tập hợp của các hàm số.</p></li>
</ol>
<p>Hàm số trên R ngoài các hàm sẵn có còn có các hàm số nằm trong các thư viện mà bạn đọc cài đặt bổ sung và các hàm số mà bạn đọc tự định nghĩa.</p>
<div id="hàm-số-do-người-dùng-tự-định-nghĩa." class="section level4" number="3.4.3.1">
<h4>
<span class="header-section-number">3.4.3.1</span> Hàm số do người dùng tự định nghĩa.<a class="anchor" aria-label="anchor" href="#h%C3%A0m-s%E1%BB%91-do-ng%C6%B0%E1%BB%9Di-d%C3%B9ng-t%E1%BB%B1-%C4%91%E1%BB%8Bnh-ngh%C4%A9a."><i class="fas fa-link"></i></a>
</h4>
<p>Từ khóa để khai báo một hàm số là <span style="color: #640514; font-family: Source Code Pro;">function()</span>. Để tự tạo một hàm số tên là <span style="color: #640514; font-family: Source Code Pro;">f</span> nhận giá trị bằng <span class="math inline">\(x^2\)</span> thì bạn đọc sử dụng đoạn câu lệnh như sau:</p>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span> <span class="co"># Là một hàm số của biến x</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="co"># Trả lại giá trị của hàm số là x^2</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Thay vì sử dụng từ khóa <span style="color: #640514; font-family: Source Code Pro;">return</span>, bạn đọc cũng có thể sử dụng tên hàm số đển gán cho giá trị trả lại:</p>
<div class="sourceCode" id="cb247"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span> <span class="co"># Là một hàm số của biến x</span></span>
<span>  <span class="va">f</span><span class="op">&lt;-</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="co"># Trả lại giá trị của hàm số là x^2</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Đôi khi bạn đọc sẽ gặp các đoạn lệnh khai báo hàm số không có từ khóa <span style="color: #640514; font-family: Source Code Pro;">return</span> và cũng không có phần gán giá trị cho hàm số. Khi đó R sẽ luôn luôn lấy giá trị được trả ra cuối cùng để gán giá trị cho hàm số đó.</p>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span></span></code></pre></div>
<p>Cách viết này chỉ phù hợp cho các hàm số ngắn gọn và chúng tôi khuyên bạn đọc hãy luôn sử dụng từ khóa <span style="color: #640514; font-family: Source Code Pro;">return</span> khi trả lại giá trị cho hàm số để tránh sự nhầm lẫn.</p>
<p>Sau khi đã chạy các đoạn lệnh khai báo hàm số <span class="math inline">\(f(x) = x^2\)</span>, R sẽ lưu đối tượng có tên <span style="color: #640514; font-family: Source Code Pro;">f</span> là kiểu hàm số lên môi trường làm việc chung. Để gọi hàm số và thực hiện tính toán, bạn đọc cần viết đúng tên hàm và cho tham số <span style="color: #640514; font-family: Source Code Pro;">x</span> giá trị phù hợp.</p>
<div class="sourceCode" id="cb249"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="co"># Kiểu của đối tượng f là function</span></span></code></pre></div>
<pre><code>## [1] "function"</code></pre>
<div class="sourceCode" id="cb251"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">f</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="co"># Cho tham số x giá trị bằng 10</span></span></code></pre></div>
<pre><code>## [1] 100</code></pre>
<p>Từ khóa <span style="color: #640514; font-family: Source Code Pro;">return</span> được sử dụng để trả lại giá trị cho hàm số <span style="color: #640514; font-family: Source Code Pro;">f</span> và R sẽ gán giá trị cho hàm số <span style="color: #640514; font-family: Source Code Pro;">f</span> ngay lập tức khi gặp hàm câu lệnh <span style="color: #640514; font-family: Source Code Pro;">return</span>. Nếu trong đoạn câu lệnh của hàm số <span style="color: #640514; font-family: Source Code Pro;">f</span> có nhiều từ khóa <span style="color: #640514; font-family: Source Code Pro;">return</span>, giá trị của <span style="color: #640514; font-family: Source Code Pro;">f</span> sẽ được gán bằng từ khóa <span style="color: #640514; font-family: Source Code Pro;">return</span> đầu tiên. Hãy quan sát ví dụ sau:</p>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span> <span class="co"># là một hàm số của biến x</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="co"># Trả lại giá trị của hàm số là x^2 khi gặp return</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span> <span class="co"># R sẽ không chạy câu lệnh này</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">f</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="co"># trả lại gái trị là 100</span></span></code></pre></div>
<p>Cách đặt tên hàm số cũng giống như đặt tên biến trong R, bạn đọc cần lựa chọn tên hợp lệ và tránh các từ khóa. Biến <span style="color: #640514; font-family: Source Code Pro;">x</span> trong phần khai báo hàm số ở trên được gọi là tham số. Hàm số trong R có thể không có tham số nào hoặc có thể có rất nhiều tham số, mỗi tham số là một kiểu đối tượng khác nhau, việc này hoàn toàn tùy thuộc vào người lập trình. Bên trong dấu ngoặc <span style="color: #640514; font-family: Source Code Pro;">{}</span> của từ khóa <span style="color: #640514; font-family: Source Code Pro;">function()</span> được gọi là môi trường cục bộ, R sẽ luôn ưu tiên biến nằm trong môi trường này trước tất cả các môi trường khác. Vấn đề sẽ được thảo luận ở phần tiếp theo. Một điểu cần lưu ý là khi viết hàm số hãy luôn luôn có tài liệu hoặc mô tả đi kèm rõ ràng để người sử dụng khác, hoặc chính mình khi sử dụng có thể hiểu hay nhớ được hàm số được sử dụng như thế nào và với mục đích gì.</p>
<p>Tham số hay biến số là phần thiết yếu của các hàm trong R. Trong phần tiếp theo, chúng ta sẽ xem xét cách tham số trong hàm số hoạt động như thế nào, chẳng hạn như cách tạo giá trị mặc định cho tham số, cách xử lý các giá trị tham số bị thiếu, cách bổ sung vào tham số bằng cách sử dụng dấu ba chấm <span style="color: #640514; font-family: Source Code Pro;">(…)</span></p>
<p>Để tạo giá trị mặc định cho tham số bạn đọc cần gán giá trị phù hợp khi khai báo hàm số. Tạo giá trị mặc định cho tham số là quan trọng khi bạn đọc viết các hàm số có nhiều tham số bởi vì khi bạn gọi hàm số và quên gán giá trị cho một vài tham số nào đó, R sẽ sử dụng giá trị mặc định để tính toán và không báo lỗi. Hãy xem xét ví dụ sau: bạn muốn viết một hàm số để tính giá trị hiện tại (present value) của một dòng tiền được quan sát theo năm và được lưu trong một véc-tơ tên là <span style="color: #640514; font-family: Source Code Pro;">CF</span>. Lãi suất tính theo kiểu lãi gộp là biến <span style="color: #640514; font-family: Source Code Pro;">i</span>. Chúng ta sẽ sử dụng giá trị mặc định 5% để gán cho <span style="color: #640514; font-family: Source Code Pro;">i</span></p>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PV</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">i</span> <span class="op">=</span> <span class="fl">0.05</span>, <span class="va">CF</span><span class="op">)</span><span class="op">{</span>  <span class="co"># Hàm PV có hai tham số là i và CF</span></span>
<span>  <span class="va">n</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">CF</span><span class="op">)</span></span>
<span>  <span class="va">discount_factor</span><span class="op">&lt;-</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">i</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">discount_factor</span> <span class="op">*</span> <span class="va">CF</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Giả sử dòng tiền có giá trị là 1 nghìn USD tại thời điểm cuối năm thứ nhất và tăng thêm 1 nghìn USD mỗi năm và lên đến 10 nghìn USD tại cuối năm thứ 10. Mức lãi suất gộp i = 10%/năm. Giá trị hiện tại của dòng tiền được tính bằng hàm <span style="color: #640514; font-family: Source Code Pro;">PV</span> như sau</p>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MyCF</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">10000</span>,length<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu">PV</span><span class="op">(</span>i <span class="op">=</span> <span class="fl">0.1</span>, <span class="va">MyCF</span><span class="op">)</span> <span class="co"># Giá trị hiện tại của MyCF tại i = 10%</span></span></code></pre></div>
<pre><code>## [1] 29035.91</code></pre>
<p>Khi chúng ta quên không gán giá trị cho tham số <span style="color: #640514; font-family: Source Code Pro;">i</span> khi gọi hàm <span style="color: #640514; font-family: Source Code Pro;">PV</span>, R sẽ cho <span style="color: #640514; font-family: Source Code Pro;">i</span> nhận giá trị mặc định là 5%</p>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">PV</span><span class="op">(</span>CF <span class="op">=</span> <span class="va">MyCF</span><span class="op">)</span> <span class="co"># Giá trị hiện tại của MyCF tại i = 5%</span></span></code></pre></div>
<pre><code>## [1] 39373.78</code></pre>
<p>Sử dụng dấu ba chấm <span style="color: #640514; font-family: Source Code Pro;">(…)</span> khi khai báo tham số của một hàm số là phương pháp để người lập trình sử dụng tham số có sẵn của một hàm số khác. Nguyên tắc hoạt động của cách khai báo tham số này thể hiện qua ví dụ sau: hàm <span style="color: #640514; font-family: Source Code Pro;">PV</span> được xây dựng ở trên chỉ tính được dòng tiền tại các thời điểm cuối các năm. Bạn đọc muốn hàm <span style="color: #640514; font-family: Source Code Pro;">PV</span> có thể tính được giá trị hiện tại của dòng tiền trong cả hai trường hợp: dòng tiền bắt đầu từ thời điểm đầu năm hoặc dòng tiền bắt đầu từ cuối năm. Chúng ta thực hiện việc đó bằng cách thêm vào một tham số tên là <span style="color: #640514; font-family: Source Code Pro;">bat_dau</span>: khi <span style="color: #640514; font-family: Source Code Pro;">bat_dau</span> nhận giá trị bằng 0 thì thời điểm bắt đầu là đầu năm thứ nhất và khi <span style="color: #640514; font-family: Source Code Pro;">bat_dau</span> nhận giá trị bằng 1 thì thời điểm bắt đầu là cuối năm thứ nhất. Thay vì sửa lại hàm số <span style="color: #640514; font-family: Source Code Pro;">PV</span> chúng ta có thể viết một hàm mới, tạm gọi là <span style="color: #640514; font-family: Source Code Pro;">PV1</span>, và sử dụng tham số của hàm <span style="color: #640514; font-family: Source Code Pro;">PV</span>:</p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PV1</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">bat_dau</span>,<span class="va">i</span>,<span class="va">...</span><span class="op">)</span><span class="op">{</span> <span class="co"># chúng ta chỉ sử dụng tham số i của PV, các tham số khác khai báo bằng ...</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">bat_dau</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span> <span class="op">(</span><span class="fu">PV</span><span class="op">(</span><span class="va">i</span>,<span class="va">...</span><span class="op">)</span><span class="op">)</span> <span class="co"># PV1 sử dụng các tham số còn lại của PV</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">i</span><span class="op">)</span><span class="op">*</span><span class="fu">PV</span><span class="op">(</span><span class="va">i</span>,<span class="va">...</span><span class="op">)</span><span class="op">)</span> <span class="co"># PV1 sử dụng các tham số còn lại của PV</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Khi gọi hàm <span style="color: #640514; font-family: Source Code Pro;">PV1</span> chúng ta cần gọi đầy đủ tham số:</p>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">PV1</span><span class="op">(</span>bat_dau <span class="op">=</span> <span class="fl">0</span>,i <span class="op">=</span> <span class="fl">0.1</span>, CF <span class="op">=</span> <span class="va">MyCF</span><span class="op">)</span> <span class="co"># dòng tiền bắt đầu từ đầu năm thứ 1</span></span></code></pre></div>
<pre><code>## [1] 31939.5</code></pre>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">PV1</span><span class="op">(</span>bat_dau <span class="op">=</span> <span class="fl">1</span>,i <span class="op">=</span> <span class="fl">0.1</span>, CF <span class="op">=</span> <span class="va">MyCF</span><span class="op">)</span> <span class="co"># dòng tiền bắt đầu từ cuối năm thứ 1</span></span></code></pre></div>
<pre><code>## [1] 29035.91</code></pre>
<p>Bạn đọc cũng có thể sử dụng cách mượn tham số này để sử dụng các hàm số có sẵn trong R. Trong ví dụ dưới đây, chúng tôi tự xây dựng một hàm có tên là <span style="color: #640514; font-family: Source Code Pro;">myplot()</span> để vẽ đồ thị phân tán của một véc-tơ kiểu số <span style="color: #640514; font-family: Source Code Pro;">x</span> theo chỉ số của véc-tơ đó đồng thời và mượn các tham số <span style="color: #640514; font-family: Source Code Pro;">main</span>, <span style="color: #640514; font-family: Source Code Pro;">xlab</span>, <span style="color: #640514; font-family: Source Code Pro;">ylab</span>, của hàm <span style="color: #640514; font-family: Source Code Pro;">plot()</span>:</p>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myplot</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">...</span><span class="op">)</span><span class="op">{</span> <span class="co"># hàm myplot vẽ đồ thị phân tán</span></span>
<span>  <span class="va">n</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># độ dài của véc-tơ x</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>,<span class="va">x</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Chúng ta sẽ sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">myplot()</span> để vẽ đồ thị phân tán của véc-tơ <span style="color: #640514; font-family: Source Code Pro;">x</span> nhận giá trị bằng véc-tơ kiểu chuỗi thời gian <span style="color: #640514; font-family: Source Code Pro;">Airpassengers</span>.</p>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">myplot</span><span class="op">(</span><span class="va">AirPassengers</span>,main<span class="op">=</span><span class="st">"Số lượng hành khách các tháng"</span>,</span>
<span>       ylab <span class="op">=</span> <span class="st">"Số lượng hành khách"</span>, <span class="co"># tham số ylab của hàm plot()</span></span>
<span>       xlab <span class="op">=</span> <span class="st">""</span>, <span class="co"># tham số xlab của hàm plot()</span></span>
<span>       type <span class="op">=</span> <span class="st">"l"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="co"># tham số type và color của hàm plot</span></span></code></pre></div>
<div class="inline-figure"><img src="07-lap-trinh-co-ban-voi-R_files/figure-html/unnamed-chunk-113-1.png" width="672"></div>
<p>Bạn đọc có thể tham khảo cách sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">plot()</span> trong phần đồ thị cơ bản trong cuốn sách này.</p>
</div>
<div id="hàm-số-được-xây-dựng-sẵn" class="section level4" number="3.4.3.2">
<h4>
<span class="header-section-number">3.4.3.2</span> Hàm số được xây dựng sẵn<a class="anchor" aria-label="anchor" href="#h%C3%A0m-s%E1%BB%91-%C4%91%C6%B0%E1%BB%A3c-x%C3%A2y-d%E1%BB%B1ng-s%E1%BA%B5n"><i class="fas fa-link"></i></a>
</h4>
<p>Hàm số được xây dựng sẵn là các hàm số được phát triển sẵn trong R và các hàm số trong các thư viện mà bạn đọc cài đặt thêm. Để biết R hiện đang có các thư viện nào đang sẵn sàng để sử dụng, bạn đọc sử dụng câu lệnh</p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/search.html">search</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] ".GlobalEnv"         "package:dslabs"     "package:stringr"   
##  [4] "package:ggrepel"    "package:pryr"       "package:gridExtra" 
##  [7] "package:grid"       "package:forcats"    "package:ggplot2"   
## [10] "package:kableExtra" "package:knitr"      "package:dplyr"     
## [13] "package:readxl"     "package:stats"      "package:graphics"  
## [16] "package:grDevices"  "package:utils"      "package:datasets"  
## [19] "package:methods"    "Autoloads"          "package:base"</code></pre>
<p>Ngoài việc liệt kê danh sách các đối tượng, thư viện đang sẵn trên môi trường đang làm việc, bạn đọc còn biết được thứ tự ưu tiên của các thư viện này. Chúng tôi sẽ giải thích về thứ tự ưu tiên ở phía dưới. Đa số các phiên bản R đều có sẵn các thư viện như <span style="color: #640514; font-family: Source Code Pro;">stats</span>, <span style="color: #640514; font-family: Source Code Pro;">graphics</span>, <span style="color: #640514; font-family: Source Code Pro;">utils</span>, … Để biết cụ thể hơn trong một thư viện cụ thể có những đối tượng (hàm số, nhóm các hàm số) nào khác, chúng ta sử dụng câu lệnh</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span>help <span class="op">=</span> <span class="st">"stats"</span><span class="op">)</span> <span class="co"># liệt kê các đối tượng trong thư viện stats</span></span></code></pre></div>
<p>Bạn đọc sẽ thấy cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Script</span> liệt kê ra danh sách các hàm số hoặc tên các đối tượng lưu chứa nhóm các hàm số đã được phát triển sẵn trong thư viện <span style="color: #640514; font-family: Source Code Pro;">stats</span>. Một vài đối tượng được liệt kê ra trong danh sách là các hàm số: hàm <span style="color: #640514; font-family: Source Code Pro;">AIC()</span>, hàm <span style="color: #640514; font-family: Source Code Pro;">ARMAacf()</span>,… Một số đối tượng là nhóm các hàm số, chẳng hạn như <span style="color: #640514; font-family: Source Code Pro;">Beta</span> hay <span style="color: #640514; font-family: Source Code Pro;">Binomal</span>. Khi bạn đọc gọi <span style="color: #640514; font-family: Source Code Pro;">Beta</span> trên cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Console</span> sẽ gặp lỗi vì đó không phải là tên chính xác của hàm số. Thay vì thế hãy chạy câu lệnh <span style="color: #640514; font-family: Source Code Pro;">? Beta</span> để thấy rằng trong đối tượng <span style="color: #640514; font-family: Source Code Pro;">Beta</span> của thư viện <span style="color: #640514; font-family: Source Code Pro;">stats</span> có một nhóm các hàm số liên quan đến phân phối xác suất <span class="math inline">\(Beta\)</span>: hàm <span style="color: #640514; font-family: Source Code Pro;">dbeta()</span>, hàm <span style="color: #640514; font-family: Source Code Pro;">pbeta()</span>, hàm <span style="color: #640514; font-family: Source Code Pro;">qbeta()</span>, và hàm <span style="color: #640514; font-family: Source Code Pro;">rbeta()</span>.</p>
<p>Chúng tôi không bàn đến việc làm thế nào để biết sử dụng hàm số nào trong một trường hợp cụ thể bởi vì đương nhiên không có câu trả lời chung cho câu hỏi này. Việc này tùy thuộc vào chuyên môn, hiểu biết, khả năng tìm kiếm của bạn đọc. Chúng tôi muốn tập trung vào việc đảm bảo bạn đọc gọi đúng hàm số mà bạn mong muốn. Sẽ không có vấn đề lớn nếu tên hàm số bạn cần gọi là duy nhất trên cửa số R bạn đang làm việc. Tuy nhiên, khi có một vài đối tượng khác có tên giống như tên hàm số bạn đang sử dụng, bạn sẽ gặp vấn đề.</p>
<p>Để làm được việc này bạn đọc nên hiểu một chút về môi trường làm việc và thứ tự ưu tiên khi gọi tên một đối tượng trong R. Khi bạn làm việc trên R, có ba môi trường mà R sử dụng để lưu trữ các đối tượng. Môi trường thứ nhất tạm gọi là môi trường chung (thuật ngữ công nghệ thông tin gọi là toàn cục), thứ hai là môi trường các thư viện, và cuối cùng là môi trường trong một hàm số cụ thể (thuật ngữ CNTT gọi là cục bộ). Khi bạn gọi tên một đối hay một hàm số, R sẽ luôn luôn ưu tiên theo thứ tự là: môi trường cục bộ <span class="math inline">\(\rightarrow\)</span> môi trường chung (toàn cục) <span class="math inline">\(\rightarrow\)</span> môi trường các thư viện. Do có nhiều thư viện cùng mở trên R nên để biết thứ tự ưu tiên của các thư viện bạn đọc sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">search()</span>. Các thư viện được ưu tiên hơn sẽ có chỉ số nhỏ hơn trong danh sánh được liệt kê bằng hàm <span style="color: #640514; font-family: Source Code Pro;">search()</span>.</p>
<p>Nhìn chung các thư viện cài đặt thêm sẽ thường được ưu tiên hơn các thư viện có sẵn. Nếu một hàm trong thư viện cài đặt thêm trùng tên với một hàm trong thư viện có sẵn, R ưu tiên thư viện cài đặt thêm. Thật vậy, hàm số tên <span style="color: #640514; font-family: Source Code Pro;">filter()</span> là một hàm được xây dựng sẵn trong thư viện <span style="color: #640514; font-family: Source Code Pro;">stats</span>. Tuy nhiên trong thư viện <span style="color: #640514; font-family: Source Code Pro;">dplyr</span> cũng có một hàm tên là <span style="color: #640514; font-family: Source Code Pro;">filter()</span>. Trước khi gọi thư viện <span style="color: #640514; font-family: Source Code Pro;">dplyr</span>, mỗi khi bạn đọc gọi hàm <span style="color: #640514; font-family: Source Code Pro;">filter()</span>, R sẽ luôn hiểu đây là hàm <span style="color: #640514; font-family: Source Code Pro;">filter()</span> của thư viện <span style="color: #640514; font-family: Source Code Pro;">stats</span>.</p>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span> <span class="va">filter</span> <span class="co"># nếu chưa gọi thư viện dplyr, filter là hàm của thư viện stats</span></span></code></pre></div>
<p>Sau khi chúng ta gọi thư viện <span style="color: #640514; font-family: Source Code Pro;">dplyr</span>, chúng ta sẽ thấy thư viện này xuất hiện trước thư viện <span style="color: #640514; font-family: Source Code Pro;">stats</span> theo thứ tự ưu tiên.</p>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span> <span class="co"># gọi thư viện dplyr</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/search.html">search</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># sau khi gọi thư viện dplyr, thư viện này được ưu tiên trước stats</span></span></code></pre></div>
<p>Trong thư viện <span style="color: #640514; font-family: Source Code Pro;">dplyr</span> cũng có một hàm tên là <span style="color: #640514; font-family: Source Code Pro;">filter()</span>. Theo thứ tự ưu tiên nếu bạn đọc gọi hàm <span style="color: #640514; font-family: Source Code Pro;">filter()</span> thì R sẽ hiểu đây là hàm của thư viện <span style="color: #640514; font-family: Source Code Pro;">dplyr</span>. Lúc này muốn sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">filter()</span> của thư viện <span style="color: #640514; font-family: Source Code Pro;">stats</span> bạn đọc cần phải sử dụng tên thư viện viết trước hàm này <span style="color: #640514; font-family: Source Code Pro;">stats::filter()</span>.</p>
<p>Như đã nói ở phần trước, môi trường chung cũng là môi trường được ưu tiên trước môi trường các thư viện. Bạn đọc có thể thấy từ kết quả hàm <span style="color: #640514; font-family: Source Code Pro;">search()</span>, môi trường chung, ký hiệu <span style="color: #640514; font-family: Source Code Pro;">.GlobalEnv</span>, luôn xuất hiện trước tiên. Môi trường chung chính là nơi lưu trữ tất cả các hàm số hay đối tượng mà bạn đọc tự định nghĩa. Môi trường chung luôn được ưu tiên trước môi trường thư viện. Điều này có nghĩa là nếu bạn đọc tự định nghĩa một biến, một véc-tơ, hay hàm số có tên là filter, R sẽ ưu tiên tên filter cho đối tượng mà bạn đọc tự định nghĩa. Như vậy, nếu bạn đọc sử dụng tên <span style="color: #640514; font-family: Source Code Pro;">filter</span> cho một hàm bạn tự định nghĩa, bạn sẽ cần phải sử dụng thêm tên thư viện để gọi hàm <span style="color: #640514; font-family: Source Code Pro;">filter()</span> từ các thư viện như <span style="color: #640514; font-family: Source Code Pro;">dplyr</span> hoặc <span style="color: #640514; font-family: Source Code Pro;">stats</span>.</p>
<p>Còn một môi trường khác, tạm gọi là môi trường cục bộ, sẽ được ưu tiên hơn môi trường chung. Môi trường cục bộ mô tả môi trường bên trong một hàm số mà bạn đọc tự định nghĩa. Giả sử sau khi bạn đọc tự định nghĩa một hàm <span style="color: #640514; font-family: Source Code Pro;">filter()</span> trên môi trường chung và sau đó tự định nghĩa một hàm số <span style="color: #640514; font-family: Source Code Pro;">f</span> có sử dụng một tham số, có thể là biến hoặc hàm số, có tên là <span style="color: #640514; font-family: Source Code Pro;">filter</span> thì mỗi khi bạn đọc gọi hàm số <span style="color: #640514; font-family: Source Code Pro;">f</span>, đối tượng tên filter sẽ luôn được hiểu là tham số của hàm số <span style="color: #640514; font-family: Source Code Pro;">f</span>. Môi trường bên trong hàm <span style="color: #640514; font-family: Source Code Pro;">f</span> được gọi là môi trường cục bộ. Bạn đọc hãy quan sát ví dụ dưới đây để hiểu hơn về môi trường chung và môi trường cục bộ</p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filter</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">pi</span><span class="op">)</span><span class="op">}</span> <span class="co">#Tự định nghĩa hàm filter trong môi trường chung</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># hàm filter trong .GlobalEnv luôn bằng pi</span></span></code></pre></div>
<pre><code>## [1] 3.141593</code></pre>
<p>Trước hết chúng ta định nghĩa một hàm tên là <span style="color: #640514; font-family: Source Code Pro;">filter()</span> trong môi trường chung luôn nhận giá trị bằng hằng số <span class="math inline">\(\pi\)</span>. Lúc này khi chúng ta gọi <span style="color: #640514; font-family: Source Code Pro;">filter()</span>, R sẽ hiểu rằng đây là hàm <span style="color: #640514; font-family: Source Code Pro;">filter()</span> do chúng ta tự định nghĩa. Sau đó chúng ta định nghĩa một hàm số tên <span style="color: #640514; font-family: Source Code Pro;">f</span> đồng thời bên trong hàm <span style="color: #640514; font-family: Source Code Pro;">f</span> chúng ta định nghĩa một hàm <span style="color: #640514; font-family: Source Code Pro;">filter()</span> khác nhận giá trị là 10. Hàm <span style="color: #640514; font-family: Source Code Pro;">filter()</span> bên trong hàm <span style="color: #640514; font-family: Source Code Pro;">f()</span> được gọi là hàm số trong môi trường cục bộ.</p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">filter</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="co"># bên trong hàm f, định nghĩa lại hàm filter bằng 10</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Khi chúng ta gọi hàm số <span style="color: #640514; font-family: Source Code Pro;">f</span>, hàm số này lại gọi một hàm số tên là <span style="color: #640514; font-family: Source Code Pro;">filter()</span> được định nghĩa bên trong hàm số nó. Bởi vì R ưu tiên môi trường cục bộ trước nên hàm <span style="color: #640514; font-family: Source Code Pro;">filter()</span> bên trong <span style="color: #640514; font-family: Source Code Pro;">f()</span> có giá trị bằng 10. Bên ngoài hàm số <code>f()</code>, chúng ta lại gọi <span style="color: #640514; font-family: Source Code Pro;">filter()</span> thì giá trị trả lại là <span class="math inline">\(\pi\)</span> vì đây là môi trường chung.</p>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">f</span><span class="op">(</span><span class="op">)</span> <span class="co"># trả lại giá trị là 10 vì hàm filter bên trong f nhận giá trị 10</span></span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># trả lại giá trị pi</span></span></code></pre></div>
<pre><code>## [1] 3.141593</code></pre>
<p>Tất cả các hàm số mà bạn đọc thường xuyên sử dụng hãy lưu trong các file và mỗi khi cần sử dụng bạn đọc chỉ cần gọi tên file đó thay vì copy toàn bộ các câu lệnh của các hàm số vào cửa sổ <span style="color: #640514; font-family: Source Code Pro;">Script</span>. Hàm số để gọi một file lên cửa sổ R bạn đang sử dụng là hàm <span style="color: #640514; font-family: Source Code Pro;">source()</span>. Chẳng hạn như tất cả các hàm số bạn đọc tự định nghía được lưu ở một file có tên <span style="color: #640514; font-family: Source Code Pro;">myfunction.R</span>, bạn chỉ cần sử dụng câu lệnh sau để gọi tất cả các hàm số lên cửa sổ đang làm việc:</p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"Đường dẫn đến file/myfunction.R"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="đồ-thị-cơ-bản" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Đồ thị cơ bản<a class="anchor" aria-label="anchor" href="#%C4%91%E1%BB%93-th%E1%BB%8B-c%C6%A1-b%E1%BA%A3n"><i class="fas fa-link"></i></a>
</h2>
<p>Có nhiều hàm trong R để tạo ra các đồ thị từ cơ bản đến phức tạp. Trong phần này chúng tôi sẽ giới thiệu về các hàm cơ bản để tạo đồ thị trong R. Mục đích là để bạn đọc làm quen với các phương pháp vẽ đồ thị phổ biến và hiểu cách tùy chỉnh tham số đồ thị cơ bản. Hiểu về cách vẽ các đồ thị cơ bản sẽ giúp ích rất nhiều khi bạn đọc tìm hiểu về các kỹ thuật trực quan hóa dữ liệu được giới thiệu trong các chương tiếp theo.</p>
<div id="đồ-thị-phân-tán" class="section level3" number="3.5.1">
<h3>
<span class="header-section-number">3.5.1</span> Đồ thị phân tán<a class="anchor" aria-label="anchor" href="#%C4%91%E1%BB%93-th%E1%BB%8B-ph%C3%A2n-t%C3%A1n"><i class="fas fa-link"></i></a>
</h3>
<p>Đồ thị phân tán, được gọi là Scatter plot, là đồ thị được sử dụng để mô tả sự phân tán của các điểm trên một mặt phẳng. Đồ thị phân tán có thể sử dụng để mô tả mối liên hệ của một véc-tơ kiểu số theo chỉ số của nó, hoặc để mô tả mối liên hệ giữa hai véc-tơ kiểu số. Hàm số dùng để vẽ đồ thị phân tán là hàm <span style="color: #640514; font-family: Source Code Pro;">plot()</span>. Một số tham số thường được sử dụng trong hàm này là</p>
<ul>
<li><p>Tham số <span style="color: #640514; font-family: Source Code Pro;">type</span> cho biết hình dạng sẽ xuất hiện, chẳng hạn như <span style="color: #640514; font-family: Source Code Pro;">type = ‘p’</span> cho biết sẽ sử dụng các điểm, <span style="color: #640514; font-family: Source Code Pro;">type = ‘l’</span> cho biết sẽ sử dụng các đường.</p></li>
<li><p>Tham số <span style="color: #640514; font-family: Source Code Pro;">main</span> được sử dụng để viết tiêu đề của đồ thị, <span style="color: #640514; font-family: Source Code Pro;">xlab</span> là tiêu đề của trục <span style="color: #640514; font-family: Source Code Pro;">x</span>, <span style="color: #640514; font-family: Source Code Pro;">ylab</span> là tiêu đề của trục <span style="color: #640514; font-family: Source Code Pro;">y</span>.</p></li>
<li><p>Tham số <span style="color: #640514; font-family: Source Code Pro;">col</span> cho biết màu sắc của các điểm, đường sử dụng trong đồ thị, chẳng hạn như <span style="color: #640514; font-family: Source Code Pro;">col = ‘red’</span> cho biết sẽ sử dụng màu đỏ để vẽ hình.</p></li>
</ul>
<p>Khi đối tượng trong hàm <span style="color: #640514; font-family: Source Code Pro;">plot()</span> là một véc-tơ duy nhất, R sẽ vẽ đồ thị phân tán với trục <span style="color: #640514; font-family: Source Code Pro;">x</span> là chỉ số của các phần tử trong véc-tơ và trục <span style="color: #640514; font-family: Source Code Pro;">y</span> là giá trị của số trong véc-tơ. Câu lệnh dưới đây sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">plot()</span> để vẽ véc-tơ cột <span style="color: #640514; font-family: Source Code Pro;">Temp</span> từ dữ liệu <span style="color: #640514; font-family: Source Code Pro;">airquality</span>:</p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">$</span><span class="va">Temp</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"p"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Biến nhiệt độ (temp) - dữ liệu airquality"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Chỉ số véc-tơ"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Nhiệt độ"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"#640514"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-122"></span>
<img src="07-lap-trinh-co-ban-voi-R_files/figure-html/unnamed-chunk-122-1.png" alt="Vẽ đồ thị phân tán sử dụng hàm plot()" width="672"><p class="caption">
Hình 3.3: Vẽ đồ thị phân tán sử dụng hàm plot()
</p>
</div>
<p>Ngoài vẽ đồ thị một véc-tơ, đồ thị phân tán còn được sử dụng để mô tả mối liên hệ giữa hai biến liên tục. Đồ thị dưới đây mô tả mối liên hệ giữa hai cột <span style="color: #640514; font-family: Source Code Pro;">Temp</span> và <span style="color: #640514; font-family: Source Code Pro;">Ozone</span> trong của dữ liệu <span style="color: #640514; font-family: Source Code Pro;">airquality</span>:</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">$</span><span class="va">Ozone</span>,<span class="va">airquality</span><span class="op">$</span><span class="va">Temp</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"p"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Mối liên hệ giữa Ozone và Temp trong dữ liệu airquality"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Chỉ số Ozone"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Nhiệt độ"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"#640514"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-123"></span>
<img src="07-lap-trinh-co-ban-voi-R_files/figure-html/unnamed-chunk-123-1.png" alt="Mô tả mối liên hệ giữa hai biến liên tục sử dụng hàm plot()" width="672"><p class="caption">
Hình 3.4: Mô tả mối liên hệ giữa hai biến liên tục sử dụng hàm plot()
</p>
</div>
<p>Hàm <span style="color: #640514; font-family: Source Code Pro;">plot()</span> còn có thể được sử dụng để mô tả sự biến động của một véc-tơ theo thời gian. Bạn đọc chỉ cần sử dụng tham số <span style="color: #640514; font-family: Source Code Pro;">type = ‘l’</span> trong hàm <span style="color: #640514; font-family: Source Code Pro;">plot()</span>. Hình vẽ dưới đây mô tả sự biến động của véc-tơ dữ liệu <span style="color: #640514; font-family: Source Code Pro;">AirPassengers</span> theo thời gian:</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">AirPassengers</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Số lượng hành khách trung bình theo tháng"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Thời gian"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Số lượng hành khách"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"#640514"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-124"></span>
<img src="07-lap-trinh-co-ban-voi-R_files/figure-html/unnamed-chunk-124-1.png" alt="Mô tả một biến liên tục theo thời gian sử dụng hàm plot()" width="672"><p class="caption">
Hình 3.5: Mô tả một biến liên tục theo thời gian sử dụng hàm plot()
</p>
</div>
<p>Hàm <span style="color: #640514; font-family: Source Code Pro;">lines()</span> được sử dụng để vẽ thêm các đường vào trong một đồ thị có sẵn. Bạn đọc quan sát các sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">lines()</span> trong đoạn câu lệnh dưới đây. Lưu ý rằng khi chúng ta mô tả nhiều biến trên cùng một đồ thị thì cần có thêm chú giải và điều chỉnh cá giá trị giới hạn trên trục <span style="color: #640514; font-family: Source Code Pro;">y</span> để đồ thị hiển thị đầy đủ:</p>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Vẽ đồ thị chỉ số chứng khoán DAX bằng plot()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">EuStockMarkets</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Chỉ số chứng khoán DAX và SMI"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"#640514"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="op">(</span><span class="st">""</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="op">(</span><span class="st">"Năm"</span><span class="op">)</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1500</span>,<span class="fl">8500</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Vẽ (thêm) chỉ số chứng khoán SMI bằng lines()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">EuStockMarkets</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"#005478"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dùng hàm legend để thêm chú giải vào vị trí</span></span>
<span><span class="co"># (x,y) == (1992,8000)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="fl">1992</span>, <span class="fl">8000</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Chỉ số DAX"</span>, <span class="st">"Chỉ số SMI"</span><span class="op">)</span>,</span>
<span>       fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#005478"</span>,<span class="st">"#640514"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-125"></span>
<img src="07-lap-trinh-co-ban-voi-R_files/figure-html/unnamed-chunk-125-1.png" alt="Mô tả nhiều biến liên tục theo thời gian sử dụng hàm plot() và lines()" width="672"><p class="caption">
Hình 3.6: Mô tả nhiều biến liên tục theo thời gian sử dụng hàm plot() và lines()
</p>
</div>
<p>Bạn đọc có thể nhận thấy rằng chúng tôi sử dụng tham số <span style="color: #640514; font-family: Source Code Pro;">ylim = c(1500,8500)</span> để cho biết giới hạn trên và giới hạn dưới của giá trị trục <span style="color: #640514; font-family: Source Code Pro;">y</span> trong đồ thị. Hàm <span style="color: #640514; font-family: Source Code Pro;">lines()</span> được sử dụng để vẽ (thêm) chỉ số chứng khoán SMI vào trong đồ thị đã được tạo bàng hàm <span style="color: #640514; font-family: Source Code Pro;">plot()</span> trước đó. Sau cùng chúng ta sử dụng hàm <span style="color: #640514; font-family: Source Code Pro;">legend()</span> để thêm chú giải cho biết đâu là chỉ số chứng khoáng DAX, đâu là chỉ số chứng khoán SMI.</p>
</div>
<div id="đồ-thị-cột" class="section level3" number="3.5.2">
<h3>
<span class="header-section-number">3.5.2</span> Đồ thị cột<a class="anchor" aria-label="anchor" href="#%C4%91%E1%BB%93-th%E1%BB%8B-c%E1%BB%99t"><i class="fas fa-link"></i></a>
</h3>
<p>Đồ thị cột hay còn gọi là biểu đồ tần số được sử dụng để mô tả phân phối của một véc-tơ. Hàm số để vẽ đồ thị cột là hàm <span style="color: #640514; font-family: Source Code Pro;">hist()</span>. Chúng ta sử dụng đồ thị dạng cột để mô tả véc-tơ lợi suất của chỉ số DAX như sau</p>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tính return trên chỉ số DAX</span></span>
<span><span class="va">DAX</span><span class="op">&lt;-</span><span class="va">EuStockMarkets</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">n</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">DAX</span><span class="op">)</span></span>
<span><span class="va">r_DAX</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">DAX</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="va">n</span><span class="op">]</span><span class="op">/</span><span class="va">DAX</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dùng hàm hist để vẽ đồ thị tần số</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">r_DAX</span>, main <span class="op">=</span> <span class="st">"Tần suất lợi suất của chỉ số DAX"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>     border <span class="op">=</span> <span class="st">"#640514"</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-126"></span>
<img src="07-lap-trinh-co-ban-voi-R_files/figure-html/unnamed-chunk-126-1.png" alt="Mô tả phân phối của một biến bằng hàm hist()" width="672"><p class="caption">
Hình 3.7: Mô tả phân phối của một biến bằng hàm hist()
</p>
</div>
<p>Ngoài các tham số thường được sử dụng như <span style="color: #640514; font-family: Source Code Pro;">main</span>, <span style="color: #640514; font-family: Source Code Pro;">xlab</span>, <span style="color: #640514; font-family: Source Code Pro;">ylab</span>, hay <span style="color: #640514; font-family: Source Code Pro;">col</span>, hàm <span style="color: #640514; font-family: Source Code Pro;">hist()</span> có một tham số quan trọng là <span style="color: #640514; font-family: Source Code Pro;">breaks</span>. Tham số này cho biết vị trí các điểm mà ở đó chúng ta sẽ tính toán các cột tần suất. Véc-tơ có độ dài càng lớn thì cần càng nhiều điểm được sử dụng để mô tả phân phối dữ liệu. Bạn đọc có thể thấy rằng đồ thị tần xuất mô tả lợi suất của chỉ số DAX ở trên không có nhiều thông tin do các điểm <span style="color: #640514; font-family: Source Code Pro;">breaks</span> quá nhỏ so với độ dài véc-tơ. Chúng ta điều chỉnh lại đồ thị tần suất và sử dụng 50 điểm breaks cách đều từ -0.1 đến 0.1 để có hiển thị tốt hơn</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Dùng hàm hist để vẽ đồ thị tần số</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">r_DAX</span>, main <span class="op">=</span> <span class="st">"Tần suất lợi suất của chỉ số DAX"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,length<span class="op">=</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>     border <span class="op">=</span> <span class="st">"#640514"</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-127"></span>
<img src="07-lap-trinh-co-ban-voi-R_files/figure-html/unnamed-chunk-127-1.png" alt="Sử dụng tham số break trong hàm hist()" width="672"><p class="caption">
Hình 3.8: Sử dụng tham số break trong hàm hist()
</p>
</div>
<p>Biểu đồ tần suất thường được chuẩn hóa về đồ thị xác suất và sử dụng với đồ thị hàm mật độ (density) để mô tả tốt hơn phân phối xác suất của véc-tơ kiểu số. Để chuyển đồ thị tần số thành đồ thị xác suất, bạn đọc sử dụng tham số <span style="color: #640514; font-family: Source Code Pro;">freq</span> và cho giá trị bằng <span style="color: #640514; font-family: Source Code Pro;">FALSE</span>. Đoạn câu lệnh dưới đây mô tả cách sử dụng biểu đồ xác suất kết hợp với đồ thị hàm mật độ của lợi suất của chỉ số DAX</p>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Dùng hàm hist để vẽ đồ thị tần số</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">r_DAX</span>, main <span class="op">=</span> <span class="st">"Phân phối xác suất lợi suất của chỉ số DAX"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, freq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,length<span class="op">=</span><span class="fl">50</span><span class="op">)</span>,</span>
<span>     border <span class="op">=</span> <span class="st">"#640514"</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Kết hợp thêm với đồ thị hàm mật độ</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">r_DAX</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-128"></span>
<img src="07-lap-trinh-co-ban-voi-R_files/figure-html/unnamed-chunk-128-1.png" alt="Sử dụng đồng thời đồ thị tần suất và hàm mật độ để mô tả phân phối xác suất" width="672"><p class="caption">
Hình 3.9: Sử dụng đồng thời đồ thị tần suất và hàm mật độ để mô tả phân phối xác suất
</p>
</div>
</div>
<div id="đồ-thị-hình-hộp" class="section level3" number="3.5.3">
<h3>
<span class="header-section-number">3.5.3</span> Đồ thị hình hộp<a class="anchor" aria-label="anchor" href="#%C4%91%E1%BB%93-th%E1%BB%8B-h%C3%ACnh-h%E1%BB%99p"><i class="fas fa-link"></i></a>
</h3>
<p>Đồ thị hình hộp, hay còn được gọi là box-and-whisker, hoặc boxplot, dùng để mô tả phân phối xác suất của một biến liên tục hoặc để mô tả mối liên hệ giữa một biến liên tục với một biến rời rạc. Đồ thị hình hộp sử dụng 5 giá trị đặc trưng của một véc-tơ để mô tả hình dạng phân phối xác suất và các điểm có nhiều khả năng là giá trị ngoại lai trong một véc-tơ. Chúng tôi sẽ thảo luận kỹ hơn về cách sử dụng boxplot trong chương Trực quan hóa dữ liệu. Trong phần này, chúng tôi chỉ mô tả cách vẽ một đồ thị hình hộp cơ bản.</p>
<p>Hàm <span style="color: #640514; font-family: Source Code Pro;">boxplot()</span> được sử dụng để vẽ đồ thị hình hộp. Đồ thị dưới đây mô tả phân phối xác suất của véc-tơ nhiệt độ (biến <span style="color: #640514; font-family: Source Code Pro;">Temp</span>) trong dữ liệu <span style="color: #640514; font-family: Source Code Pro;">airquality</span> bằng đồ thị kiểu hình hộp:</p>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">$</span><span class="va">Temp</span>,</span>
<span>        border <span class="op">=</span> <span class="st">"#640514"</span>,col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-129"></span>
<img src="07-lap-trinh-co-ban-voi-R_files/figure-html/unnamed-chunk-129-1.png" alt="Đồ thị dạng hộp mô tả phân phối của biến Temp" width="672"><p class="caption">
Hình 3.10: Đồ thị dạng hộp mô tả phân phối của biến Temp
</p>
</div>
<p>Để mô tả phân phối xác suất của nhiệt độ theo tháng (cột Month) trong dữ liệu <span style="color: #640514; font-family: Source Code Pro;">airquality</span> chúng ta sử dụng đồ thị hình hộp như sau</p>
<div class="sourceCode" id="cb287"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">Temp</span><span class="op">~</span><span class="va">Month</span>, data <span class="op">=</span> <span class="va">airquality</span>, border <span class="op">=</span> <span class="st">"#640514"</span>,col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-130"></span>
<img src="07-lap-trinh-co-ban-voi-R_files/figure-html/unnamed-chunk-130-1.png" alt="Đồ thị dạng hộp mô tả phân phối của biến Temp theo tháng (Month)" width="672"><p class="caption">
Hình 3.11: Đồ thị dạng hộp mô tả phân phối của biến Temp theo tháng (Month)
</p>
</div>
<p>Còn nhiều hàm vẽ đồ thị hữu ích trong R bạn đọc có thể tự tìm hiểu như <span style="color: #640514; font-family: Source Code Pro;">barplot()</span>, <span style="color: #640514; font-family: Source Code Pro;">dotchart()</span>, hay <span style="color: #640514; font-family: Source Code Pro;">coplot()</span>. Như chúng tôi đã đề cập, trọng tâm của phần vẽ đồ thị sẽ ở trong chương Trực quan hóa dữ liệu, do đó các đồ thị được liệt kê trong phần này chỉ mang tính tham khảo.</p>
</div>
</div>
<div id="phụ-lục" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Phụ lục<a class="anchor" aria-label="anchor" href="#ph%E1%BB%A5-l%E1%BB%A5c"><i class="fas fa-link"></i></a>
</h2>
<div id="biểu-thức-chính-quy-và-thư-viện-stringr" class="section level3" number="3.6.1">
<h3>
<span class="header-section-number">3.6.1</span> Biểu thức chính quy và thư viện <span style="color: #640514; font-family: Source Code Pro;">stringr</span><a class="anchor" aria-label="anchor" href="#bi%E1%BB%83u-th%E1%BB%A9c-ch%C3%ADnh-quy-v%C3%A0-th%C6%B0-vi%E1%BB%87n-stringr"><i class="fas fa-link"></i></a>
</h3>
<p>Biểu thức chính quy (Regular Expression hay Regex) là công cụ hiệu quả khi chúng phải xử lý một đoạn văn bản dài hoặc một véc-tơ kiểu chuỗi ký tự. Sử dụng biểu thức chính quy giúp cho các câu lệnh phân tích cú pháp, tìm kiếm, và thay thế trong các chuỗi ký tự hay đoạn văn bản trở nên đơn giản hơn rất nhiều. Khái niệm biểu thức chính quy xuất hiện trong hầu hết các ngôn ngữ lập trình nhưng mỗi ngôn ngữ lập trình lại có thể có một cách viết biểu thức chính quy khác nhau. Trong phần này, chúng tôi chỉ thảo luận về biểu thức chính quy trong R và cách sử dụng các biểu thức này trong thư viện chuyên xử lý biến kiểu chuỗi ký tự là thư viện <span style="color: #640514; font-family: Source Code Pro;">stringr</span>.</p>
<p>Biểu thức chính quy là nhóm các quy tắc và cú pháp viết hoặc miêu tả các chuỗi ký tự khác, thường là phức tạp và tổng quát hơn, bằng cách sử dụng các chuỗi ký tự đơn giản. Ví dụ, biểu thức chính quy đơn giản nhất là <code>.</code> đại diện cho tất cả các ký tự có thể xuất hiện trong một chuỗi ký tự. Giả sử chúng ta có biến kiểu chuỗi ký tự là câu trạng thái thứ 20.000 của cựu tổng thống Donald Trump và chúng ta muốn xem trong chuỗi ký tự đó, có những đoạn ký tự nào được bắt đầu bằng chữ “A” và theo sau đó là một ký tự bất kỳ, chúng ta sử dụng biểu thức chính quy <code>"A."</code>. Hàm số sử dụng để hiển thị tất cả đoạn ký tự là hàm <span style="color: #640514; font-family: Source Code Pro;">str_view_all()</span> của thư viện <span style="color: #640514; font-family: Source Code Pro;">stringr</span></p>
<div class="sourceCode" id="cb288"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">str0</span><span class="op">&lt;-</span><span class="va">trump_tweets</span><span class="op">$</span><span class="va">text</span><span class="op">[</span><span class="fl">20000</span><span class="op">]</span></span>
<span><span class="fu">str_view_all</span><span class="op">(</span><span class="va">str0</span>,<span class="st">"A."</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] │ M&lt;AK&gt;E &lt;AM&gt;ERIC&lt;A &gt;GRE&lt;AT&gt; &lt;AG&gt;&lt;AI&gt;N!</code></pre>
<p>Có thể thấy rằng có sáu đoạn ký tự trong biến <span style="color: #640514; font-family: Source Code Pro;">str0</span> được bắt đầu bằng “A” và theo sau là một ký tự bất kỳ. Để miêu tả ký tự <code>.</code> trong chuỗi ký tự và phân biệt với biểu thức chính quy, chúng ta sử dụng <code>\\.</code> để mô tả dấu <code>.</code>. Thật vậy, hãy quan sát ví dụ sau:</p>
<div class="sourceCode" id="cb290"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">str0</span><span class="op">&lt;-</span><span class="st">"I am an actuary. What is your profession?"</span></span>
<span><span class="fu">str_view_all</span><span class="op">(</span><span class="va">str0</span>,<span class="st">"\\."</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] │ I am an actuary&lt;.&gt; What is your profession?</code></pre>
<!-- ## Bài tập -->
<!-- $\textbf{Câu hỏi }$ Bạn có biết R thực sự có rất nhiều bộ dữ liệu tích hợp mà chúng ta có thể sử dụng để thực hành không? Ví dụ: dữ liệu $\textbf{rivers}$ cung cấp chiều dài (tính bằng dặm) của 141 con sông ở Bắc Mỹ do Cơ quan Khảo sát Địa chất Hoa Kỳ thu thập. Hãy xem dữ liệu về chiều dài của các con sông và sau đó thực hiện các yêu cầu sau -->
<!-- a. Có bao nhiêu con sông có độ dài hơn 1000 dặm ? -->
<!-- b. Có bao nhiêu con sông có độ dài từ 1500 đến 2000 dặm? -->
<!-- c. Con sông dài nhất và con sông ngắn nhất có chiều dài là bao nhiêu ? Các con sông này nằm ở vị trí nào trong véc-tơ chứa chiều dài các con sông ? -->
<!-- d. Con sông có chiều dài thứ 3 ở Bắc Mỹ có chiều dài bao nhiêu ? Con sông này nằm ở vị trí thứ bao nhiêu trong dữ liệu ? -->
<!-- e. Tạo một véc-tơ $v$ có 7 phần tử, chứa số phần tử , sô tổng, giá trị trung bình, trung vị, phương sai, độ lệch chuẩn, giá trị nhỏ nhất, và giá trị lớn nhất của véc-tơ chứa chiều dài các con sông. -->
<!-- $\textbf{Câu hỏi }$ Nhiều hàm số có sẵn có thể điều chỉnh kết quả thông qua thay đổi các tham số. Ví dụ: hàm <span style='color: #640514; font-family: Source Code Pro;'>mean()</span> có một tham số `trim`. -->
<!-- a. Hãy sử dụng `?` để tìm hiểu xem tham số `trim` có ý nghĩa gì trong hàm <span style='color: #640514; font-family: Source Code Pro;'>mean()</span>, tham số này có thể nhận các giá trị nào ? -->
<!-- b. Tính kết quả của giá trị trung bình của véc-tơ (-100, 0, 1, 2, 3, 6, 50, 73) với `trim=0,25` mà không sử dụng R để xem bạn có thực sự hiểu tham số `trim` ? Sau đó kiểm tra câu trả lời của bạn bằng cách sử dụng câu lệnh R. -->
<!-- c. Tính giá trị trung bình chiều dài các con sông sau khi lược bỏ 10 quan sát cao nhất và thấp nhất. -->
<!-- $\textbf{Câu hỏi }$ -->
<!-- Hãy đọc mô tả để hiểu cách sử dụng một hàm có sẵn là hàm `cumsum()`. Hàm này trả về một véc-tơ có cùng độ dài với véc-tơ đầu vào. Nhưng trái ngược với các hàm trước, giá trị của một phần tử trong vectơ đầu ra không chỉ phụ thuộc vào phần tử tương ứng của nó trong vectơ đầu vào mà còn phụ thuộc vào tất cả các phần tử trước đó. Ngoài ra, các hàm trong R có cách hoạt động tương tự như `cumsum()` là: `cumprod()`, `cummax()` và `cummin()`. Hãy tìm hiểu về các hàm này và thực hiện các yêu cầu sau: -->
<!-- a. Dữ liệu $\textbf{nhtemp}$ chứa “nhiệt độ trung bình hàng năm tính bằng độ F ở New Haven, Connecticut, từ năm 1912 đến năm 1971. Sử dụng một trong bốn hàm trên để tính giá trị trung bình tối đa nhiệt độ hàng năm ở New Haven được quan sát từ năm 1912, cho mỗi năm 1912-1971 ? -->
<!-- b. Giả sử bạn đầu tư 1.000 USD vào một quỹ đầu tư sẽ mang lại lợi nhuận hàng năm như sau trong 10 năm tới: 9%, 18%, 10%, 7%, 2%, 17%, -8%, 5%, 9%, 33%. Sử dụng một trong bốn hàm trên, hãy cho biết khoản đầu tư của bạn sẽ có giá trị bao nhiêu vào cuối mỗi năm trong 10 năm tiếp theo, giả sử lợi nhuận được tái đầu tư hàng năm. Lưu ý: Nếu một khoản đầu tư mang lại lợi nhuận, ví dụ: 4% mỗi năm, nó sẽ có giá trị gấp 1,04 lần sau một năm, gấp 1,04 * 1,04 sau hai năm, gấp 1,04 * 1,04 * 1,04 sau ba năm, v.v. -->
<!-- # REFERENCE -->
<!-- ### Source from thesis -->
<!-- **1.** Chen, Chun-houh, Wolfgang Karl Härdle, and Antony Unwin, eds (2007). *Handbook of data visualization.* \ -->
<!-- **2.** Aparicio, Manuela, and Carlos J. Costa. (2015). *Data visualization - Communication design quarterly review.* \ -->
<!-- **3.** Hadley Wickham. (2010). *A Layered Grammar of Graphics.* \ -->
<!-- ### Souce from website -->
<!-- **4.** [https://www.tableau.com/learn/articles/data-visualization](https://www.tableau.com/learn/articles/data-visualization) \ -->
<!-- **5.** [https://www.r-graph-gallery.com/ggplot2-package.html](https://www.r-graph-gallery.com/ggplot2-package.html) \ -->
<!-- **6.** [http://r-statistics.co/ggplot2-Tutorial-With-R.html](http://r-statistics.co/ggplot2-Tutorial-With-R.html) \ -->
<!-- **7.** [https://www.maths.usyd.edu.au/u/UG/SM/STAT3022/r/current/Misc/data-visualization-2.1.pdf](https://www.maths.usyd.edu.au/u/UG/SM/STAT3022/r/current/Misc/data-visualization-2.1.pdf) \ -->
<!-- **8.** [https://www.kaggle.com/](https://www.kaggle.com/) \ -->

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="khdl-v%C3%A0-c%C3%A1c-kh%C3%A1i-ni%E1%BB%87m-c%C6%A1-b%E1%BA%A3n.html"><span class="header-section-number">2</span> KHDL và các khái niệm cơ bản</a></div>
<div class="next"><a href="ki%E1%BA%BFn-th%E1%BB%A9c-r-c%C6%A1-b%E1%BA%A3n-1.html"><span class="header-section-number">4</span> Kiến thức R cơ bản</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#ki%E1%BA%BFn-th%E1%BB%A9c-r-c%C6%A1-b%E1%BA%A3n"><span class="header-section-number">3</span> Kiến thức R cơ bản</a></li>
<li>
<a class="nav-link" href="#l%C3%A0m-quen-v%E1%BB%9Bi-c%C3%A1c-d%C3%B2ng-l%E1%BB%87nh-c%C6%A1-b%E1%BA%A3n"><span class="header-section-number">3.1</span> Làm quen với các dòng lệnh cơ bản</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#s%E1%BB%AD-d%E1%BB%A5ng-r-nh%C6%B0-m%E1%BB%99t-m%C3%A1y-t%C3%ADnh-c%E1%BA%A7m-tay"><span class="header-section-number">3.1.1</span> Sử dụng R như một máy tính cầm tay</a></li>
<li><a class="nav-link" href="#s%E1%BB%AD-d%E1%BB%A5ng-c%E1%BB%ADa-s%E1%BB%95-script-%C4%91%E1%BB%83-vi%E1%BA%BFt-c%C3%A2u-l%E1%BB%87nh"><span class="header-section-number">3.1.2</span> Sử dụng cửa sổ Script để viết câu lệnh</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#bi%E1%BA%BFn-trong-ng%C3%B4n-ng%E1%BB%AF-r"><span class="header-section-number">3.2</span> Biến trong ngôn ngữ R</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#bi%E1%BA%BFn-ki%E1%BB%83u-s%E1%BB%91"><span class="header-section-number">3.2.1</span> Biến kiểu số</a></li>
<li><a class="nav-link" href="#bi%E1%BA%BFn-ki%E1%BB%83u-logical"><span class="header-section-number">3.2.2</span> Biến kiểu logical</a></li>
<li><a class="nav-link" href="#bi%E1%BA%BFn-ki%E1%BB%83u-chu%E1%BB%97i-k%C3%BD-t%E1%BB%B1"><span class="header-section-number">3.2.3</span> Biến kiểu chuỗi ký tự</a></li>
<li><a class="nav-link" href="#bi%E1%BA%BFn-ki%E1%BB%83u-th%E1%BB%9Di-gian"><span class="header-section-number">3.2.4</span> Biến kiểu thời gian</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#v%C3%A9c-t%C6%A1"><span class="header-section-number">3.3</span> Véc-tơ</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#t%E1%BA%A1i-sao-x%E1%BB%AD-l%C3%BD-v%C3%A9c-t%C6%A1-l%C3%A0-th%E1%BA%BF-m%E1%BA%A1nh-c%E1%BB%A7a-r"><span class="header-section-number">3.3.1</span> Tại sao xử lý véc-tơ là thế mạnh của R?</a></li>
<li><a class="nav-link" href="#kh%E1%BB%9Fi-t%E1%BA%A1o-v%C3%A9c-t%C6%A1-v%C3%A0-c%C3%A1c-ph%C3%A9p-to%C3%A1n-tr%C3%AAn-v%C3%A9c-t%C6%A1"><span class="header-section-number">3.3.2</span> Khởi tạo véc-tơ và các phép toán trên véc-tơ</a></li>
<li><a class="nav-link" href="#l%E1%BA%A5y-c%C3%A1c-th%C3%A0nh-ph%E1%BA%A7n-con-t%E1%BB%AB-m%E1%BB%99t-v%C3%A9c-t%C6%A1"><span class="header-section-number">3.3.3</span> Lấy các thành phần con từ một véc-tơ</a></li>
<li><a class="nav-link" href="#c%C3%A1c-h%C3%A0m-t%E1%BA%A1o-ch%E1%BB%89-s%E1%BB%91"><span class="header-section-number">3.3.4</span> Các hàm tạo chỉ số</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#ng%C3%B4n-ng%E1%BB%AF-l%E1%BA%ADp-tr%C3%ACnh-r"><span class="header-section-number">3.4</span> Ngôn ngữ lập trình R</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#c%C3%A2u-l%E1%BB%87nh-%C4%91i%E1%BB%81u-ki%E1%BB%87n"><span class="header-section-number">3.4.1</span> Câu lệnh điều kiện</a></li>
<li><a class="nav-link" href="#vi%E1%BA%BFt-v%C3%B2ng-l%E1%BA%B7p"><span class="header-section-number">3.4.2</span> Viết vòng lặp</a></li>
<li><a class="nav-link" href="#h%C3%A0m-s%E1%BB%91"><span class="header-section-number">3.4.3</span> Hàm số</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#%C4%91%E1%BB%93-th%E1%BB%8B-c%C6%A1-b%E1%BA%A3n"><span class="header-section-number">3.5</span> Đồ thị cơ bản</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%C4%91%E1%BB%93-th%E1%BB%8B-ph%C3%A2n-t%C3%A1n"><span class="header-section-number">3.5.1</span> Đồ thị phân tán</a></li>
<li><a class="nav-link" href="#%C4%91%E1%BB%93-th%E1%BB%8B-c%E1%BB%99t"><span class="header-section-number">3.5.2</span> Đồ thị cột</a></li>
<li><a class="nav-link" href="#%C4%91%E1%BB%93-th%E1%BB%8B-h%C3%ACnh-h%E1%BB%99p"><span class="header-section-number">3.5.3</span> Đồ thị hình hộp</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#ph%E1%BB%A5-l%E1%BB%A5c"><span class="header-section-number">3.6</span> Phụ lục</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#bi%E1%BB%83u-th%E1%BB%A9c-ch%C3%ADnh-quy-v%C3%A0-th%C6%B0-vi%E1%BB%87n-stringr"><span class="header-section-number">3.6.1</span> Biểu thức chính quy và thư viện stringr</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/NEUKhoaToanKT/Khoa_hoc_du_lieu_trong_KTKD/blob/master/07-lap-trinh-co-ban-voi-R.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/NEUKhoaToanKT/Khoa_hoc_du_lieu_trong_KTKD/edit/master/07-lap-trinh-co-ban-voi-R.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Khoa Học Dữ Liệu trong Kinh tế và Kinh doanh</strong>" was written by Nguyễn Quang Huy. It was last built on 2024-08-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
