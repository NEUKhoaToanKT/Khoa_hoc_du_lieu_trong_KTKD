[{"path":"index.html","id":"lời-nói-đầu","chapter":"Lời nói đầu","heading":"Lời nói đầu","text":" Khoa học dữ liệu (KHDL) là ngành khoa học kết hợp giữa toán học - xác suất thống kê với khoa học máy tính và kiến thức chuyên môn trong một lĩnh vực cụ thể như kinh tế, tài chính, y học, giáo dục, thể thao, v.v., để khám phá những thông tin hữu ích và có giá trị nằm trong dữ liệu liên quan đến lĩnh vực chuyên môn đó. Những thông tin hữu ích này được sử dụng để hướng dẫn việc ra quyết định và lập kế hoạch chiến lược cho các cơ quan, tổ chức, doanh nghiệp và các cá nhân hoạt động trong lĩnh vực này.Cuốn sách “Khoa học dữ liệu trong Kinh tế và Kinh doanh” được viết xuất phát từ nhu cầu học tập và tìm hiểu về KHDL của những bạn đọc đang học tập, nghiên cứu và làm việc trong lĩnh vực kinh tế, quản lý, quản trị kinh doanh. Cuốn sách ít tập trung vào các khái niệm mang tính kỹ thuật trong toán học hay khoa học máy tính, mà tập trung nhiều hơn vào việc mô tả và áp dụng các phương pháp trên những vấn đề cụ thể. Trong mỗi chương đều sẽ có phần thực hành sử dụng phần mềm thống kê R để minh họa cách triển khai các phương pháp kỹ thuật. Những phần thực hành này sẽ cung cấp cho bạn đọc những trải nghiệm thực tiễn có giá trị.Cuốn sách phù hợp với sinh viên đại học hoặc cao học các ngành kinh tế, khoa học quản lý, quản trị kinh doanh, thương mại, tài chính ngân hàng, bảo hiểm, v.v., muốn nâng cao hiểu biết và tăng cường kinh nghiệm về làm việc với dữ liệu. Cuốn sách có thể làm giáo trình hoặc sách tham khảo cho một môn học kéo dài trong hai học kỳ.Nội dung của cuốn sách bao gồm hầu hết những chủ đề quan trọng trong KHDL: thu thập dữ liệu, tiền xử lý, sắp xếp và biến đổi, trực quan hóa, và xây dựng mô hình trên dữ liệu. Các mô hình được trình bày trong cuốn sách bao gồm cả các mô hình đơn giản như hồi quy tuyến tính hay cây quyết định, và các mô hình phức tạp như mô hình tuyến tính tổng quát, mô hình cộng tính tổng quát, mô hình rừng ngẫu nhiên, học tăng cường hoặc mô hình mạng nơ-ron. Song song với việc trình bày và giải thích các mô hình, chúng tôi sẽ cung cấp các gói lệnh có sẵn để bạn đọc thực hành trên các dữ liệu cụ thể.Đây là phiên bản đầu tiên của cuốn sách nên không thể tránh được những sai sót. Chúng tôi hy vọng rằng sẽ nhận được sự góp ý của bạn đọc về nội dung của cuốn sách để chúng tôi có thể hoàn thiện trong các phiên bản tiếp theo.Xin chân thành cảm ơn các đồng nghiệp tại Khoa Toán Kinh tế nói riêng và Đại học Kinh tế Quốc dân nói chung đã đồng hành cùng với chúng tôi trong suốt quá trình hoàn thành cuốn sách này. Xin cảm ơn các thành viên của Actuarial Sciences Lab đã nỗ lực hết sức để cuốn sách này có thể đến tay người đọc trong thời gian ngắn nhất!","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"giới-thiệu-về-cuốn-sách","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"Chương 1 Giới thiệu về cuốn sách","text":"","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"giới-thiệu-về-khoa-học-dữ-liệu-và-các-ứng-dụng","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.1 Giới thiệu về Khoa học dữ liệu và các ứng dụng","text":"Khoa học dữ liệu là một ngành liên ngành kết hợp kiến thức từ nhiều lĩnh vực như toán học, thống kê, khoa học máy tính và kỹ thuật dữ liệu để thu thập, xử lý, phân tích và diễn giải dữ liệu. Mục tiêu của khoa học dữ liệu là biến dữ liệu thô thành thông tin hữu ích, hỗ trợ ra quyết định và giải quyết các vấn đề phức tạp trong nhiều lĩnh vực khác nhau. Một quá trình ứng dụng KHDL vào giải quyết một vấn đề cụ thể thường bao gồm các bước được mô tả như Hình 1.1.\nHình 1.1: Quy trình áp dụng Khoa học dữ liệu để giải quyết một vấn đề thực tế\nNhập liệu là quá trình tìm kiếm và thu thập dữ liệu từ các nguồn khác nhau để phục vụ cho mục đích ra quyết định. Có những dự án làm việc trực tiếp trên dữ liệu có sẵn và đã được thiết kế sẵn sàng cho mục tiêu phân tích, nhưng cũng có những dự án mà quá trình nhập liệu lại chiếm phần lớn thời gian và quyết định sự thành công hay thất bại của dự án.Nhập liệu là quá trình tìm kiếm và thu thập dữ liệu từ các nguồn khác nhau để phục vụ cho mục đích ra quyết định. Có những dự án làm việc trực tiếp trên dữ liệu có sẵn và đã được thiết kế sẵn sàng cho mục tiêu phân tích, nhưng cũng có những dự án mà quá trình nhập liệu lại chiếm phần lớn thời gian và quyết định sự thành công hay thất bại của dự án.Sắp xếp (tổ chức) dữ liệu, hay còn được gọi là tiền xử lý dữ liệu, là các bước biến dữ liệu từ dạng thô thành dữ liệu theo đúng như định dạng mong muốn.Sắp xếp (tổ chức) dữ liệu, hay còn được gọi là tiền xử lý dữ liệu, là các bước biến dữ liệu từ dạng thô thành dữ liệu theo đúng như định dạng mong muốn.Biến đổi dữ liệu là quá trình tính toán trên các biến hoặc các quan sát của dữ liệu để dữ liệu có thể đưa vào các công cụ trực quan hoặc các mô hình phân tích.Biến đổi dữ liệu là quá trình tính toán trên các biến hoặc các quan sát của dữ liệu để dữ liệu có thể đưa vào các công cụ trực quan hoặc các mô hình phân tích.Xây dựng mô hình là quá trình tính toán và đánh giá mối liên hệ giữa các biến trong dữ liệu đến các biến mục tiêu, là đầu ra của toàn bộ quá trình. Mô hình thường được xây dựng với một trong hai mục đích: xem xét sự tác động của một biến đến các biến mục tiêu hoặc dự đoán giá trị của các biến mục tiêu.Xây dựng mô hình là quá trình tính toán và đánh giá mối liên hệ giữa các biến trong dữ liệu đến các biến mục tiêu, là đầu ra của toàn bộ quá trình. Mô hình thường được xây dựng với một trong hai mục đích: xem xét sự tác động của một biến đến các biến mục tiêu hoặc dự đoán giá trị của các biến mục tiêu.Mô hình trên dữ liệu được xây dựng dựa trên những nguyên lý của toán học và xác suất thống kê. Dữ liệu được sử dụng để xây dựng mô hình có thể là các dữ liệu nhỏ với một vài cột và vài chục quan sát, nhưng cũng có thể là các dữ liệu lớn với hàng nghìn cột dữ liệu và hàng triệu quan sát. Dữ liệu thậm chí không có dạng bảng biểu như chúng ta gặp hàng ngày mà có thể là các hình ảnh, các văn bản, giọng nói, dạng đồ thị,… Để xử lý các bộ dữ liệu khổng lồ, hay các dữ liệu không có cấu trúc bảng thông thường, người xử lý dữ liệu cần có kiến thức về khoa học máy tính và lập trình để thực hiện các tính toán trên máy tính điện tử. Những ứng dụng của KHDL có thể thuộc về bất kỳ lĩnh vực nào như kinh doanh, y học, vật lý, thiên văn, quản lý nhà nước, chính sách công,… nên đòi hỏi người xây dựng mô hình cũng cần có kiến thức chuyên môn trong lĩnh vực tương ứng để không bị sai định hướng trong quá trình làm việc với dữ liệu.Để minh họa ứng dụng của KHDL trong lĩnh vực kinh tế và kinh doanh, chúng tôi thảo luận ngắn gọn về ba dữ liệu được thu thập trong thế giới thực được xem xét trong cuốn sách này.","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"dữ-liệu-chi-phí-quảng-cáo","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.1.1 Dữ liệu chi phí quảng cáo","text":"Đây là một dữ liệu dạng bảng về chiến dịch quảng cáo của một công ty thu thập được từ 55 cửa hàng trên toàn quốc. Dữ liệu bao gồm thông tin về doanh thu bán sản phẩm và chi phí công ty đã chi cho ba phương thức quảng cáo là quảng cáo qua truyền hình, quảng cáo qua các nền tảng mạng xã hội, và quảng cáo bằng hình thức phát tờ rơi. Mối liên hệ của chi phí cho mỗi phương thức quảng cáo đến doanh thu từ bán sản phẩm được mô tả trong Hình 1.2\nHình 1.2: Doanh thu bán hàng (tỷ đồng) và mối liên hệ với chi phí quảng cáo. Hình bên trái: Chi phí quảng cáo trên Tivi. Hình ở giữa: chi phí quảng cáo qua các nền tảng mạng xã hội. Hình bên phải: quảng cáo theo hình thức phát tờ rơi\nTừ Hình 1.2 có thể đưa ra nhận định khá chắc chắn là chi tiền cho quảng cáo có ý nghĩa trong việc tăng doanh thu bán sản phẩm. Có thể thấy trong các đồ thị ở hàng phía trên rằng có mối liên hệ cùng chiều giữa chi phí chi cho các hình thức quảng cáo đến doanh thu bán sản phẩm. Mối liên hệ này là phù hợp với logic nói chung về quảng cáo sản phẩm: khi công ty chi tiền cho quảng cáo, nhiều khách hàng sẽ có cơ hội tiếp cận về sản phẩm hơn, làm tăng số lượng người mua sản phẩm và tăng doanh thu cho các cửa hàng.Tuy nhiên, vẫn còn","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"dữ-liệu-bảo-hiểm-xã-hội","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.1.2 Dữ liệu bảo hiểm xã hội","text":"","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"dữ-liệu-về-giá-xe-ôtô-cũ","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.1.3 Dữ liệu về giá xe ôtô cũ","text":"","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"sơ-lược-quá-trình-phát-triển-của-xây-dựng-mô-hình-dữ-liệu","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.2 Sơ lược quá trình phát triển của xây dựng mô hình dữ liệu","text":"Mặc dù thuật ngữ xây dựng mô hình trên dữ liệu, hay được gọi một cách kỹ thuật hơn là học máy, còn khá mới mẻ, nhưng những khái niệm nền tảng cho lĩnh vực này đã được phát triển từ lâu. Vào đầu thế kỷ 19, phương pháp bình phương nhỏ nhất đã được phát triển và áp dụng để ước lượng các mô hình hồi quy tuyến tính. Mô hình này lần đầu tiên được áp dụng và cho kết quả thành công trong các vấn đề liên quan đến thiên văn học. Vào đầu thế kỷ 20, mô hình hồi quy tuyến tính được sử dụng để dự đoán các giá trị định lượng, chẳng hạn như mức lương của một cá nhân hoặc để dự đoán các giá trị định tính, chẳng hạn như bệnh nhân sống hay chết, hay thị trường chứng khoán tăng hay giảm. Vào những năm 1940, nhiều tác giả đã đưa ra một cách tiếp cận khác, đó là hồi quy logistic. Vào đầu những năm 1970, thuật ngữ mô hình tuyến tính tổng quát đã được phát triển để mô tả toàn bộ lớp phương pháp học thống kê bao gồm cả hồi quy tuyến tính và hồi quy logistic như các trường hợp đặc biệt. Vào cuối những năm 1970, nhiều kỹ thuật xây dựng mô hình trên dữ liệu đã xuất hiện. Tuy nhiên, các mô hình này chỉ xoay quanh các phương pháp tuyến tính vì việc tạo ra các mối quan hệ phi tuyến tính rất khó khăn về mặt tính toán.Đến những năm 1980, sự phát triển của máy tính điện tử đã hỗ trợ tích cực về mặt tính toán cho các phương pháp phi tuyến tính. Các mô hình phi tuyến được giới thiệu vào đầu những năm 1980 bao gồm mô hình cây quyết định và mô hình cộng tính tổng quát. Những năm cuối thập niên 1980 và đầu thập niên 1990, mô hình mạng nơ-ron được giới thiệu đến cộng đồng nghiên cứu nhưng chưa nhận được nhiều sự quan tâm vì dữ liệu chưa đủ phong phú và sự phổ biến của các mô hình học máy khác.\nHình 1.3: Quá trình phát triển của các mô hình học máy\nGiai đoạn cuối thế kỷ XX và đầu thế kỷ XXI là giai đoạn chiếm ưu thế hoàn toàn của các mô hình học máy rừng ngẫu nhiên và thuật toán học tăng cường. Thuật toán học tăng cường với các biến thể như XGBoost hay LightGBM chiến thắng trong hầu hết các cuộc thi về khoa học dữ liệu.Từ năm 2010, với sự bùng nổ của các thiết bị thông minh và kết nối internet, dữ liệu trở nên phong phú và đa dạng hơn cũng là thời điểm quay trở lại của mô hình mạng nơ-ron, hay còn được gọi với tên gọi khác là mô hình mạng học sâu (deep learning). Mô hình mạng học sâu vượt trội hoàn toàn các mô hình học máy thông thường khi làm việc với dữ liệu kiểu hình ảnh, video, ngôn ngữ tự nhiên bao gồm cả văn bản và giọng nói. Sự kiện đánh dấu sự phát triển vượt bậc của các mô hình mạng học sâu là sự ra đời của ChatGPT vào cuối năm 2022, một mô hình ngôn ngữ lớn cho phép người dùng tương tác, hỏi đáp và trò chuyện một cách hoàn toàn tự nhiên theo định hướng của người sử dụng như phong cách, mức độ chi tiết, hình thức ngôn ngữ. ChatGPT nhanh chóng đạt đến 100 triệu người dùng sau hơn hai tháng phát hành và giúp cho công ty phát hành OpenAI được định giá khoảng 30 tỷ USD. Cho đến thời điểm cuối năm 2023 khi nhóm tác giả bắt đầu viết cuốn sách này, ChatGPT đã được cập nhật đến phiên bản 3.5.","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"tại-sao-lại-sử-dụng-phần-mềm-r","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.3 Tại sao lại sử dụng phần mềm R?","text":"Trong thế giới ngày nay, hầu hết các cơ quan, tổ chức, tập đoàn, doanh nghiệp từ lớn đến nhỏ đều sử dụng một lượng dữ liệu nhất định để phân tích các sự kiện trong quá khứ và cố gắng dự đoán xu hướng trong tương lai để đưa ra các quyết định có lợi cho mình. Tuy nhiên, khi dữ liệu ngày càng tăng lên cả về số lượng và sự phức tạp, các cơ quan tổ chức cần một công cụ giúp họ thực hiện các phân tích trên dữ liệu một cách nhanh hơn và chính xác hơn. Một trong những công cụ hiệu quả nhất hiện nay là phần mềm R.","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"phần-mềm-r-là-gì","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.3.1 Phần mềm R là gì?","text":"Trước tiên, R là ngôn ngữ lập trình được xây dựng để phục vụ cho toán học và thống kê, đồng thời R cũng là một môi trường phần mềm mã nguồn mở miễn phí cho người sử dụng. R được giới thiệu lần đầu tiên vào năm 1992 bởi các giáo sư Ross Ihaka và Robert Gentleman như một ngôn ngữ lập trình để dạy thống kê tại Đại học Auckland. Tên của ngôn ngữ, R, xuất phát từ chữ cái đầu tiên của các tác giả là Ross và Robert.Trước khi trở thành ngôn ngữ lập trình cho khoa học dữ liệu, R thường được coi là ngôn ngữ lập trình cho các nhà toán học và thống kê. Sau nhiều năm phát triển, R luôn được coi là một trong những ngôn ngữ lập trình phổ biến nhất trong giới học thuật vì độ tin cậy. Mỗi thư viện của R đều được phát triển một cách hoàn chỉnh và trải qua quá trình kiểm soát chặt chẽ. Tạp chí R (R Journal) là tạp chí học thuật về các phương pháp tính toán trong toán học và thống kê sử dụng phần mềm R luôn nằm trong danh sách các tạp chí khoa học uy tín (Science Citation Index Expanded hay SCIE) của Web Science. Chính vì sự uy tín trong học thuật nên đa số các trường đại học và viện nghiên cứu hàng đầu trên thế giới sử dụng R như là một ngôn ngữ chính trong đào tạo về tính toán, toán học và thống kê.","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"tại-sao-r-lại-được-sử-dụng-trong-khdl","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.3.2 Tại sao R lại được sử dụng trong KHDL?","text":"Trong khoảng hơn 10 năm trở lại đây, R không còn chỉ là ngôn ngữ lập trình thông thường như trước đây nữa. Mặc dù vẫn là một công cụ mạnh mẽ trong tính toán toán học và thống kê, nhưng còn có rất nhiều công cụ tuyệt vời khác mà bạn đọc có thể làm với R, đặc biệt là những ứng dụng trong khoa học dữ liệu (KHDL). Nguyên nhân chính giúp cho phần mềm R nhanh chóng trở thành ngôn ngữ phổ biến trong KHDL là nền tảng quan trọng nhất của KHDL chính là toán học và thống kê. Đồng thời, ngôn ngữ lập trình R cũng đủ linh hoạt để người sử dụng viết các chương trình yêu cầu tính toán phức tạp trong khoa học máy tính. Một cách tự nhiên, những nhà toán học, thống kê học và các tổ chức sử dụng R như là một ngôn ngữ chính sẽ tìm cách phát triển R để đáp ứng được yêu cầu xử lý dữ liệu của chính họ. Một nguyên nhân khác khiến cho R phổ biến trong KHDL là đặc thù mã nguồn mở của phần mềm này. Những người làm việc trong lĩnh vực KHDL sử dụng R có thể chia sẻ kiến thức và kinh nghiệm một cách nhanh chóng và rộng rãi.","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"r-có-thể-làm-những-gì","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.3.3 R có thể làm những gì?","text":"Danh sách những việc bạn có thể làm trong R là không thể liệt kê hết bởi vì phần mềm này vẫn đang được phát triển không ngừng. Dưới đây là một số ứng dụng phổ biến mà R vượt trội hơn với các ngôn ngữ khác:Lập trình trong toán học, tính toán tối ưu, giải tối ưu bằng phương pháp số.Tính toán liên quan đến lý thuyết xác suất.Thực hiện các kiểm định thống kê.Phát triển phần mềm thống kê.Xây dựng mô hình kinh tế lượng.Mô phỏng ngẫu nhiên.Các tính năng của R dành cho khoa học dữ liệu được liệt kê dưới đây:Thu thập tập dữ liệu, bao gồm cả dữ liệu lớn và không có cấu trúc.Khai phá dữ liệu.Xử lý, sắp xếp, biến đổi dữ liệu.Phân tích dữ liệu.Trực quan hóa dữ liệu.Xây dựng các mô hình từ đơn giản đến phức tạp.","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"tại-sao-cuốn-sách-này-lại-sử-dụng-r","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.3.4 Tại sao cuốn sách này lại sử dụng R?","text":"Mặc dù có một số phần mềm khác có thể được sử dụng thay thế cho R trong phân tích dữ liệu, nhưng chúng tôi lựa chọn ngôn ngữ R vì:R là một phần mềm uy tín và đáng tin cậy được sử dụng bởi các trường đại học và các viện nghiên cứu hàng đầu trên thế giới. R cũng được sử dụng rộng rãi trong các công ty công nghệ hàng đầu như Microsoft, Facebook, Google, và IBM.R là ngôn ngữ lập trình rất dễ hiểu cho người mới bắt đầu, kể cả với những người không có kinh nghiệm lập trình. Còn nếu bạn đã có kinh nghiệm về một ngôn ngữ lập trình, bạn sẽ chỉ cần một khoảng thời gian ngắn để có thể viết các chương trình với R.Phần mềm R là một phần mềm mã nguồn mở, nghĩa là bạn có thể sử dụng R và hơn 12.000 thư viện mở rộng mà không cần phải bỏ ra bất kỳ chi phí nào. Điều này giúp cho R trở nên rất dễ tiếp cận đối với sinh viên và người học không sẵn sàng chi trả một khoản chi phí để học về khoa học dữ liệu. Đồng thời, giảng viên cũng có thể tận dụng tối đa môi trường phần mềm này khi giảng dạy cho sinh viên.Cuối cùng và cũng không kém phần quan trọng, đó là sự hỗ trợ từ cộng đồng. Với số lượng người dùng lên đến hàng triệu người, nhiều trong số đó là những nhà toán học, thống kê học, giáo sư tại các trường đại học, bạn sẽ luôn tìm thấy sự hỗ trợ mỗi khi gặp bất kỳ vấn đề khi làm việc với R.","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"các-lựa-chọn-thay-thế-và-bổ-sung-cho-r-trong-khdl","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.3.5 Các lựa chọn thay thế và bổ sung cho R trong KHDL","text":"Như chúng ta đã thấy, R là một trong những ngôn ngữ lập trình tốt nhất cho người mới bắt đầu bước chân vào lĩnh vực khoa học dữ liệu (KHDL). Tuy nhiên, bạn cũng có thể tìm thấy các phần mềm/ngôn ngữ có thể sử dụng để thay thế cho R trong quá trình học tập và làm việc:Python - Vào thời điểm chúng tôi hoàn thành cuốn sách này, Python là ngôn ngữ lập trình được sử dụng nhiều nhất trong KHDL. Python được giới thiệu lần đầu tiên vào năm 1991 và đã không ngừng tiến hóa và phát triển. Cũng như R, Python có mã nguồn mở và hoàn toàn miễn phí cho người sử dụng. Câu lệnh của Python rất dễ học và đặc biệt mạnh mẽ trong lập trình hướng đối tượng.Julia - Xuất hiện lần đầu tiên vào năm 2012, Julia là một trong những ngôn ngữ lập trình mới nhất và là lựa chọn tối ưu cho các nhà khoa học dữ liệu. Ngôn ngữ lập trình cấp cao và hiệu suất cao này rất năng động và phù hợp để viết bất kỳ loại ứng dụng nào. Mặc dù Python và R vẫn được ưu tiên cho KHDL và học máy, nhưng Julia dự báo sẽ vượt qua cả hai trong tương lai gần. Mặc dù đây là ngôn ngữ lập trình tổng quát, nhưng nó có tất cả các đặc điểm cần thiết để xử lý phân tích, thống kê và dữ liệu lớn.MATLAB - Được phát triển bởi MathWorks, ngôn ngữ lập trình này là một môi trường điện toán được phát triển đặc biệt để phân tích số và thống kê. Nhờ có số lượng lớn các thư viện có sẵn cho người dùng, MATLAB cho phép lập trình viên truy cập dữ liệu, xử lý dữ liệu và tạo các mô hình học máy từ đơn giản đến phức tạp. Mặc dù MATLAB là một hệ thống hiệu suất cao, nhưng lại không phải là nguồn mở hoặc miễn phí. Thay vào đó, nó được xây dựng bởi các nhà phát triển chuyên nghiệp.Java - Là một trong những ngôn ngữ lập trình phổ biến nhất và cũng là một lựa chọn cho những người mới bước vào lĩnh vực KHDL. Mặc dù vẫn có thể tải xuống miễn phí, một số ứng dụng chỉ có sẵn trong phiên bản trả phí. Cú pháp của Java cũng tương đối dễ học đối với người mới bắt đầu. Nhìn chung, Java vẫn là ngôn ngữ có mục đích chung và được các nhà khoa học dữ liệu coi là một lựa chọn bổ sung cho R hoặc Python.Ngoài việc thành thạo R hoặc một phần mềm chuyên dùng trong KHDL, bạn nên bổ sung cho mình các ngôn ngữ lập trình khác để đạt hiệu suất công việc tốt nhất:SQL hay ngôn ngữ truy vấn dữ liệu có cấu trúc. SQL xuất hiện từ năm 1974 và đã không ngừng được cải tiến và sửa đổi để giúp cho ngôn ngữ này luôn nằm trong nhóm những ngôn ngữ lập trình được lựa chọn hàng đầu trong KHDL. SQL có cả các phiên bản miễn phí và các phiên bản thương mại mà người sử dụng phải trả chi phí.C và C++ là các ngôn ngữ lập trình hiệu suất cao có thể giúp bạn tăng hiệu quả của các chương trình. Hầu như tất cả các ứng dụng trên hệ điều hành máy tính và điện thoại di động hiện nay đều sử dụng C và C++. Viết các chương trình dưới ngôn ngữ C hoặc C++ sẽ hiệu quả về mặt thời gian hơn nhiều với các ngôn ngữ khác.","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"cài-đặt-r-và-rstudio","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.3.6 Cài đặt R và RStudio","text":"Bạn đọc sẽ bắt đầu bằng cài đặt phần mềm R và sau đó là cài đặt RStudio - một môi trường phát triển phổ biến dành cho R. Phần mềm R dành cho các hệ điều hành MAC OS, Windows, và Linux đều có sẵn để tải xuống từ trang web chính thức:https://cran.r-project.org/Tại thời điểm chúng tôi viết cuốn sách này, R đang là phiên bản 4.1.0. Sau khi tải xuống, chúng ta chỉ cần cài đặt R giống như tất cả các phần mềm khác với tất cả các tùy chọn mặc định.Sau khi cài đặt phần mềm R, bạn đọc cài đặt Rstudio. Chúng ta hoàn toàn có thể sử dụng R mà không cần có Rstudio. Tuy nhiên, Rstudio sẽ hỗ trợ bạn rất nhiều trong quá trình sử dụng R, đó, lời khuyên của chúng tôi là hãy sử dụng Rstudio cùng với R. Để tải xuống Rstudio, bạn truy cập vào trang web chính thức:https://posit.co/download/rstudio-desktop/RStudio là một công cụ linh hoạt giúp bạn tạo các phân tích dễ đọc và giữ mã, hình ảnh, nhận xét và sơ đồ của bạn ở cùng một nơi. Sử dụng RStudio để lập trình và phân tích dữ liệu trong R mang lại nhiều lợi ích. Dưới đây là một vài ví dụ về những gì RStudio cung cấp:Giao diện trực quan cho phép chúng ta theo dõi các đối tượng, tập lệnh và số liệu đã lưu.Trình soạn thảo văn bản có các tính năng như tự động gợi ý câu lệnh, hiển thị màu giúp cho việc viết các câu lệnh rõ ràng.Hiển thị mô tả hàm số, dữ liệu bằng thao tác đơn giản.Thanh công cụ có đầy đủ các tính năng trực quan để bạn đọc sử dụng thay vì phải viết câu lệnh.Mỗi khi bạn đọc mở RStudio, R cũng được khởi chạy tự động. Giao diện RStudio rất trực quan và dễ sử dụng. Các cửa sổ quan trọng bao gồm:Cửa số Console là nơi chúng ta có thể chạy các câu lệnh R.Cửa sổ Environment là chúng ta theo dõi các đối tượng, tập lệnh và số liệu đã lưu.Cửa sổ File là nơi hiển thị địa chỉ thư mục đang làm việc, hiển thị đồ thị trực quan, hoặc hiển thị mô tả dữ liệu, hàm số, thư viện.Bạn đọc sẽ làm quen dần với giao diện và các cửa sổ làm việc khác nhau của RStudio trong quá trình thực hành trên các câu lệnh và dữ liệu cụ thể. Chúng tôi sẽ không đi quá sâu vào chi tiết tại đây.","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"về-cuốn-sách-và-tác-giả","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.4 Về cuốn sách và tác giả","text":"Cuốn sách được viết với mục tiêu là để thành sách tham khảo chính cho các môn học “Phân tích và dự báo” và “Khoa học dữ liệu cơ bản” cho sinh viên và học viên cao học ngành Toán Kinh tế tại Đại học Kinh tế Quốc dân. Chúng tôi tin rằng những kiến thức và công cụ được giới thiệu trong cuốn sách này sẽ là những hành trang quan trọng cho những nhà kinh tế và kinh doanh tương lai trước khi bước chân vào thế giới việc làm đầy tính cạnh tranh như hiện nay.","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"đôi-lời-từ-tác-giả","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.4.1 Đôi lời từ tác giả","text":"Tôi không phải là một nhà kinh tế, cũng không phải là một chuyên gia dữ liệu, và tôi cũng chưa từng được đào tạo bài bản về máy tính hay lập trình, tôi là một Actuary. Cuốn sách được viết dựa trên kinh nghiệm làm việc và giảng dạy của tôi trong những lĩnh vực khoa học tính toán (Actuarial science). Tôi bắt đầu sử dụng R như một phần mềm thống kê khi còn là một sinh viên đại học. Ấn tượng đầu tiên của tôi về R là khi phần mềm này được sử dụng để mô phỏng các chuyển động Brown hình học vô cùng bắt mắt. Và R vẫn tiếp tục đồng hành với tôi cho đến nay trong cả môi trường doanh nghiệp và học thuật:Trong thời gian nghiên cứu sinh từ 2011 đến 2014, tôi sử dụng R là công cụ chính để thực hiện các tính toán cho luận án của mình. Với nội dung nghiên cứu tập trung vào tính toán và mô phỏng xác suất của các sự kiện cực hiếm, R là lựa chọn tối ưu vào thời điểm đó. Trong một vài tính toán mà chưa có thư viện hỗ trợ, chẳng hạn như tính toán với độ chính xác siêu nhỏ, dưới \\(10^{-100}\\), tôi đã sử dụng Python là một giải pháp bổ sung.Trong thời gian nghiên cứu sinh từ 2011 đến 2014, tôi sử dụng R là công cụ chính để thực hiện các tính toán cho luận án của mình. Với nội dung nghiên cứu tập trung vào tính toán và mô phỏng xác suất của các sự kiện cực hiếm, R là lựa chọn tối ưu vào thời điểm đó. Trong một vài tính toán mà chưa có thư viện hỗ trợ, chẳng hạn như tính toán với độ chính xác siêu nhỏ, dưới \\(10^{-100}\\), tôi đã sử dụng Python là một giải pháp bổ sung.Công việc đầu tiên trong môi trường doanh nghiệp của tôi liên quan đến dữ liệu là xây dựng các thuật toán để đầu tư trên thị trường tài chính tại một quỹ đầu tư. Tôi được làm quen với một kho dữ liệu khổng lồ bao gồm dữ liệu hỗ trợ phân tích kỹ thuật, dữ liệu hỗ trợ phân tích cơ bản, và dữ liệu kiểu tin tức liên quan đến tất cả các công cụ tài chính có thể sử dụng để giao dịch, bao gồm cổ phiếu, trái phiếu, hợp đồng tương lai, quyền chọn. Các mô hình trên dữ liệu được chúng tôi - những người nghiên cứu thị trường - xây dựng bằng nhiều phương pháp để tìm ra các chiến lược mang lại lợi nhuận cho quỹ đầu tư. Mặc dù không có cơ hội sử dụng R để phân tích dữ liệu các yêu cầu liên quan đến bảo mật, nhưng tôi lại được học những kỹ năng lập trình C++ mà tôi nhận ra là vô cùng quan trọng cho công việc của mình sau này.Công việc đầu tiên trong môi trường doanh nghiệp của tôi liên quan đến dữ liệu là xây dựng các thuật toán để đầu tư trên thị trường tài chính tại một quỹ đầu tư. Tôi được làm quen với một kho dữ liệu khổng lồ bao gồm dữ liệu hỗ trợ phân tích kỹ thuật, dữ liệu hỗ trợ phân tích cơ bản, và dữ liệu kiểu tin tức liên quan đến tất cả các công cụ tài chính có thể sử dụng để giao dịch, bao gồm cổ phiếu, trái phiếu, hợp đồng tương lai, quyền chọn. Các mô hình trên dữ liệu được chúng tôi - những người nghiên cứu thị trường - xây dựng bằng nhiều phương pháp để tìm ra các chiến lược mang lại lợi nhuận cho quỹ đầu tư. Mặc dù không có cơ hội sử dụng R để phân tích dữ liệu các yêu cầu liên quan đến bảo mật, nhưng tôi lại được học những kỹ năng lập trình C++ mà tôi nhận ra là vô cùng quan trọng cho công việc của mình sau này.Khi bắt đầu công việc như một chuyên gia tính toán, tôi làm việc thường xuyên với dữ liệu trong bảo hiểm. Với những dữ liệu nhỏ, tôi nhận thấy rằng Microsoft Excel kết hợp với lập trình VBA là vừa đủ để xử lý. Khi dữ liệu trở nên ngày càng lớn và phức tạp, Excel và VBA không còn đáp ứng được nhu cầu, đó là lúc tôi quay lại sử dụng R trong công việc của mình. Ngoài sử dụng R như là một công cụ chính để định phí, đánh giá hợp đồng bảo hiểm, tôi còn sử dụng R để thực hiện các công việc liên quan đến dữ liệu như:\nThu thập dữ liệu nhận được từ các phòng ban như tài chính, kế toán, nghiệp vụ, , kiểm tra; làm sạch và cập nhập dữ liệu lên cơ sở dữ liệu để phục vụ tính toán. R cho phép xử lý và tính toán những dữ liệu hàng chục triệu dòng với hiệu quả thực sự đáng kinh ngạc.\nTrích xuất dữ liệu từ cơ sở dữ liệu, biến đổi và tính toán để thực hiện các nghiệp vụ như tái bảo hiểm, quản lý tài sản nợ/có, tính toán báo cáo kinh nghiệm.\nXây dựng các dashboard để cập nhật tình hình bồi thường bảo hiểm y tế với thời gian thực. Thư viện Shiny là công cụ tuyệt vời để tạo ra những dashboard như vậy. \nXây dựng mô hình để phân loại rủi ro, dự báo những chủ hợp đồng, người được bảo hiểm có khả năng cao là trục lợi trong bảo hiểm y tế.\nKhi bắt đầu công việc như một chuyên gia tính toán, tôi làm việc thường xuyên với dữ liệu trong bảo hiểm. Với những dữ liệu nhỏ, tôi nhận thấy rằng Microsoft Excel kết hợp với lập trình VBA là vừa đủ để xử lý. Khi dữ liệu trở nên ngày càng lớn và phức tạp, Excel và VBA không còn đáp ứng được nhu cầu, đó là lúc tôi quay lại sử dụng R trong công việc của mình. Ngoài sử dụng R như là một công cụ chính để định phí, đánh giá hợp đồng bảo hiểm, tôi còn sử dụng R để thực hiện các công việc liên quan đến dữ liệu như:Thu thập dữ liệu nhận được từ các phòng ban như tài chính, kế toán, nghiệp vụ, , kiểm tra; làm sạch và cập nhập dữ liệu lên cơ sở dữ liệu để phục vụ tính toán. R cho phép xử lý và tính toán những dữ liệu hàng chục triệu dòng với hiệu quả thực sự đáng kinh ngạc.Trích xuất dữ liệu từ cơ sở dữ liệu, biến đổi và tính toán để thực hiện các nghiệp vụ như tái bảo hiểm, quản lý tài sản nợ/có, tính toán báo cáo kinh nghiệm.Xây dựng các dashboard để cập nhật tình hình bồi thường bảo hiểm y tế với thời gian thực. Thư viện Shiny là công cụ tuyệt vời để tạo ra những dashboard như vậy. Xây dựng mô hình để phân loại rủi ro, dự báo những chủ hợp đồng, người được bảo hiểm có khả năng cao là trục lợi trong bảo hiểm y tế.Khi tôi quay trở lại với công việc học thuật vào đầu năm 2018, cũng là lúc mà làn sóng về khoa học dữ liệu bắt đầu ảnh hưởng đến đa số các lĩnh vực khác, bao gồm cả ngành khoa học tính toán. Các chứng chỉ về khoa học dữ liệu là điều kiện bắt buộc đối với những người muốn trở thành thành viên của các Hiệp hội chuyên gia tính toán. Tôi cùng với các đồng nghiệp của mình đưa môn học “Phân tích và dự báo” vào trong chương trình đào tạo Định phí bảo hiểm và quản trị rủi ro để cung cấp cho sinh viên các kiến thức và kỹ năng cần thiết khi làm việc với dữ liệu và có thể lấy được chứng chỉ nghề nghiệp của Hiệp hội. Môn học “Phân tích và dự báo” sau đó chính thức được giảng dạy cho sinh viên ngành Toán Kinh tế vào năm 2021 với tên gọi “Khoa học dữ liệu trong Kinh tế và Kinh doanh”. Nội dung của cuốn sách xoay quanh các kiến thức mà tôi đã đang và sẽ giảng dạy cho sinh viên và học viên của mình.Khi tôi quay trở lại với công việc học thuật vào đầu năm 2018, cũng là lúc mà làn sóng về khoa học dữ liệu bắt đầu ảnh hưởng đến đa số các lĩnh vực khác, bao gồm cả ngành khoa học tính toán. Các chứng chỉ về khoa học dữ liệu là điều kiện bắt buộc đối với những người muốn trở thành thành viên của các Hiệp hội chuyên gia tính toán. Tôi cùng với các đồng nghiệp của mình đưa môn học “Phân tích và dự báo” vào trong chương trình đào tạo Định phí bảo hiểm và quản trị rủi ro để cung cấp cho sinh viên các kiến thức và kỹ năng cần thiết khi làm việc với dữ liệu và có thể lấy được chứng chỉ nghề nghiệp của Hiệp hội. Môn học “Phân tích và dự báo” sau đó chính thức được giảng dạy cho sinh viên ngành Toán Kinh tế vào năm 2021 với tên gọi “Khoa học dữ liệu trong Kinh tế và Kinh doanh”. Nội dung của cuốn sách xoay quanh các kiến thức mà tôi đã đang và sẽ giảng dạy cho sinh viên và học viên của mình.","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"ai-nên-đọc-cuốn-sách-này","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.4.2 Ai nên đọc cuốn sách này","text":"Cuốn sách này dành cho bất kỳ bạn đọc nào quan tâm đến việc sử dụng dữ liệu và các phương pháp thống kê hiện đại để giải quyết các vấn đề gặp phải trong học tập và trong công việc hàng ngày. Độc giả có thể là bất kỳ ai, bao gồm các nhà khoa học, kỹ sư, người phân tích dữ liệu, và người nghiên cứu định lượng, hoặc cũng có thể bao gồm những cá nhân với nền tảng có ít tính kỹ thuật hơn như sinh viên, học viên cao học trong các lĩnh vực không định lượng như khoa học xã hội hoặc kinh doanh. Mặc dù không bắt buộc, chúng tôi kỳ vọng rằng bạn đọc đã từng học ít nhất một khóa học cơ bản về xác suất thống kê và một khóa học về lập trình.Mức độ toán học của cuốn sách này là vừa phải và không cần phải có kiến thức chi tiết về các phép toán phức tạp liên quan đến đại số tuyến tính hay giải tích nhiều chiều. Cuốn sách này cung cấp một phần giới thiệu về ngôn ngữ lập trình thống kê R. Việc đã từng tiếp xúc với một ngôn ngữ lập trình, chẳng hạn như C, C++, hoặc Python, sẽ hữu ích cho bạn đọc nhưng không phải là yêu cầu bắt buộc. Cuốn sách này có thể được sử dụng để giảng dạy cho sinh viên thạc sĩ và tiến sĩ trong các lĩnh vực kinh doanh, kinh tế, sinh học, và nhiều lĩnh vực khác của khoa học tự nhiên và xã hội.Cuốn sách đã được sử dụng để giảng dạy cho sinh viên đại học ở mức độ cơ bản như chúng tôi đã đề cập ở trên, nhằm cung cấp cho người học những kiến thức về xây dựng mô hình học máy cao cấp hơn mô hình hồi quy tuyến tính thông thường. Trong mỗi chương sách, chúng tôi luôn cố gắng thêm vào các luận giải về mặt toán học cho các mô hình, với mục đích để các học viên cao học, nghiên cứu sinh khi tham khảo cuốn sách có hiểu biết cặn kẽ hơn. Việc này giúp cho việc giảng dạy khoa học dữ liệu cho người học có thể được tiếp cận từ các khía cạnh khác nhau.","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"các-ký-hiệu-thông-dụng","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.4.3 Các ký hiệu thông dụng","text":"","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"cấu-trúc-của-cuốn-sách","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.4.4 Cấu trúc của cuốn sách","text":"","code":""},{"path":"giới-thiệu-về-cuốn-sách.html","id":"các-dữ-liệu-sử-dụng-trong-cuốn-sách","chapter":"Chương 1 Giới thiệu về cuốn sách","heading":"1.4.5 Các dữ liệu sử dụng trong cuốn sách","text":"","code":"## \n## Attaching package: 'dplyr'## The following objects are masked from 'package:stats':\n## \n##     filter, lag## The following objects are masked from 'package:base':\n## \n##     intersect, setdiff, setequal, union## \n## Attaching package: 'kableExtra'## The following object is masked from 'package:dplyr':\n## \n##     group_rows## \n## Attaching package: 'gridExtra'## The following object is masked from 'package:dplyr':\n## \n##     combine## \n## Attaching package: 'pryr'## The following object is masked from 'package:dplyr':\n## \n##     where## Classes and Methods for R originally developed in the\n## Political Science Computational Laboratory\n## Department of Political Science\n## Stanford University (2002-2015),\n## by and under the direction of Simon Jackman.\n## hurdle and zeroinfl functions by Achim Zeileis."},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"mô-hình-tuyến-tính-tổng-quát.","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"Chương 2 Mô hình tuyến tính tổng quát.","text":"Mô hình tuyến tính tổng quát, Generalized Linear Model hay viết tắt là GLM, là một mô hình được ứng dụng rộng rãi trong các doanh nghiệp, các cơ quan tổ chức hoạt động trong lĩnh vực tài chính, ngân hàng, và bảo hiểm. Các chuyên gia quản trị rủi ro trong các ngân hàng sử dụng mô hình GLM để chấm điểm tín dụng khách hàng và quyết định phê duyệt tín dụng. Các chuyên gia tính toán thường xuyên sử dụng mô hình GLM để xác định phí thuần của các sản phẩm bảo hiểm, để xác định dự phòng nghiệp vụ, hoặc để phân loại rủi ro mà công ty phải đối mặt. Khái niệm GLM lần đầu tiên được sử dụng trong nghiên cứu của Nelder và Wedderburn (1972) và từ đó đến nay đã có nhiều sách tham khảo tin cậy cho mô hình này như Alan Agresti (2015) hay Annette J. Dobson Adrian G. Barnett (2018). Đa số các tài liệu tham khảo giới thiệu GLM dưới góc độ toán học và mang nhiều tính lý thuyết. Chương sách này sẽ cố gắng giải thích và tiếp cận GLM từ một góc nhìn mang tính thực hành nhiều hơn. Chúng tôi sẽ không quá đi sâu vào các khía cạnh như giả thiết hay phương pháp ước lượng của mô hình GLM, mà sẽ tập trung vào hướng dẫn bạn đọc ứng dụng GLM trên nhiều kiểu dữ liệu nhất có thể.Mô hình tuyến tính tổng quát là các mô hình được xây dựng trên các dữ liệu kiểu truyền thống, với biến mục tiêu \\(Y\\) và ma trận biến giải thích \\(\\textbf{X} = \\left(X_1, X_2, \\cdots, X_p\\right)\\). Dữ liệu có \\(n\\) quan sát tương ứng với \\(n\\) dòng của ma trận \\(\\textbf{X}\\). Mô hình tuyến tính tổng quát có thể được sử dụng trong trường hợp có nhiều biến mục tiêu, tuy nhiên trong cuốn sách này chúng tôi chỉ tập trung vào trường hợp có một biến mục tiêu duy nhất.Mô hình tuyến tính tổng quát được phát biểu như sau:Biến mục tiêu \\(Y\\) có hàm phân phối xác suất \\(F_{\\boldsymbol{\\theta}}\\) với tham số là một véc-tơ \\(\\boldsymbol{\\theta}\\).\n\\[\\begin{align}\nY \\sim  F_{\\boldsymbol{\\theta}} \\text{    hay    } \\mathbb{P}(Y \\leq y) =  F_{\\boldsymbol{\\theta}}(y)\n\\end{align}\\]Biến mục tiêu \\(Y\\) có hàm phân phối xác suất \\(F_{\\boldsymbol{\\theta}}\\) với tham số là một véc-tơ \\(\\boldsymbol{\\theta}\\).\n\\[\\begin{align}\nY \\sim  F_{\\boldsymbol{\\theta}} \\text{    hay    } \\mathbb{P}(Y \\leq y) =  F_{\\boldsymbol{\\theta}}(y)\n\\end{align}\\]Giá trị trung bình của biến mục tiêu \\(Y\\) phụ thuộc vào giá trị của biến độc lập. Với điều kiện véc-tơ biến độc lập \\(\\textbf{X} = (X_1, X_2, \\cdots, X_p)\\) nhận giá trị \\(\\textbf{x_i} = (x_{,1}, x_{,2}, \\cdots, x_{,p})\\), giá trị trung bình của biến mục tiêu \\(Y\\) được xác định bằng một hàm số tính trên một tổ hợp tuyến tính của các biến độc lập:\n\\[\\begin{align}\n& \\mathbb{E}(Y|\\textbf{X} = \\textbf{x}_i) = \\mu_i \\\\\n& g(\\mu_i) = \\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p} \\\\\n& \\mu_i = g^{-1}\\left(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p} \\right)\n\\tag{2.1}\n\\end{align}\\]Giá trị trung bình của biến mục tiêu \\(Y\\) phụ thuộc vào giá trị của biến độc lập. Với điều kiện véc-tơ biến độc lập \\(\\textbf{X} = (X_1, X_2, \\cdots, X_p)\\) nhận giá trị \\(\\textbf{x_i} = (x_{,1}, x_{,2}, \\cdots, x_{,p})\\), giá trị trung bình của biến mục tiêu \\(Y\\) được xác định bằng một hàm số tính trên một tổ hợp tuyến tính của các biến độc lập:\n\\[\\begin{align}\n& \\mathbb{E}(Y|\\textbf{X} = \\textbf{x}_i) = \\mu_i \\\\\n& g(\\mu_i) = \\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p} \\\\\n& \\mu_i = g^{-1}\\left(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p} \\right)\n\\tag{2.1}\n\\end{align}\\]Chúng tôi ký hiệu biến ngẫu nhiên có điều kiện \\((Y|\\textbf{X} = \\textbf{x}_i)\\) một cách ngắn gọn là \\(Y_i\\). Phương trình thứ ba trong hệ phương trình (2.1) có nghĩa là giá trị trung bình của biến \\(Y_i\\), ký hiệu \\(\\mu_i\\), được xác định bằng giá trị một hàm số ngược của một hàm số thực \\(g\\), ký hiệu là hàm \\(g^{-1}\\), tính trên một tổ hợp tuyến tính của các giá trị \\((x_{,1}, x_{,2}, \\cdots, x_{,p})\\).Thay vì cố gắng hiểu các khái niệm toán học ở trên, chúng ta hãy thử áp dụng mô hình kể trên trong một trường hợp cụ thể. Chúng ta sẽ xây dựng một mô hình tuyến tính tổng quát mà trong đó biến mục tiêu \\(Y\\) cho biết người mua bảo hiểm xe có hay không lựa chọn các quyền lợi bảo hiểm bổ sung khi ký hợp đồng mua bảo hiểm trách nhiệm dân sự bắt buộc. Dữ liệu được sử dụng có tên là MotoInsurance bao gồm có 6 biến độc lập là:Độ tuổi của người lái xe, biến age, nhận giá trị là các số nguyên dương từ 15 đến 92 tuổi.\nĐộ tuổi của người lái xe, biến age, nhận giá trị là các số nguyên dương từ 15 đến 92 tuổi.Kinh nghiệm lái xe, biến seniority, cho biết số năm kinh nghiệm lái xe, giá trị là các số nguyên từ 2 đến 40 năm.\nKinh nghiệm lái xe, biến seniority, cho biết số năm kinh nghiệm lái xe, giá trị là các số nguyên từ 2 đến 40 năm.Giới tính của người lái xe, biến sex, nhận giá trị 'M' nếu người lái xe là nam giới và 'F' nếu người lái xe là nữ giới.\nGiới tính của người lái xe, biến sex, nhận giá trị 'M' nếu người lái xe là nam giới và 'F' nếu người lái xe là nữ giới.Nơi xe được đăng ký, biến urban, nhận giá trị là 1 nếu xe được đăng ký tại khu vực thành phố và nhận giá trị bằng 0 trong các trường hợp còn lại.\nNơi xe được đăng ký, biến urban, nhận giá trị là 1 nếu xe được đăng ký tại khu vực thành phố và nhận giá trị bằng 0 trong các trường hợp còn lại.Loại hình đăng ký xe, biến private, nhận giá trị là 1 nếu xe mua bảo hiểm là xe đăng ký theo cá nhân và nhận giá trị 0 trong các trường hợp còn lại.\nLoại hình đăng ký xe, biến private, nhận giá trị là 1 nếu xe mua bảo hiểm là xe đăng ký theo cá nhân và nhận giá trị 0 trong các trường hợp còn lại.Tình trạng hôn nhân của người lái xe, biến marital, nhận giá trị 'C' nếu đã kết hôn, 'S' tương ứng với chưa kết hôn, và 'O' tương ứng với đã ly dị.\nTình trạng hôn nhân của người lái xe, biến marital, nhận giá trị 'C' nếu đã kết hôn, 'S' tương ứng với chưa kết hôn, và 'O' tương ứng với đã ly dị.Biến mục tiêu hay biến phụ thuộc là biến \\(Y\\) nhận một trong hai giá trị, 'Yes' nếu người mua bảo hiểm trách nhiệm dân sự đồng ý lựa thêm quyền lợi bảo hiểm bổ sung và '' nếu người mua bảo hiểm trách nhiệm dân sự không lựa chọn mua quyền lợi bổ sung. Để mô hình ở dạng đơn giản nhất có thể, chúng tôi lựa chọn hai biến độc lập để xây dựng mô hình là biến age và biến sex. Chúng ta sẽ sử dụng biến age như một biến kiểu số, trong khi biến sex là một biến kiểu phân loại/rời rạc nhận một trong hai giá trị là 'M' tương ứng với nam giới và 'F' tương ứng với nữ giới.Đoạn lệnh R dưới đây được sử dụng để lấy dữ liệu và phân tích nhanh ảnh hưởng của các biến age và sex lên quyết định mua bảo hiểm bổ sung của người sở hữu xe ô tô.\nHình 2.1: Mối liên hệ giữa các biến giải thích là độ tuổi và giới tính lên biến mục tiêu quyết định mua bảo hiểm bổ sung trong dữ liệu MotoInsurance. Hình bên trái là đồ thị hình hộp cho biến phân phối xác suất của độ tuổi cho nhóm người có mua và không mua. Hình bên phải là đồ thị dạng cột cho biết mối liên hệ giữa giới tính đến quyết định mua bảo hiểm bổ sung\nTừ Hình 2.1 cho thấy cả hai biến age và sex có ảnh hưởng đến quyết định mua bảo hiểm bổ sung. Đồ thị bên trái cho thấy phân phối xác suất của những người có mua bảo hiểm bổ sung thấp hơn, điều này có nghĩa là những người trẻ hơn có xu hướng đồng ý mua bảo hiểm bổ sung hơn. Đồ thị bên phải cho thấy tỷ lệ nữ giới có mua bảo hiểm cao hơn với tỷ lệ nam giới, hay nói cách khác giới tính nữ có khả năng đồng ý mua bảo hiểm bổ sung cao hơn với nam giới.Chúng ta có thể khẳng định mối liên hệ giữa biến age đến biến mục tiêu \\(Y\\) qua phân tích phương sai:Mối liên hệ giữa biến giới tính đến biến mục tiêu được khẳng định qua kiểm định chisq.testChúng ta sẽ xây dựng một mô hình tuyến tính tổng quát để xác nhận lại các phân tích ở trên và lượng hóa được ảnh hưởng của các biến age và sex lên quyết định mua bảo hiểm bổ sung. Các thành phần của mô hình tuyến tính tổng quát mà chúng ta đã đề cập trong phần trên có thể được cụ thể hóa trên dữ liệu MotoInsurance như sauThứ nhất: biến mục tiêu \\(Y\\) chỉ nhận một trong hai giá trị là 'Yes' hoặc '' đó phân phối xác suất cho biến mục tiêu được lựa chọn để xây dựng mô hình là phân phối nhị thức với trung bình là \\(\\rho\\), ký hiệu \\(Y \\sim \\mathcal{B}(\\rho)\\). Giá trị trung bình \\(\\rho\\) phụ thuộc vào các biến giải thích.Thứ nhất: biến mục tiêu \\(Y\\) chỉ nhận một trong hai giá trị là 'Yes' hoặc '' đó phân phối xác suất cho biến mục tiêu được lựa chọn để xây dựng mô hình là phân phối nhị thức với trung bình là \\(\\rho\\), ký hiệu \\(Y \\sim \\mathcal{B}(\\rho)\\). Giá trị trung bình \\(\\rho\\) phụ thuộc vào các biến giải thích.Thứ hai: với mỗi quan sát của các biến giải thích age và sex, giả sử là \\(age_i\\) và \\(sex_i\\), chúng ta có giá trị trung bình của phân phối nhị thức là \\(\\rho_i\\). Đồng thời mối liên hệ giữa giá trị trung bình \\(\\rho_i\\) với các biến giải thích được mô tả thông qua một hàm số được gọi là hàm probit. Hàm probit là một hàm số đơn điệu tăng có miền xác định là khoảng (0,1) và nhận giá trị trên tập các số thực.Thứ hai: với mỗi quan sát của các biến giải thích age và sex, giả sử là \\(age_i\\) và \\(sex_i\\), chúng ta có giá trị trung bình của phân phối nhị thức là \\(\\rho_i\\). Đồng thời mối liên hệ giữa giá trị trung bình \\(\\rho_i\\) với các biến giải thích được mô tả thông qua một hàm số được gọi là hàm probit. Hàm probit là một hàm số đơn điệu tăng có miền xác định là khoảng (0,1) và nhận giá trị trên tập các số thực.\\[\\begin{align}\n& Y_i =  \\left(Y|\\text{age} = \\text{age}_i, \\text{sex} = \\text{sex}_i\\right) \\sim \\mathcal{B}(\\rho_i) \\\\\n& \\mathbb{E}(Y_i) =  \\rho_i \\\\\n& \\text{Probit}\\left(\\rho_i\\right) = \\beta_0 + \\beta_1 \\times \\text{age}_i + \\beta_2 \\times \\text{sex}_i \\\\\n\\tag{2.2}\n\\end{align}\\]Giá trị \\(\\rho_i\\) là vừa là giá trị trung bình, vừa là xác suất mà người \\(\\) có tuổi bằng \\(age_i\\), giới tính \\(sex_i\\), có mua bảo hiểm bổ sung. Hàm probit ở trên là hàm ngược của hàm phân phối xác suất của biến ngẫu nhiên phân phối chuẩn có trung bình 0 và phương sai bằng 1. Hàm số này dùng để kết nối giữa giá trị trung bình \\(\\rho_i\\) với các giá trị tương ứng của biến giải thích \\(age_i\\) và \\(sex_i\\) và còn được gọi là hàm liên kết.Trong mô hình tuyến tính tổng quát được mô tả trong hệ phương trình (2.2) có ba tham số cần được ước lượng từ dữ liệu là \\(\\beta_0\\), \\(\\beta_1\\) và \\(\\beta_2\\). Hàm số dùng để xây dựng và ước lượng mô hình tuyến tính tổng quát trong R là hàm glm() của thư viện stats. Chúng ta ước lượng các hệ số tuyến tính như sau:Có thể thấy rằng các hệ số của biến age và sex đều có ý nghĩa thống kê khi các giá trị p-value đều rất nhỏ. Đúng như chúng nhận định từ phần phân tích khám phá dữ liệu, hệ số tuyến tính của biến age là số âm, bằng -0.016, cho biết người trẻ tuổi hơn có khả năng đồng ý mua bảo hiểm bổ sung cao hơn. Hệ số tương ứng với biến giới tính nam là số âm, bằng -0.447, điều này cho biết khả năng nam giới đồng ý mua bảo hiểm bổ sung là thấp hơn với nữ giới. Các kết luận có thể đưa ra từ kết quả của mô hình tuyến tính tổng quát ở trên như sau:Xác suất mà một người mua thêm bảo hiểm bổ sung giảm nếu tuổi của người tham gia bảo hiểm tăng, điều này có nghĩa là những người trẻ tuổi hơn thường có nhu cầu mua đầy đủ các quyền lợi bảo hiểm hơn những người lớn tuổi.Xác suất mà một người mua thêm bảo hiểm bổ sung giảm nếu tuổi của người tham gia bảo hiểm tăng, điều này có nghĩa là những người trẻ tuổi hơn thường có nhu cầu mua đầy đủ các quyền lợi bảo hiểm hơn những người lớn tuổi.Xác suất mà nam giới mua thêm bảo hiểm bổ sung thấp hơn xác suất mà nữ giới mua thêm bảo hiểm bổ sung.Xác suất mà nam giới mua thêm bảo hiểm bổ sung thấp hơn xác suất mà nữ giới mua thêm bảo hiểm bổ sung.Mối liên hệ giữa xác suất mua bảo hiểm đầy đủ và các thuộc tính của người thứ \\(\\) được mô tả một cách định lượng thông qua phương trìnhMối liên hệ giữa xác suất mua bảo hiểm đầy đủ và các thuộc tính của người thứ \\(\\) được mô tả một cách định lượng thông qua phương trình\\[\\begin{align}\n\\text{Probit}(\\rho_i) = 0.678 - 0.016 \\times \\text{age}_i - 0.447 \\times \\text{sex}_i\n\\tag{2.3}\n\\end{align}\\]trong đó \\(age_i\\) là tuổi của người \\(\\); \\(sex_i\\) là giới tính của người \\(\\), nhận giá trị bằng 1 nếu người đó là nam giới và 0 nếu người đó là nữ giới. Hàm probit được lựa chọn trong công thức ở trên là hàm số ngược của hàm phân phối của biến ngẫu nhiên phân phối chuẩn \\(\\mathcal{N}(0,1)\\) nên có thể viết mối liên hệ giữa \\(\\rho_i\\) và các biến giải thích trong phương trình (2.3) như sau:\n\\[\\begin{align}\n\\rho_i & = \\text{Probit}^{-1}\\left(0.678 - 0.016 \\times \\text{age}_i - 0.447 \\times \\text{sex}_i \\right) \\\\\n& = \\Phi(0.678 - 0.016 \\times \\text{age}_i - 0.447 \\times \\text{sex}_i)\n\\tag{2.4}\n\\end{align}\\]trong đó \\(\\Phi\\) là hàm phân phối xác suất của biến ngẫu nhiên phân phối chuẩn \\(\\mathcal{N}(0,1)\\)\n\\[\\begin{align}\n\\Phi(x) = \\cfrac{1}{\\sqrt{2 \\pi}} \\int\\limits_{-\\infty}^x \\ exp\\left(-t^2/2\\right) \\ dt\n\\tag{2.5}\n\\end{align}\\]Hàm probit được lựa chọn làm hàm liên kết vì miền xác định của hàm số này là khoảng (0,1) phù hợp với việc mô tả xác suất \\(\\rho_i\\) trong khi miền giá trị của hàm số này là tập các số thực phù hợp với tổ hợp tuyến tính của các biến giải thích.Bạn đọc có thể nhận thấy được sự khác biệt giữa mô hình tuyến tính tổng quát ở trên với mô hình tuyến tính thông thường được trình bày trong các chương trước ở hai điểm:Thứ nhất: phân phối xác suất của biến mục tiêu \\(Y\\) là phân phối nhị thức chứ không phải là phân phối chuẩn.Thứ nhất: phân phối xác suất của biến mục tiêu \\(Y\\) là phân phối nhị thức chứ không phải là phân phối chuẩn.Thứ hai: mối liên hệ giữa giá trị trung bình của biến mục tiêu \\(Y\\) và tổ hợp tuyến tính của các biến độc lập được thể hiện thông qua một hàm số, trong trường hợp này là hàm probit. Trong mô hình tuyến tính thông thường, giá trị trung bình của biến mục tiêu bằng tổ hợp tuyến tính của các biến độc lập.Thứ hai: mối liên hệ giữa giá trị trung bình của biến mục tiêu \\(Y\\) và tổ hợp tuyến tính của các biến độc lập được thể hiện thông qua một hàm số, trong trường hợp này là hàm probit. Trong mô hình tuyến tính thông thường, giá trị trung bình của biến mục tiêu bằng tổ hợp tuyến tính của các biến độc lập.Hai điểm nêu trên cũng chính là hai cải tiến quan trọng của mô hình tuyến tính tổng quát với mô hình hồi quy tuyến tính thông thường. Việc tổng quát hóa phân phối của biến phụ thuộc và thiết lập một hàm liên kết giữa giá trị trung bình của biến phụ thuộc và với các biến độc lập giúp cho mô hình tuyến tính tổng quát linh hoạt hơn rất nhiều khi làm việc với các dữ liệu cụ thể và vẫn giữ được khả năng suy diễn giống như mô hình hồi quy tuyến tính thông thường. Trong phần tiếp theo của chương chúng ta sẽ thảo luận kỹ hơn về các vấn đề này.","code":"\ndat<-read.csv(\"../KHDL_KTKD Final/Dataset/MotoInsurance.csv\")\n\n# Đổi các biến Y và sex sang kiểu factor\ndat$Y<-as.factor(dat$Y)\ndat$sex<-as.factor(dat$sex)\n\n# Thực hiện các phân tích khai phá\np1<-dat%>%ggplot()+geom_boxplot(aes(x = Y, y = age, fill = Y), color = \"#640514\", alpha = 0.75)+\n  ggtitle(\"Mối liên hệ giữa age và biến Y\")+ \n  ylab(\"Độ tuổi\") + xlab(\"Quyết định mua bảo hiểm bổ sung\")+\n  theme_minimal() + theme(legend.position = \"none\")\n\np2<-dat%>%ggplot()+geom_bar(aes(x = sex, fill = Y),col = \"#640514\", alpha = 0.75)+\n  ggtitle(\"Mối liên hệ giữa sex và biến Y\")+\n  ylab(\"Số lượng người mua\") + xlab(\"Giới tính\")+\n  theme_minimal()+ guides(fill=guide_legend(title=\"Quyết định mua\"))\n\ngrid.arrange(p1,p2, ncol = 2)\nsummary(aov(age~Y,data = dat))##               Df Sum Sq Mean Sq F value Pr(>F)    \n## Y              1  24354   24354   139.9 <2e-16 ***\n## Residuals   3998 696008     174                   \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nchisq.test(dat$Y, dat$sex)## \n##  Pearson's Chi-squared test with Yates' continuity correction\n## \n## data:  dat$Y and dat$sex\n## X-squared = 130.19, df = 1, p-value < 2.2e-16\n# Biến Y có phân phối nhị thức\n# Hàm g là hàm probit\nglm1<-glm(Y ~ age + sex, data=dat, \n          family = binomial(link = \"probit\")) # khai báo hàm g\nsummary(glm1)## \n## Call:\n## glm(formula = Y ~ age + sex, family = binomial(link = \"probit\"), \n##     data = dat)\n## \n## Coefficients:\n##              Estimate Std. Error z value Pr(>|z|)    \n## (Intercept)  0.678644   0.079138   8.575   <2e-16 ***\n## age         -0.016257   0.001619 -10.041   <2e-16 ***\n## sexM        -0.446783   0.047421  -9.422   <2e-16 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## (Dispersion parameter for binomial family taken to be 1)\n## \n##     Null deviance: 5163.3  on 3999  degrees of freedom\n## Residual deviance: 4933.9  on 3997  degrees of freedom\n## AIC: 4939.9\n## \n## Number of Fisher Scoring iterations: 4"},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"các-nhược-điểm-của-mô-hình-hồi-quy-tuyến-tính.","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.1 Các nhược điểm của mô hình hồi quy tuyến tính.","text":"Mô hình hồi quy tuyến tính là nền tảng quan trọng cho hầu hết các mô hình học máy và các mô hình trí tuệ nhân tạo hiện tại. Trước khi những mô hình học máy được nghiên cứu và phát triển mạnh mẽ như hiện nay, những người xây dựng mô hình luôn gặp khó khăn khi sử dụng mô hình hồi quy tuyến tính trong nhiều hoàn cảnh. Nguyên nhân là giả thiết về phân phối xác suất của biến mục tiêu và miền giá trị trung bình của biến mục tiêu của mô hình hồi quy tuyến tính thông thường là không phù hợp với đa số dữ liệu thực tế.Thật vậy, mô hình hồi quy tuyến tính được thảo luận trong phần trước của cuốn sách có thể được tóm tắt như sau: người xây dựng mô hình cố gắng nghiên cứu mối quan hệ giữa một biến mục tiêu \\(Y\\) với véc-tơ biến độc lập \\(\\textbf{X} = (X_1, X_2, \\cdots, X_p)\\) bằng cách cho rằng mối liên hệ giữa \\(Y\\) và \\(\\textbf{X}\\) là một hàm tuyến tính. Mối liên hệ đó không đồng nhất nên sai số sẽ tồn tại và những người xây dựng mô hình cho rằng sai số có phân phối chuẩn với trung bình bằng 0 và độ lệch chuẩn là một hằng số \\(\\sigma > 0\\). Chúng ta biểu diễn mô hình tuyến tính thông thường như sau:\\[\\begin{align}\n& Y = \\beta_0 + \\beta_1 \\cdot X_1 + \\beta_2 \\cdot X_2 + \\cdots + \\beta_p \\cdot X_p + \\epsilon \\\\\n& \\epsilon \\sim \\mathcal{N}(0, \\sigma^2)\n\\tag{2.6}\n\\end{align}\\]Bạn đọc có thể thấy rằng trong mô hình hồi quy tuyến tính, biến phụ thuộc \\(Y\\) là biến ngẫu nhiên có phân phối chuẩn có phương sai là \\(\\sigma^2\\) và giá trị trung bình phụ thuộc vào véc-tơ biến độc lập \\(\\textbf{X}_i\\). Với điều kiện biến độc lập nhận giá trị là \\(\\textbf{x}_i = (x_{,1}, x_{,2}, \\cdots, x_{,p})\\); chúng ta có mô hình hồi quy tuyến tính như sau:\\[\\begin{align}\n& Y_i \\sim  \\mathcal{N}(\\mu_i, \\sigma^2) \\\\\n& \\mu_i = \\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p}\n\\tag{2.7}\n\\end{align}\\]Ngoài giả thiết về phân phối chuẩn của \\(Y\\), mô hình hồi quy tuyến tính thông thường còn cho rằng giá trị trung bình của biến ngẫu nhiên \\(Y\\) với điều kiện các biến độc lập nhận giá trị \\(\\textbf{x}_i\\), ký hiệu \\(\\mu_i\\), là một tổ hợp tuyến tính của các biến độc lập. Với giả thiết này, mô hình tuyến tính luôn cho rằng miền giá trị của \\(\\mu_i\\) sẽ là toàn bộ tập các số thực \\(\\mathbb{R}\\).Câu hỏi đặt ra là: làm như thế nào để áp dụng mô hình hồi quy tuyến tính trong các trường hợp như sau?Thứ nhất. Biến mục tiêu \\(Y\\) chỉ nhận hai giá trị là 0 hoặc 1. Đây là trường hợp rất thường gặp phải trong nhiều lĩnh vực khi thực hiện phân tích dữ liệu. Có thể kể đến như: khi biến \\(Y\\) đại diện cho sự kiện một người có hay không tham gia bảo hiểm xã hội; một người có hay không thực hiện rút bảo hiểm xã hội một lần trong thời gian một khoảng thời gian; một khách hàng có hay không gửi yêu cầu thanh toán bảo hiểm; hay tương tự như ví dụ trong phần đầu của cuốn sách, một khách hàng đã mua bảo hiểm bắt buộc có hay không mua thêm các quyền lợi bảo hiểm bổ sung. Ngoài lĩnh vực bảo hiểm, biến mục tiêu \\(Y\\) chỉ nhận giá trị 0 hoặc 1 còn xuất hiện trong lĩnh vực ngân hàng-tài chính như: biến \\(Y\\) cho biết một giao dịch trực tuyến có phải là một giao dịch gian lận hay không; một khách hàng có hay không tiếp nhận sản phẩm dịch vụ tài chính; một khách hàng có hay không hoàn trả khoản nợ thẻ tín dụng trong thời gian tới; … Trong tất cả các trường hợp kể trên không thể giả thiết phân phối xác suất của biến mục tiêu là phân phối chuẩn. Hơn thế nữa, giá trị trung bình của biến mục tiêu sẽ luôn nằm trong khoảng 0 đến 1, chứ không phải toàn bộ tập số thực. Nếu sử dụng một tổ hợp tuyến tính của các biến độc lập để tính toán giá trị trung bình của biến mục tiêu, chúng ta sẽ có thể gặp các giá trị nhỏ hơn 0 hoặc các giá trị lớn hơn 1.Biến mục tiêu \\(Y\\) là biến dạng rời rạc có thứ tự. Chẳng hạn như \\(Y\\) cho biết một người tham gia bảo hiểm xã hội gửi yêu cầu bồi thường bao nhiêu lần trong một năm; biến \\(Y\\) cho biết một khách hàng mua bảo hiểm xe ô tô gây ra bao nhiêu tai nạn trong thời gian được bảo hiểm,… Trong trường hợp này, \\(Y\\) sẽ nhận giá trị kiểu số đếm: \\(0, 1, 2, \\cdots\\) tương ứng với số lần khách hàng gửi yêu cầu bảo hiểm. Không thể sử dụng mô hình hồi quy tuyến tính thông thường với giả thiết biến \\(Y\\) phân phối chuẩn trên các quan sát là các giá trị số đếm. Đồng thời, giá trị trung bình của \\(Y\\) là một số lớn hơn 0 chỉ là một tập hợp con của tập các số thực.Biến mục tiêu \\(Y\\) là biến dạng rời rạc có thứ tự. Chẳng hạn như \\(Y\\) cho biết một người tham gia bảo hiểm xã hội gửi yêu cầu bồi thường bao nhiêu lần trong một năm; biến \\(Y\\) cho biết một khách hàng mua bảo hiểm xe ô tô gây ra bao nhiêu tai nạn trong thời gian được bảo hiểm,… Trong trường hợp này, \\(Y\\) sẽ nhận giá trị kiểu số đếm: \\(0, 1, 2, \\cdots\\) tương ứng với số lần khách hàng gửi yêu cầu bảo hiểm. Không thể sử dụng mô hình hồi quy tuyến tính thông thường với giả thiết biến \\(Y\\) phân phối chuẩn trên các quan sát là các giá trị số đếm. Đồng thời, giá trị trung bình của \\(Y\\) là một số lớn hơn 0 chỉ là một tập hợp con của tập các số thực.Ngay cả khi trong các trường hợp biến phụ thuộc \\(Y\\) là biến liên tục, sử dụng mô hình tuyến tính thông thường cũng sẽ gặp phải vấn đề. Chẳng hạn như khi \\(Y\\) là số tiền khách hàng yêu cầu bồi thường cho xe ô tô trong trường hợp xảy ra tai nạn. Biến \\(Y\\) chỉ nhận giá trị là số dương và thường có phân phối xác suất lệch phải với đuôi dài. Sử dụng giả thiết phân phối chuẩn cho biến \\(Y\\) sẽ làm cho mô hình không đánh giá đúng khả mức độ nghiêm trọng của yêu cầu bồi thường phân phối chuẩn không có khả năng mô tả các rủi ro có đuôi dài. Đồng thời, giá trị trung bình của số tiền yêu cầu bồi thường luôn là số dương, đó cũng không thể sử dụng tổ hợp tuyến tính của các biến độc lập để trực tiếp mô tả.Ngay cả khi trong các trường hợp biến phụ thuộc \\(Y\\) là biến liên tục, sử dụng mô hình tuyến tính thông thường cũng sẽ gặp phải vấn đề. Chẳng hạn như khi \\(Y\\) là số tiền khách hàng yêu cầu bồi thường cho xe ô tô trong trường hợp xảy ra tai nạn. Biến \\(Y\\) chỉ nhận giá trị là số dương và thường có phân phối xác suất lệch phải với đuôi dài. Sử dụng giả thiết phân phối chuẩn cho biến \\(Y\\) sẽ làm cho mô hình không đánh giá đúng khả mức độ nghiêm trọng của yêu cầu bồi thường phân phối chuẩn không có khả năng mô tả các rủi ro có đuôi dài. Đồng thời, giá trị trung bình của số tiền yêu cầu bồi thường luôn là số dương, đó cũng không thể sử dụng tổ hợp tuyến tính của các biến độc lập để trực tiếp mô tả.Có thể tổng kết rằng hai vấn đề thường gặp phải khi sử dụng mô hình hồi quy tuyến tính thông thường trên dữ liệu thực tế làThứ nhất: sự không phù hợp của giả thiết phân phối chuẩn đối với biến mục tiêu \\(Y\\); vàThứ nhất: sự không phù hợp của giả thiết phân phối chuẩn đối với biến mục tiêu \\(Y\\); vàThứ hai: miền giá trị trung bình của biến mục tiêu \\(Y\\) không phù hợp với miền giá trị của tổ hợp tuyến tính của biến độc lập. Giá trị \\(\\beta_0 + \\beta_1 \\ x_{,1} + \\beta_2 \\ x_{,2} + \\cdots + \\beta_p \\ x_{,p}\\) có thể nhận bất kỳ giá trị nào trong tập các số thực \\(\\mathbb{R}\\), trong khi giá trị trung bình của biến mục tiêu \\(Y\\) trong các dữ liệu thực tế lại thường chỉ là một tập con của \\(\\mathbb{R}\\).Thứ hai: miền giá trị trung bình của biến mục tiêu \\(Y\\) không phù hợp với miền giá trị của tổ hợp tuyến tính của biến độc lập. Giá trị \\(\\beta_0 + \\beta_1 \\ x_{,1} + \\beta_2 \\ x_{,2} + \\cdots + \\beta_p \\ x_{,p}\\) có thể nhận bất kỳ giá trị nào trong tập các số thực \\(\\mathbb{R}\\), trong khi giá trị trung bình của biến mục tiêu \\(Y\\) trong các dữ liệu thực tế lại thường chỉ là một tập con của \\(\\mathbb{R}\\).Mô hình tuyến tính tổng quát được xây dựng trên cơ sở của mô hình hồi quy tuyến tính thông thường với mục đích khắc phục hai nhược điểm kể trên:Trước hết, mô hình tuyến tính tổng quát giả thiết một phân phối phù hợp cho biến phụ thuộc \\(Y\\), tùy vào dữ liệu sử dụng để phân tích, tạm gọi là phân phối \\(F\\) với tham số \\(\\boldsymbol{\\theta}\\), ký hiệu là \\(F_\\boldsymbol{\\theta}\\).Tiếp theo, để đảm bảo miền giá trị của giá trị trung bình của \\(Y\\) với điều kiện biến độc lập bằng \\(\\textbf{x}_i\\), \\(\\mu_i = E(Y|\\textbf{X} = \\textbf{x}_i)\\), phù hợp với miền giá trị của \\(\\textbf{x}_i^{'} \\boldsymbol{\\beta}\\), mô hình tuyển tính tổng quát sử dụng một hàm số đơn điệu \\(g\\), được gọi là hàm liên kết, để biến đổi miền giá trị của \\(\\mu_i\\). Chúng ta phát biểu mô hình tuyến tính tổng quát như sau\\[\\begin{align}\n& Y \\sim  F_\\theta \\\\\n& \\mathbb{E}(Y|\\textbf{X} = \\textbf{x}_i) = \\mu_i \\\\\n& g(\\mu_i) = \\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p}\n\\tag{2.8}\n\\end{align}\\]Trước hết, có thể thấy rằng mô hình hồi quy tuyến tính thông thường là trường hợp đặc biệt của mô hình tuyến tính tổng quát khi phân phối \\(F\\) là phân phối chuẩn; tham số \\(\\boldsymbol{\\theta}\\) là \\(\\sigma^2\\); và hàm \\(g\\) là hàm số đồng nhất \\(g(x) = x\\).Giả thiết đơn điệu của hàm liên kết \\(g\\) đảm bảo sự tồn tại của hàm số ngược \\(g^{-1}\\). Mối liên hệ của \\(\\mu_i\\) và \\(\\textbf{x}_i^{'} \\boldsymbol{\\beta}\\) có thể được viết lại dưới dạng hàm ngược của hàm liên kết như sau\n\\[\\begin{align}\n\\mu_i = g^{-1}\\left(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p}\\right)\n\\tag{2.9}\n\\end{align}\\]Quay trở lại ví dụ ở phần trước của chương sách, chúng ta phân tích về tác động của độ tuổi và giới tính lên quyết định có tham gia quyền lợi bảo hiểm bổ sung hay không. Mô hình tuyến tính tổng quát được xây dựng như sau:\\[\\begin{align}\n& Y \\sim  \\mathcal{B}(\\rho) \\\\\n& \\mathbb{E}(Y|\\text{age}_i, \\text{sex}_i) = \\rho_i \\\\\n& \\Phi^{-1}(\\rho_i) = 0.678 - 0.016 \\times \\text{age}_i - 0.446 \\times \\text{sex}_i \\\\\n& \\rho_i = \\Phi\\left(0.678 - 0.016 \\times \\text{age}_i - 0.446 \\times \\text{sex}_i\\right)\n\\end{align}\\]Phân phối xác suất của biến \\(Y\\) là phân phối nhị thức \\(Y\\) chỉ có thể nhận là 0 hoặc 1. Đồng thời, giá trị trung bình của \\(Y\\) nằm trong khoảng \\((0,1)\\) chúng ta có thể chọn hàm liên kết \\(g\\) là hàm \\(\\Phi^{-1}\\). Nếu không lựa chọn \\(\\Phi^{-1}\\) làm hàm liên kết, mọi hàm số đơn điệu, có miền xác định là khoảng \\((0,1)\\), và miền giá trị là tập số thực \\(\\mathbb{R}\\) đều có thể được lựa chọn thay thế.","code":""},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"xây-dựng-mô-hình-tuyến-tính-tổng-quát","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.2 Xây dựng mô hình tuyến tính tổng quát","text":"Trong phần này của cuốn sách, chúng ta sẽ thảo luận về cách xây dựng mô hình tuyến tổng quát với các kiểu giá trị khác nhau của biến phụ thuộc \\(Y\\). Xin nhắc lại rằng đây là cuốn sách dành cho cả các bạn đọc không có nền tảng toán học nâng cao. đó, những thảo luận phức tạp liên quan đến các giả thiết của mô hình hay phương pháp ước lượng tham số sẽ được trình bày ở phần sau của chương sách. Chúng ta sẽ hiểu về mô hình tuyến tính tổng quát thông qua việc ứng dụng mô hình cho các các dữ liệu thực tế trước khi đi sâu vào bản chất toán học của mô hình.","code":""},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"biến-phụ-thuộc-là-biến-dạng-nhị-phân.","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.2.1 Biến phụ thuộc là biến dạng nhị phân.","text":"Đây là các trường hợp mà biến phụ thuộc chỉ nhận một trong hai giá trị. Trong phần trước chúng ta đã nêu một số ví dụ cho trường hợp này: khách hàng có hay không hoàn trả nợ thẻ tín dụng, khách hàng phản hồi tích cực hay tiêu cực về sản phầm, một yêu cầu bồi thường bảo hiểm là trục lợi hay bình thường, một giao dịch rút tiền ngân hàng có hay không phải là giao dịch gian lận, … Mặc dù đây chỉ là một trường hợp đặc biệt của biến phụ thuộc nhận giá trị rời rạc nhưng qua các ví dụ thực tế lại thấy rằng phần lớn các dữ liệu gặp phải lại có biến phụ thuộc ở dạng nhị phân. Khi \\(Y\\) chỉ nhận hai giá trị, chúng ta sẽ luôn mã hóa giá trị của \\(Y\\) thành hai số là 0 và 1. Một vài cuốn sách khác, hoặc trong một vài lĩnh vực nghiên cứu khác, người xây dựng mô hình có thể mã hóa \\(Y\\) thành -1 và 1. Tuy nhiên hai cách mã hóa này chỉ khác nhau ở hình thức chứ không làm ảnh hưởng đến kết quả của mô hình.","code":""},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"phân-phối-xác-suất-của-biến-phụ-thuộc.","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.2.1.1 Phân phối xác suất của biến phụ thuộc.","text":"Khi biến phụ thuộc là biến dạng nhị phân, một cách tự nhiên, chúng ta sẽ sử dụng phân phối nhị thức để mô tả biến phụ thuộc. Biến ngẫu nhiên \\(B\\) có phân phối nhị thức với tham số \\(\\rho\\), \\(0 < \\rho < 1\\), ký hiệu \\(\\mathcal{B}(\\rho)\\), là biến ngẫu nhiên chỉ nhận hai giá trị là 0 và 1 với hàm khối lượng xác suất như sau\\[\\begin{align}\n\\mathbb{P}(B = x) = \\rho^x \\times (1-\\rho)^{(1-x)} \\text{ với } x \\\\{0;1\\}\n\\tag{2.10}\n\\end{align}\\]Chúng ta có giá trị trung bình và phương sai của \\(\\mathcal{B}(\\rho)\\).\n\\[\\begin{align}\n& \\mathbb{E}(B) = \\rho \\\\\n& \\mathbb{V}(B) = \\rho \\ (1-\\rho)\n\\tag{2.11}\n\\end{align}\\]Có thể thấy rằng phân phối nhị thức có duy nhất một tham số \\(\\rho\\) và tham số này cũng chính là giá trị trung bình của biến đó. Phương sai của \\(\\mathcal{B}(\\rho)\\) nhỏ hơn giá trị trung bình.","code":""},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"lựa-chọn-hàm-liên-kết.","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.2.1.2 Lựa chọn hàm liên kết.","text":"Khi biến phụ thuộc \\(Y\\) có phân phối nhị thức, giá trị trung bình của biến phụ thuộc sẽ nằm trong khoảng \\((0,1)\\). Từ công thức (2.8), nếu cho \\(\\rho_i\\) là giá trị trung bình của biến phụ thuộc với điều kiện các biến độc lập \\(\\textbf{X} = \\textbf{x}_i\\), ta có\\[\\begin{align}\n& \\mathbb{E}(Y|\\textbf{X} = \\textbf{x}_i) = \\rho_i \\\\\n& g(\\rho_i) = \\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p}\n\\tag{2.12}\n\\end{align}\\]Như vậy, mọi hàm số đơn điệu có miền xác định là khoảng \\((0,1)\\) và miền giá trị là tập số thực \\(\\mathbb{R}\\) đều có thể được lựa chọn để làm hàm ngược của hàm liên kết. Làm thế nào để có được những hàm số có tính chất như vậy? Chúng ta đều biết rằng các hàm phân phối xác suất của một biến ngẫu nhiên liên tục bất kỳ là các hàm số đơn điệu tăng, có miền xác định là \\(\\mathbb{R}\\) và miền giá trị là khoảng \\((0,1)\\). đó, hàm số ngược của các hàm phân phối xác suất, sẽ là các hàm số tăng, có miền xác định là khoảng \\((0,1)\\) và miền giá trị là \\(\\mathbb{R}\\). Nói một cách khác, hàm số ngược của các hàm phân phối xác suất liên tục bất kỳ thỏa mãn đầy đủ tính chất của hàm liên kết trong trường hợp \\(Y\\) có phân phối nhị thức.Trong thực tế, việc lựa chọn hàm liên kết còn có mục tiêu là để mô hình dễ giải thích và quá trình ước lượng mô hình đơn giản nhất có thể. Các hàm phân phối xác suất thường được lựa chọn làm hàm ngược của hàm liên kết bao gồm:Hàm phân phối của biến ngẫu nhiên logistic;\nHàm phân phối của biến ngẫu nhiên logistic;Hàm phân phối của biến ngẫu nhiên phân phối chuẩn;\nHàm phân phối của biến ngẫu nhiên phân phối chuẩn;Hàm phân phối của biến ngẫu nhiên Cauchy.\nHàm phân phối của biến ngẫu nhiên Cauchy.Hàm phân phối của biến ngẫu nhiên logistic và hàm ngược được cho bởi công thức sau\n\\[\\begin{align}\n& \\text{Hàm phân phối xác suất: } \\ g^{-1}(x) = \\cfrac{1}{1 + e^{-x}} \\\\\n& \\text{Hàm ngược: } \\ g(x) = ln(\\cfrac{x}{1- x})\n\\end{align}\\]Với biến phụ thuộc \\(Y\\) là có phân phối nhị thức và hàm \\(g\\) là hàm số ngược của hàm phân phối của biến ngẫu nhiên logistic, chúng ta có mô hình tuyến tính tổng quát như sau:\\[\\begin{align}\n& Y_i \\sim \\mathcal{B}(\\rho_i) \\\\\n& \\rho_i = \\cfrac{1}{1 + e^{-(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p})}} \\\\\n& ln(\\cfrac{\\rho_i}{1 - \\rho_i}) = \\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p}\n\\tag{2.13}\n\\end{align}\\]Mô hình (2.13) được biết đến rộng rãi trong học thuật và ứng dụng với tên gọi là hồi quy logistic và cũng là mô hình thường được sử dụng nhất trong khi biến phụ thuộc là biến nhị phân. Mô hình có ưu điểm là sự dễ hiểu khi diễn giải kết quả:\\(\\rho_i\\) ngoài ý nghĩa là trung bình của biến ngẫu nhiên \\(Y_i\\), còn có ý nghĩa là xác suất xảy ra sự kiện \\(Y_i = 1\\).\\(\\rho_i\\) ngoài ý nghĩa là trung bình của biến ngẫu nhiên \\(Y_i\\), còn có ý nghĩa là xác suất xảy ra sự kiện \\(Y_i = 1\\).Giá trị \\(\\cfrac{\\rho_i}{1 - \\rho_i}\\) được gọi là odds của sự kiện \\(Y_i = 1\\). Mối liên hệ giữa quan sát thứ \\(\\) của biến độc lập \\(X_j\\) là \\(x_{,j}\\) và obbs của sự kiện \\(Y_i = 1\\) có thể được diễn giải trực tiếp qua hệ số \\(\\beta_j\\).Giá trị \\(\\cfrac{\\rho_i}{1 - \\rho_i}\\) được gọi là odds của sự kiện \\(Y_i = 1\\). Mối liên hệ giữa quan sát thứ \\(\\) của biến độc lập \\(X_j\\) là \\(x_{,j}\\) và obbs của sự kiện \\(Y_i = 1\\) có thể được diễn giải trực tiếp qua hệ số \\(\\beta_j\\).Hàm phân phối của biến ngẫu nhiên chuẩn \\(\\mathcal{N}(0,1)\\) và hàm ngược của hàm phân phối được cho bởi công thức sau\n\\[\\begin{align}\n& g^{-1}(x) = \\Phi(x) \\\\\n& g(x) = \\Phi^{-1}(x) \\\\\n& \\Phi(x) = \\cfrac{1}{\\sqrt{2 \\pi}} \\  \\int\\limits_{-\\infty}^x \\ exp(-t^2/2) \\ dt  \\\\\n\\end{align}\\]Chúng ta có mô hình tuyến tính tổng quát như sau\\[\\begin{align}\n& Y_i \\sim \\mathcal{B}(\\rho_i) \\\\\n& \\rho_i = \\Phi(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p}) \\\\\n& \\Phi^{-1}(\\rho_i) = \\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p}\n\\tag{2.14}\n\\end{align}\\]Hàm số ngược của biến ngẫu nhiên phân phối chuẩn được gọi là hàm probit đó mô hình tuyến tính tổng quát trong trường hợp này còn được biết đến với tên gọi là mô hình probit.Hàm phân phối của biến ngẫu nhiên Cauchy và hàm ngược của hàm phân phối được cho bởi công thức sau\n\\[\\begin{align}\n& g^{-1}(x) = 0.5 + \\cfrac{\\text{arctan}(x)}{\\pi} \\\\\n& g(x) = \\text{tan}\\left( \\pi \\left( x - 0.5 \\right) \\right)\n\\tag{2.15}\n\\end{align}\\]Chúng ta có mô hình tuyến tính tổng quát như sau\\[\\begin{align}\n& Y_i \\sim \\mathcal{B}(\\rho_i) \\\\\n& p_i = 0.5+ \\cfrac{\\text{arctan}(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p})}{\\pi}  \\\\\n& \\text{tan}\\left( \\pi \\left( \\rho_i - 0.5 \\right) \\right) = \\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p}\n\\tag{2.16}\n\\end{align}\\]Hàm số ngược của phân phối cauchy còn được gọi là hàm cauchit, đó mô hình tuyến tính tổng quát trong trường hợp này còn được biết đến với tên là mô hình cauchit.Hình 2.2 mô tả hình dạng của ba phân phối xác suất và ba hàm liên kết là các hàm ngược của hàm phân phối xác suất\nHình 2.2: Các hàm phân phối xác suất thường được sử dụng làm hàm ngược của hàm liên kết khi biến phụ thuộc có phân phối nhị thức. Hình bên trái: các hàm phân phối xác suất. Hình bên phải: các hàm liên kết\nMô hình tuyến tính tổng quát trong trường hợp \\(Y\\) là biến nhị phân có các tham số là các hệ số tuyến tính \\(\\beta_0\\), \\(\\beta_1\\), \\(\\cdots\\), \\(\\beta_p\\). Các tham số này được ước lượng từ dữ liệu bằng phương pháp tối đa hóa hàm hợp lý, hay gọi tắt là phương pháp MLE. Chúng tôi sẽ trình bày phần ước lượng mô hình trong phần sau của chương sách để tránh nhắc đến các khái niệm toán học phức tạp.Hàm số glm() của thư viện stats được sử dụng để xây dựng mô hình tuyến tính tổng quát. Tham số family trong hàm glm() dùng để khai báo phân phối xác suất cho biến phụ thuộc \\(Y\\) và để lựa chọn hàm liên kết phù hợp. Trở lại với ví dụ khi \\(Y\\) là biến nhị phân mô tả khách hàng có hay không lựa chọn các quyền lợi đầy đủ khi tham gia bảo hiểm bổ sung, chúng ra thực hiện xây dựng mô hình như sauCả ba mô hình tuyến tính tổng quát ở trên đều cho \\(Y\\) là một biến ngẫu nhiên phân phối nhị thức, nhưng mối liên hệ giữa độ tuổi và giới tính đến giá trị trung bình của \\(Y\\) lại được mô tả bằng các công thức khác nhau. Từ kết quả ước lượng các mô hình, chúng ta cóTrong mô hình logistic:\n\\[\\begin{align}\n\\mathbb{P}(Y_i = 1| \\text{age}_i, \\text{sex}_i) = \\cfrac{1}{1 + exp(-(1.109 - 0.026 \\times \\text{age}_i - 0.723 \\times \\text{sex}_i))}\n\\end{align}\\]Trong mô hình logistic:\n\\[\\begin{align}\n\\mathbb{P}(Y_i = 1| \\text{age}_i, \\text{sex}_i) = \\cfrac{1}{1 + exp(-(1.109 - 0.026 \\times \\text{age}_i - 0.723 \\times \\text{sex}_i))}\n\\end{align}\\]Trong mô hình probit:\n\\[\\begin{align}\n\\mathbb{P}(Y_i = 1| \\text{age}_i, \\text{sex}_i) = \\Phi\\left(0.678 - 0.016 \\times \\text{age}_i - 0.446 \\times \\text{sex}_i\\right)\n\\end{align}\\]Trong mô hình probit:\n\\[\\begin{align}\n\\mathbb{P}(Y_i = 1| \\text{age}_i, \\text{sex}_i) = \\Phi\\left(0.678 - 0.016 \\times \\text{age}_i - 0.446 \\times \\text{sex}_i\\right)\n\\end{align}\\]Trong mô hình cauchit:\n\\[\\begin{align}\n\\mathbb{P}(Y_i = 1| \\text{age}_i, \\text{sex}_i) = \\cfrac{1}{2} + \\cfrac{\\text{arctan}\\left(0.997 - 0.024 \\times \\text{age}_i - 0.624 \\times \\text{sex}_i\\right)} {\\pi}\n\\end{align}\\]Trong mô hình cauchit:\n\\[\\begin{align}\n\\mathbb{P}(Y_i = 1| \\text{age}_i, \\text{sex}_i) = \\cfrac{1}{2} + \\cfrac{\\text{arctan}\\left(0.997 - 0.024 \\times \\text{age}_i - 0.624 \\times \\text{sex}_i\\right)} {\\pi}\n\\end{align}\\]Cả ba mô hình đều cho cùng một kết quả: người có độ tuổi càng cao thì càng ít có khả năng lựa chọn quyền lợi bảo hiểm bổ sung và xác suất nam giới lựa chọn quyền lợi bảo hiểm bổ sung là ít hơn với nữ giới. Bảng 2.1 tổng hợp kết quả là xác suất chấp nhận mua thêm quyền lợi bảo hiểm bổ sung theo ba mô hình với hai biến độc lập là độ tuổi và giới tính:\nBảng 2.1: Xác suất người bảo hiểm lựa chọn quyền lợi bổ sung tính toán dựa trên mô hình GLM với hai biến giải thích là độ tuổi và giới tính. Các hàm liên kết được lựa chọn bao gồm hàm logit, hàm probit và hàm cauchit\nTừ Bảng 2.1 có thể thấy rằng không có sự khác biệt lớn trong tính toán xác suất của \\(Y\\) khi sử dụng hàm liên kết khác nhau. Thực tế cho thấy việc lựa chọn hàm liên kết sẽ không ảnh hưởng lớn đến kết quả của mô hình. Các lựa chọn quan trọng hơn trong mô hình tuyến tính bao gồm lựa chọn phân phối cho biến phụ thuộc và lựa chọn biến độc lập để đưa vào trong mô hình.","code":"\n# Phân phối Y là nhị thức và hàm liên kết là hàm logit\nglm.binomial.logit<-glm(Y ~ age + sex, data=dat, \n          family = binomial(link = \"logit\"))\n\n# Phân phối Y là nhị thức và hàm liên kết là hàm probit\nglm.binomial.probit<-glm(Y ~ age + sex, data=dat, \n          family = binomial(link = \"probit\"))\n\n# Phân phối Y là nhị thức và hàm liên kết là hàm cauchit\nglm.binomial.cauchy<-glm(Y ~ age + sex, data=dat, \n          family = binomial(link = \"cauchit\"))"},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"biến-phụ-thuộc-là-biến-rời-rạc-không-có-thứ-tự.","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.2.2 Biến phụ thuộc là biến rời rạc không có thứ tự.","text":"Biến rời rạc không có thứ tự, hay còn gọi là biến rời rạc danh nghĩa (non-ordinal variable), là biến ngẫu nhiên mà các giá trị có thể nhận không có ý nghĩa sánh với nhau. Khi nói đến biến rời rạc không có thứ tự, chúng ta luôn hiểu rằng biến nhận từ ba giá trị trở lên bởi vì trường hợp biến mục tiêu chỉ có hai giá trị sẽ được xử lý như biến phân phối nhị phân. Một ví dụ đơn giản cho biến rời rạc không có thứ tự là màu sắc được chọn khi mua xe ô tô, hoặc loại hình bảo hiểm được lựa chọn bởi các khách hàng của một công ty bảo hiểm.Giả sử biến rời rạc danh nghĩa \\(Y\\) có thể nhận \\(J\\) giá trị khác nhau lần lượt là \\(1, 2, \\cdots, J\\). Với biến danh nghĩa, chúng ta khó có thể mô tả được mối liên hệ giữa xác suất của hai sự kiện \\((Y=)\\) và \\((Y=j)\\) với \\(1 \\leq < j \\leq J\\) dưới dạng tham số. Chính vì thế cấu trúc dạng tham số của mô hình tuyến tính tổng quát như phương trình (2.1) là khó áp dụng trong trường hợp này.Một phương pháp tiếp cận cho trường hợp biến mục tiêu \\(Y\\) là biến rời rạc danh nghĩa là mở rộng mô hình tuyến tính tổng quát với biến nhị phân: với mỗi \\(j \\{1,2,\\cdots,J}\\), xác suất biến mục tiêu nhận giá trị bằng \\(j\\) với điều kiện các biến độc lập nhận giá trị \\(\\textbf{x}_i\\) được mô tả dưới dạng tham số như sau:\n\\[\\begin{align}\n\\mathbb{P}\\left(Y = j\\right|\\textbf{x}_i) = \\cfrac{h(\\beta_{j,0} + \\beta_{j,1} \\cdot x_{,1} + \\cdots + \\beta_{j,p} \\cdot x_{,p} ) }{ \\sum\\limits_{j=1}^J h(\\beta_{j,0} + \\beta_{j,1} \\cdot x_{,1} + \\cdots + \\beta_{j,p} \\cdot x_{,p} ) }\n\\tag{2.17}\n\\end{align}\\]với hàm số \\(h\\) có miền xác định là tập số thực \\(\\mathbb{R}\\) và miền giá trị là tập các số thực dương \\(\\mathbb{R}^+\\). Cũng giống như khi lựa chọn hàm liên kết, việc lựa chọn hàm số \\(h\\) thường thường được lựa chọn sao cho quá trình ước lượng các hệ số tuyến tính không quá phức tạp. đó, hàm lũy thừa cơ số tự nhiên exp() thường được lựa chọn. Trong trường hợp này, hàm số xác định xác suất xảy ra các sự kiện \\((Y=j)\\) trong phương trình (2.17) được gọi là hàm Softmax:\n\\[\\begin{align}\n\\text{softmax}(\\textbf{z})  & = \\left(\\cfrac{e^{z_1}}{\\sum\\limits_{j=1}^p e^{z_j}}, \\cfrac{e^{z_2}}{\\sum\\limits_{j=1}^p e^{z_1}}, \\cdots, \\cfrac{e^{z_p}}{\\sum\\limits_{=1}^p e^{z_j}}  \\right) \\\\\n\\textbf{z} & = (z_1, z_2, \\cdots, z_p)\n\\end{align}\\]Các tham số \\(\\beta_{j,k}\\) được ước lượng để tối thiểu hóa hàm cross-entropy:\n\\[\\begin{align}\n\\sum\\limits_{=1}^n \\sum\\limits_{j=1}^J y_{,j} \\cdot \\log\\left(\\mathbb{P}\\left(Y = j|\\textbf{x}_i\\right)\\right)\n\\end{align}\\]trong đó \\(\\mathbb{P}\\left(Y = j|\\textbf{x}_i\\right)\\) được tính toán từ công thức (2.17) và \\(y_{,j}\\) nhận một trong hai giá trị:là 1 nếu giá trị quan sát thứ \\(\\) của biến mục tiêu \\(Y\\) bằng \\(j\\)là 0 nếu giá trị quan sát thứ \\(\\) của biến mục tiêu \\(Y\\) khác \\(j\\)Lưu ý rằng có \\(J\\) véc-tơ hệ số tuyến tính trong phương trình (2.17). Trong thực tế, khi biến mục tiêu \\(Y\\) có thể nhận \\(J\\) giá trị danh nghĩa, chúng ta xây dựng mô hình với \\((J-1)\\) véc-tơ hệ số tuyến tính tương ứng với các giá trị danh nghĩa \\(1, 2, \\cdots, (J-1)\\), đồng thời cố định giá trị của tất cả các hệ số tuyến tính bằng 0 với giá trị danh nghĩa \\(J\\). Khi tất cả các hệ số tuyến tính bằng 0, chúng ta có \\(exp(\\textbf{x}_i^{'} \\boldsymbol{\\beta}_j) = exp(0) = 1\\) với mọi \\(\\textbf{x}_i\\). Phương trình (2.17) được viết lại như sau:\\[\\begin{align}\n& \\mathbb{P}\\left(Y = j\\right|x_i) = \\cfrac{h(\\beta_{j,0} + \\beta_{j,1} \\cdot x_{,1} + \\cdots + \\beta_{j,p} \\cdot x_{,p} ) }{1 + \\sum\\limits_{j=1}^{J-1} h(\\beta_{j,0} + \\beta_{j,1} \\cdot x_{,1} + \\cdots + \\beta_{j,p} \\cdot x_{,p} )} \\textit{ với } j < J \\\\\n& \\mathbb{P}\\left(Y = J\\right|x_i) = \\cfrac{1}{1 + \\sum\\limits_{j=1}^{J-1} h(\\beta_{j,0} + \\beta_{j,1} \\cdot x_{,1} + \\cdots + \\beta_{j,p} \\cdot x_{,p} )} \\\\\n\\tag{2.18}\n\\end{align}\\]Để minh họa cho xây dựng mô hình tuyến tính tổng quát trong trường hợp \\(Y\\) là biến rời rạc danh nghĩa, chúng ta sẽ xây dựng mô hình phân loại trên dữ liệu Travel_Insurance. Đây là dữ liệu cung cấp thông tin về các sản phẩm bảo hiểm du lịch từ một đại lý du lịch, với biến mục tiêu là product.name cho biết khách hàng đã lựa chọn sản phẩm sản phẩm bảo hiểm nào. Biến mục tiêu có bốn giá trị danh nghĩa tương ứng với bốn loại sản phẩm là Basic Plan, Bronze Plan, Silver Plan, và Value Plan. Mặc dù các sản phẩm này có mức giá khác nhau nhưng việc sánh các giá trị là không có nhiều ý nghĩa. Dữ liệu có 10 biến độc lập, tuy nhiên, để đơn giản hóa, chúng ta chỉ lấy hai biến là giới tính và độ tuổi của người tham gia bảo hiểm. Mối liên hệ giữa độ tuổi của khách hàng và loại sản phẩm khách hàng lựa chọn được mô tả bằng đồ thị dạng hộp như Hình 2.3.\nHình 2.3: Mối liên hệ giữa giới tính và loại hình bảo hiểm du lịch mà khách hàng lựa chọn\nTừ Hình 2.3 có thể thấy rằng Nam giới có xu hướng lựa chọn các loại hình bảo hiểm du lịch Basic Plan và Value Plan khi tỷ lệ Nam lựa chọn mỗi loại Hình bảo hiểm này lần lượt là 58% và 66%. Nữ giới có xu hướng lựa chọn Bronze Plan, Silver Plan khi tỷ lệ Nữ giới lựa chọn là 58% và 56%. Có thể kết luận được rằng có khác biệt giữa Nam và Nữ khi lựa chọn loại hình bảo hiểm du lịchChúng ta tiếp tục đánh giá mối liên hệ giữa biến độ tuổi đến loại hình bảo hiểm du lịch. Hình 2.4 sử dụng đồ thị dạng hộp để mô tả mối liên hệ giữa hai biến.\nHình 2.4: Mối liên hệ giữa giới tính và loại hình bảo hiểm du lịch mà khách hàng lựa chọn\nCó thể thấy rằng có sự khác biệt về phân phối của độ tuổi của những người lựa chọn các sản phẩm bảo hiểm: những người trẻ tuổi hơn có xu hướng lựa chọn Bronze Plan, Silver Plan trong khi những người lớn tuổi hơn có xu hướng lựa chọn Basic Plan và Value Plan.Từ các phân tích ở trên có thể thấy rằng có sự tác động của biến giới tính và độ tuổi lên biến mục tiêu. Để xây dựng mô hình tuyến tính tổng quát cho biến phân loại danh nghĩa, chúng ta sử dụng hàm multinom() từ thư viện nnet:Dựa trên kết quả ước lượng, chúng ta có công thức tính xác suất lựa chọn các sản phẩm bảo hiểm du lịch của một người có giới tính là \\(g_i\\) và độ tuổi \\(a_i\\) như sau:Với sản phẩm Basic Plan\\[\\begin{align}\n& \\mathbb{P}(Y = \\text{Basic}|g_i, a_i) = \\cfrac{1}{S_0} \\\\\n& \\mathbb{P}(Y = \\text{Bronze}|g_i, a_i) = \\cfrac{1}{S_0}  \\cdot e^{1.563 - 0.559 \\cdot g_i - 0.040 \\cdot a_i} \\\\\n& \\mathbb{P}(Y = \\text{Silver}|g_i, a_i) = \\cfrac{1}{S_0}  \\cdot e^{0.651 - 0.487 \\cdot g_i - 0.032 \\cdot a_i} \\\\\n& \\mathbb{P}(Y = \\text{Value}|g_i, a_i) = \\cfrac{1}{S_0} \\cdot e^{-1.10 + 0.338 \\cdot g_i - 0.002 \\cdot a_i}\n\\end{align}\\]với\\[\\begin{align}\nS_0 = 1 + \\mathbb{P}(Y = \\text{Bronze}|g_i, a_i) + \\mathbb{P}(Y = \\text{Silver}|g_i, a_i) +  \\mathbb{P}(Y = \\text{Value}|g_i, a_i)\n\\end{align}\\]Bảng 2.2 tính toán xác suất chấp nhận các sản phẩm du lịch theo một số độ tuổi điển hình và giới tính\nBảng 2.2: Xác suất lựa chọn loại hình bảo hiểm du lịch ước tính theo hai biến giải thích là giới tính và độ tuổi của người mua bảo hiểm\nKết quả từ mô hình cho thấy với các độ tuổi như trong Bảng 2.2 chỉ có Bronze Plan và Basic Plan được lựa chọn nếu chúng ta chỉ sử dụng hai biến độc lập là giới tính và độ tuổi. Đây là kết quả chưa chính xác vì mô hình chỉ sử dụng hai biến giới thích là độ tuổi và giới tính. Lựa chọn của khách hàng còn phụ thuộc vào nhiều yếu tố khác. Chúng tôi muốn nhấn mạnh về cách xây dựng mô hình cho biến phân loại hơn là cố gắng xây dựng một mô hình có khả năng dự báo tốt. Chúng ta sẽ thảo luận về đánh giá hiệu quả của mô hình ở các phần sau của chương sách.","code":"## # weights:  16 (9 variable)\n## initial  value 19625.769270 \n## iter  10 value 18535.510505\n## final  value 18040.676017 \n## converged## Call:\n## multinom(formula = Product.Name ~ Gender + Age, data = dat1)\n## \n## Coefficients:\n##             (Intercept)    GenderM          Age\n## Bronze Plan   1.5631988 -0.5589519 -0.039513361\n## Silver Plan   0.6512458 -0.4871457 -0.031596816\n## Value Plan   -1.0970424  0.3380718  0.002018711\n## \n## Std. Errors:\n##             (Intercept)    GenderM         Age\n## Bronze Plan  0.07047991 0.04302279 0.001653049\n## Silver Plan  0.08280363 0.05117056 0.001938850\n## Value Plan   0.08264747 0.05092679 0.001676413\n## \n## Residual Deviance: 36081.35 \n## AIC: 36099.35"},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"biến-phụ-thuộc-là-biến-rời-rạc-có-thứ-tự","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.2.3 Biến phụ thuộc là biến rời rạc có thứ tự","text":"Biến rời rạc có thứ tự, còn gọi là ordinal categorical variable, là các biến nhận giá trị rời rạc mà các giá trị rời rạc có thể sánh được với nhau. Một ví dụ điển hình cho biến rời rạc có thứ tự là số lần mà một người đi khám chữa bệnh sử dụng bảo hiểm y tế hoặc một khách hàng gửi yêu cầu bồi thường đến công ty bảo hiểm. Đây là trường hợp mà chúng ta có thể sử dụng một phân phối xác suất rời rạc có tham số để mô tả biến phụ thuộc \\(Y\\) giống như mô hình (??).","code":""},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"biến-phụ-thuộc-có-phân-phối-poisson","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.2.3.1 Biến phụ thuộc có phân phối Poisson","text":"Phân phối rời rạc thường được lựa chọn cho biến phụ thuộc rời rạc có thứ tự là phân phối Poisson. Hàm phân phối xác suất của biến ngẫu nhiên \\(Y\\) có phân phối Poisson với tham số \\(\\lambda > 0\\), ký hiệu \\(Y \\sim \\mathcal{P}(\\lambda)\\) được cho bởi công thức sau\n\\[\\begin{align}\n\\mathbb{P}(Y = y) = e^{-\\lambda} \\cdot \\cfrac{\\lambda^y}{y!} \\text{ với } y = 0, 1, 2, \\cdots\n\\end{align}\\]Phân phối Poisson thường được sử dụng để mô tả số lần một hiện tượng xảy ra trong một khoảng thời gian nhất định. Nguyên nhân là phân phối Poisson có mối liên hệ trực tiếp đến các mô hình có thời gian chờ có phân phối kiểu mũ. Thật vậy, nếu thời gian chờ giữa hai sự kiện liên tiếp xảy ra của một hiện tượng nào đó là một biến ngẫu nhiên liên tục có hàm phân phối xác suất kiểu mũ với tham số \\(\\gamma\\) thì số lần hiện tượng đó xảy ra trong một khoảng thời gian từ \\(t_1\\) đến \\(t_2\\) sẽ là một biến ngẫu nhiên phân phối Poisson với tham số \\(\\lambda = \\cfrac{(t_1 - t_2)}{\\gamma}\\).Gọi \\(T\\) là khoảng thời gian giữa 2 sự kiện liên tiếp xảy ra và \\(T\\) có phân phối mũ, hàm phân phối xác suất của \\(T\\) được viết như sau\n\\[\\begin{align}\n\\mathbb{P}(T \\leq x) = 1 - exp(-\\gamma x)\n\\end{align}\\]Gọi \\(N\\) là số lần xảy ra sự kiện, chẳng hạn như số lần đi khám, số lần lái xe gây ra tai nạn, giữa hai mốc thời gian \\(t_1 < t_2\\) thì \\(N\\) sẽ có phân phối Poisson với tham số \\(\\lambda\\):\n\\[\\begin{align}\n& \\mathbb{P}(N = k) = e^{-\\lambda} \\cdot \\cfrac{\\lambda^k}{k!}\\\\\n& \\lambda = \\cfrac{(t_1 - t_2)}{\\gamma}\n\\end{align}\\]Biến ngẫu nhiên có phân phối Poisson với tham số \\(\\lambda\\), ký hiệu \\(\\mathcal{P}(\\lambda)\\), có tính chất là giá trị trung bình và phương sai đều bằng tham số của biến đó là \\(\\lambda\\). Phân phối Poisson nằm trong họ các phân phối mũ nên sẽ rất thuận tiện trong xây dựng và ước lượng mô hình bằng phương pháp hợp lý tối đa. Ngoài ra, bằng cách cho tham số của phân phối Poisson một phân phối xác suất, chúng ta có thể thu được các phân phối rời rạc linh hoạt hơn trong mô tả các biến ngẫu nhiên dạng đếm được.Khi xây dựng mô hình tuyến tính với biến mục tiêu \\(Y\\) có phân phối Poisson, giá trị trung bình \\(Y\\) nhận giá trị dương nên chúng ta cần chọn các hàm liên kết \\(g\\) có miền xác định là tập các số thực dương \\(\\mathbb{R}^+\\) và miền giá trị là tập số thực \\(\\mathbb{R}\\). Hàm số thường được lựa chọn là hàm \\(\\text{log}\\).Chúng ta có thể viết mô hình tuyến tính tổng quát khi \\(Y\\) có phân phối Poisson, thường được gọi tắt là hồi quy Poisson, như sau\\[\\begin{align}\n& Y_i \\sim \\mathcal{P}(\\lambda_i) \\\\\n& \\mathbb{E}(Y_i) = \\lambda_i \\\\\n& log(\\lambda_i) = \\left(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p}\\right) \\\\\n& \\lambda_i = e^{\\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,p}}\n\\tag{2.19}\n\\end{align}\\]Dữ liệu được sử dụng để mô tả mô hình tuyến tính tổng quát với biến phụ thuộc phân phối Poisson là dữ liệu \\(SingaporeAuto.csv\\). Dữ liệu được tổng hợp bởi Hiệp hội bảo hiểm Singapore trong năm 1993 mô tả số vụ tai nạn ô tô xảy ra cùng với các đặc điểm của người lái và đặc điểm của xe gây tai nạn. Cũng giống như các phần trước, chúng ta sẽ xây dựng mô hình ở mức độ đơn giản nhất để bạn đọc dễ dàng hình dung. Biến phụ thuộc trong mô hình là biến \\(Clm\\_Count\\) cho biết số vụ tai nạn mà một lái xe gây ra trong vòng một năm, hai biến phụ thuộc bao gồm có:Biến \\(PC\\) là biến nhận hai giá trị là 0 tương ứng với xe được đăng ký theo công ty và nhận giá trị 1 tương ứng với xe được đăng ký theo cá nhân.Biến \\(PC\\) là biến nhận hai giá trị là 0 tương ứng với xe được đăng ký theo công ty và nhận giá trị 1 tương ứng với xe được đăng ký theo cá nhân.Biến \\(NCD\\), viết tắt của Claims Discount, cho biết lịch sử gây ra tai nạn của lái xe. Giá trị \\(NCD\\) càng cao nghĩa là lịch sử người lái xe càng gây ra ít tai nạn.Biến \\(NCD\\), viết tắt của Claims Discount, cho biết lịch sử gây ra tai nạn của lái xe. Giá trị \\(NCD\\) càng cao nghĩa là lịch sử người lái xe càng gây ra ít tai nạn.Chúng ta sử dụng hàm glm() để xây dựng và ước lượng mô hình tuyến tính tổng quát:Bạn đọc có thể thấy rằng cả hai biến \\(PC\\) và \\(NCD\\) đều có tác động đến giá trị trung bình của biến mục tiêu \\(Clm\\_Count\\) các giá trị p-value đều nhỏ. Mối liên hệ giữa số lượng tai nạn xảy ra và các biến \\(PC\\) và \\(NCD\\) được mô tả như sau:\\[\\begin{align}\n& Clm\\_Count_i \\sim \\mathcal{P}(\\lambda_i) \\\\\n& \\log(\\lambda_i) = -2.641 + 0.432 \\cdot PC_{} - 0.013 \\cdot NCD_{} \\\\\n& \\lambda_i = \\exp\\left(-2.641 + 0.432 \\cdot PC_{} - 0.013 \\cdot NCD_{} \\right)\n\\tag{2.20}\n\\end{align}\\]Hệ số của biến \\(PC\\) là số dương, điều này cho biết các xe đăng ký dưới dạng cá nhân có khả năng gây tai nạn cao hơn với xe đăng ký dưới hình thức doanh nghiệp. Đồng thời, hệ số của biến \\(NCD\\) âm cho biết lái xe có lịch sử lái xe tốt, tương ứng với \\(NCD\\) cao, ít có khả năng gây ra tai nạn hơn lái xe có lịch sử lái xe không tốt, tương ứng với \\(NCD\\) thấp.","code":"\ndat<-read.csv(\"../KHDL_KTKD Final/Dataset/SingaporeAuto.csv\")\nglm2<-glm(Clm_Count~PC+NCD, data=dat, family = poisson(link = \"log\"))\nsummary(glm2)## \n## Call:\n## glm(formula = Clm_Count ~ PC + NCD, family = poisson(link = \"log\"), \n##     data = dat)\n## \n## Coefficients:\n##              Estimate Std. Error z value Pr(>|z|)    \n## (Intercept) -2.641681   0.073836 -35.778  < 2e-16 ***\n## PC           0.431980   0.091840   4.704 2.56e-06 ***\n## NCD         -0.013943   0.002618  -5.327 9.99e-08 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## (Dispersion parameter for poisson family taken to be 1)\n## \n##     Null deviance: 2887.2  on 7482  degrees of freedom\n## Residual deviance: 2848.3  on 7480  degrees of freedom\n## AIC: 3849.4\n## \n## Number of Fisher Scoring iterations: 6"},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"phân-phối-rời-rạc-có-lạm-phát-tại-giá-trị-0.","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.2.3.2 Phân phối rời rạc có lạm phát tại giá trị 0.","text":"Biến phụ thuộc dạng đếm chứa một tỷ lệ lớn giá trị bằng 0 là các kiểu biến phụ thuộc thường gặp phải khi làm việc trên dữ liệu trong lĩnh vực bảo hiểm. Tỷ lệ lớn ở đây thường được hiểu là trên 90% giá trị quan sát được. Đa số các phân phối xác suất rời rạc thông thường, bao gồm phân phối Poisson, không mô tả tốt khi biến phụ thuộc \\(Y\\) trong trường hợp này.Một giải pháp phổ biến khi làm việc với kiểu dữ liệu như vậy là thay đổi phân phối dạng đếm thông thường để làm tăng tỷ lệ giá trị nhận được tại 0, để thu được các phân phối thường được gọi là các phân phối lạm phát tại 0, hay Zero-inflated variable. Phân phối lạm phát tại 0 là hỗn hợp của hai phân phối xác suất rời rạc, bao gồm một phân phối nhị thức chỉ báo cho trường hợp 0, và một phân phối xác suất dành cho biến đếm thông thường. Hàm phân phối của biến ngẫu nhiên dạng đếm có lạm phát tại 0, ký hiệu \\(ZI_Y\\), có thể được mô tả như sau\n\\[\\begin{align}\n\\mathbb{P}(ZI_Y = y) = \\begin{cases}\n& \\omega + (1-\\omega) \\cdot \\mathbb{P}(Y=0) \\text{ khi y = 0} \\\\\n& (1-\\omega) \\cdot \\mathbb{P}(Y=y) \\text{ khi y > 0}\n\\end{cases}\n\\tag{2.21}\n\\end{align}\\]\ntrong đó biến ngẫu nhiên \\(Y\\) tuân theo phân phối số đếm tiêu chuẩn được. Trong trường hợp tham số \\(\\omega\\) bằng 0, phân phối của biến ngẫu nhiên \\(ZI_Y\\) sẽ tương ứng tương ứng với phân phối của biến Y.Tất cả các phân phối kiểu đếm đều có thể được sử dụng để tạo ra các biến mới có lạm phát tại 0. Trong các mô hình tuyến tính tổng quát, biến dạng đếm thường được mô tả bằng phân phối cổ điển Poisson. Với việc sử dụng phương trình (2.21), hàm phân phối của biến ngẫu nhiên Poisson có lạm phát tại 0, ký hiệu là \\(ZI_\\mathcal{P}\\) được cho bởi công thức sau:\\[\\begin{align}\n\\mathbb{P}(ZI_\\mathcal{P} = y) = \\begin{cases}\n& \\omega + (1-\\omega) \\cdot e^{-\\lambda} \\text{ khi y = 0} \\\\\n& (1-\\omega) \\cdot e^{-\\omega} \\cdot \\cfrac{\\lambda^y}{y!} \\text{ khi y > 0}\n\\end{cases}\n\\tag{2.22}\n\\end{align}\\]Chúng ta có thể xác định giá trị trung bình và phương sai của phân phối \\(ZI_Y\\) dựa trên tham số \\(\\omega\\) và giá trị trung bình cũng như phương sai của biến \\(Y\\) như sau\n\\[\\begin{align}\n& \\mathbb{E}(ZI_Y) = (1-\\omega) \\cdot \\mathbb{E}(Y) \\\\\n& \\mathbb{V}(ZI_Y) = (1-\\omega) \\cdot \\mathbb{V}(Y) + \\omega(1-\\omega) \\cdot \\mathbb{E}(Y)^2\n\\tag{2.23}\n\\end{align}\\]Trong trường hợp \\(Y\\) có phân phối Poission, chúng ta có giá trị trung bình và phương sai của biến \\(ZI_\\mathcal{P}\\):\n\\[\\begin{align}\n& \\mathbb{E}(ZI_\\mathcal{P}) = (1-\\omega) \\cdot \\lambda \\\\\n& \\mathbb{V}(ZI_\\mathcal{P}) = \\mathbb{E}(ZI_\\mathcal{P}) \\cdot (1 + \\lambda - \\mathbb{E}(ZI_\\mathcal{P}))\n\\tag{2.24}\n\\end{align}\\]Với giá trị trung bình và phương sai của biến \\(ZI_\\mathcal{P}\\) như phương trình (2.21), chúng ta có thể xây dựng mô hình tuyến tính tổng quát với biến phụ thuộc là \\(ZI_\\mathcal{P}\\) như sau: giá trị trung bình \\(\\left((1-\\omega) \\cdot \\lambda\\right)\\) sẽ được giải thích thông qua các biến phụ thuộc trong khi tham số \\(\\lambda\\) sẽ được ước lượng bằng phương pháp hợp lý tối đa.Biến phụ thuộc phân phối \\(ZI_\\mathcal{P}\\) sẽ hữu ích cho mục đích lập mô hình trong trường hợp dữ liệu quan sát có sự tập trung quá mức tại giá trị 0. Ngoài phân phối Poisson, các phân phối mở rộng từ phân phối Poisson cũng có thể được sử dụng với để tạo ra các phân phối có lạm phát tại 0, chẳng hạn như biến ngẫu nhiên phân phối Poisson - Gamma, Poisson - Inverse gaussian.Trong các nghiên cứu thực nghiệm, nhiều tác giả đã chứng minh rằng việc áp dụng phân phối có lạm phát tại 0 để mô hình hóa số lượng yêu cầu bồi thường bảo hiểm là phù hợp để mô tả hành vi của người được bảo hiểm. Thật vậy, trong ngành bảo hiểm không phải tất cả các vụ tai nạn đều được báo cáo, công ty bảo hiểm chỉ có thông tin về các yêu cầu bồi thường được báo cáo. Có hai cách để giải thích cách phân phối có lạm phát tại 0 như sau: (1) Một số người được bảo hiểm không gửi yêu cầu bồi thường dù có xảy ra sự kiện bảo hiểm, họ không có nhận thức được về việc được bảo hiểm, hoặc không có nhu cầu gửi yêu cầu bảo hiểm. (2) Một cách giải thích khác của mô hình lạm phát tại 0 là xem xét xác suất của mỗi vụ tai nạn được báo cáo. Một hành vi thực tế của người được bảo hiểm là nếu họ đã báo cáo vụ tai nạn đầu tiên thì những vụ tai nạn tiếp theo cũng sẽ được báo cáo, còn nếu vụ tai nạn đầu tiên không được báo cáo thì các vụ tai nạn sau sẽ không được báo cáo. Cả hai cách giải thích dựa trên hành vi này đều dẫn đến việc số lượng biến mục tiêu nhận giá trị bằng 0 cao hơn với số lượng tai nạn thực tế xảy ra.\nBảng 2.3: Bảng 2.4: Khác nhau giữa GLM - Poisson và GLM - ZIP\nĐể xây dựng mô hình tuyến tính tổng quát trong đó biến phụ thuộc có phân phối \\(ZI_\\mathcal{P}\\) chúng ta sử dụng hàm số zeroinfl() của thư viện \\(pscl\\).Chúng ta có kết quả ước lượng các mô hình\nBảng 2.5: Bảng 2.6: Kết quả ước lượng GLM - Poisson và GLM - ZIP\nCó thể thấy rằng mô hình tuyến tính tổng quát với biến phụ thuộc phân phối \\(ZI_\\mathcal{P}\\) có giá trị hàm hợp lý tối đa lớn hơn, điều này cũng có nghĩa là phân phối \\(ZI_\\mathcal{P}\\) phù hợp hơn phân phối Poisson thông thường khi mô tả biến phụ thuộc trong dữ liệu. Dựa vào kết quả ước lượng từ hai mô hình, chúng ta có thể tính toán xác suất không có tai nạn và xác suất để xảy ra một tai nạn theo độ tuổi và giới tính của người tham gia bảo hiểm như sauCó thể nhận thấy rằng xác suất mà một người được bảo hiểm không để xảy ra tai nạn trong mô hình tuyến tính tổng quát với biến phụ thuộc có phân phối \\(ZI_\\mathcal{P}\\) là luôn cao hơn với mô hình tuyến tính tổng quát với biến phụ thuộc có phân phối Poisson thông thường. Đồng thời, mô hình tuyến tính tổng quát với biến phụ thuộc có phân phối \\(ZI_\\mathcal{P}\\) cho kết quả xác suất xảy ra đúng một tai nạn thấp hơn với mô hình có biến phụ thuộc có phân phối Poisson thông thường.","code":"\ndat<-read.csv(\"../KHDL_KTKD Final/Dataset/exposure.csv\")\n# Biến phụ thuộc có phân phối Poisson\nglm1<-glm(Claim_Count~Age+Gender,\n          family = poisson(link = \"log\"),\n          data=dat)\n\n# Biến phụ thuộc có phân phối Zero inflated poisson\nzip.glm<-zeroinfl(Claim_Count~Age+Gender|1,\n                  dist = 'poisson',\n                  link = \"log\",\n                  data = dat)\nsummary(glm1)\nsummary(zip.glm)"},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"biến-phụ-thuộc-có-phân-phối-liên-tục.","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.2.4 Biến phụ thuộc có phân phối liên tục.","text":"Một giả thiết quan trọng của mô hình tuyến tính tổng quát là biến phụ thuộc nằm trong họ các biến ngẫu nhiên có phân phối kiểu mũ, hay exponential family. Chúng ta sẽ thảo luận kỹ hơn về họ các biến ngẫu nhiên có phân phối kiểu mũ trong phần sau của cuốn sách. Lưu ý rằng họ các biến ngẫu nhiên có phân phối kiểu mũ không tương đồng với khái niệm biến ngẫu nhiên có phân phối mũ. Phân phối mũ chỉ là mộ trường hợp đặc biệt của phân phối kiển mũ. Có nhiều biến ngẫu nhiên liên tục khác có phân phối nằm trong họ các phân phối kiểu mũ. Có thể kể đến như phân phối gamma, phân phối chuẩn, phân phối chuẩn ngược…Các bước để xây dựng mô hình tuyến tính tổng quát trong trường hợp biến phụ thuộc \\(Y\\) là biến ngẫu nhiên liên tục hoàn toàn tương tự như cách xây dựng mô hình tuyến tính tổng quát ở trên, bao gồm bước chọn phân phối xác suất cho biến mục tiêu và lựa chọn hàm liên kết phù hợp. Chúng ta sẽ tiếp tục xây dựng mô hình với dữ liệu “exposure.csv” đã đề cập ở các phần trên. Biến mục tiêu không còn là số lần khách hàng gửi yêu cầu bồi thường, mà là số tiền trung bình mỗi lần khách hàng gửi yêu cầu (biến \\(Ave\\_Amount\\)). Các biến giải thích vẫn tiếp tục là giới tính (\\(Gender\\)) và độ tuổi (age) của người được bảo hiểm.Mối liên hệ giữa \\(Ave\\_Amount\\) được thể hiện qua đồ thị dưới đâyĐồ thị bên trái cho thấy số tiền yêu cầu bồi thường trung bình của nữ là cao hơn nam giới. Phân phối xác suất của số tiền yêu cầu bồi thương trung bình là phân phối liên tục lệch phải, có đuôi bên phải lớn. Đồ thị bên phải cho thấy số tiền yêu cầu bồi thường trung bình có xu hướng tăng theo độ tuổi.Số tiền bảo hiểm trung bình là số dương nên chúng ta sẽ sử dụng phân phối \\(gamma\\) với hàm liên kết là hàm log(). Lưu ý rằng phân phối gamma() là phân phối có hai tham số, thường được ký hiệu là \\(\\alpha\\) và \\(\\gamma\\), với hàm mật độ xác suất, giá trị trung bình, và phương sai như sau\n\\[\\begin{align}\n& f_Y(y) = \\cfrac{\\beta^\\alpha}{\\Gamma(\\alpha)} \\ y^{\\alpha-1} \\ e^{-\\gamma y} \\\\\n& \\mathbb{E}(X) = \\cfrac{\\alpha}{\\gamma} \\\\\n& \\mathbb{V}(X) = \\cfrac{\\alpha}{\\gamma^2}\n\\end{align}\\]Khi phân phối \\(gamma\\) được sử dụng cho biến phụ thuộc, giá trị trung bình được tính bằng \\(\\alpha/\\gamma\\), sẽ được mô tả thông qua các biến độc lập trong khi tham số \\(\\alpha\\) sẽ được ước lượng dựa trên hàm hợp lý tối đa:Ngoài các hệ số của các biến độc lập trong mô hình tuyến tính tổng quát, hàm glm() còn cung cấp giá trị ước lượng được cho tham số \\(\\phi\\) (disperson paramter hay tham số phân tán) là \\(0.924\\). Tham số phân tán được định nghĩa trong họ các phân phối kiểu mũ sẽ được thảo luận trong phần tiếp theo. Đối với phân phối \\(gamma\\), tham số phân tán được tính bằng \\(\\phi = 1/\\alpha\\).Giá trị số tiền bồi thường trung bình được được mô tả bằng mô hình tuyến tính tổng quát như sau:\n\\[\\begin{align}\n& Y_i \\sim Gamma(\\mu_i = \\alpha_i/\\gamma_i , \\phi_i = 1/\\alpha_i) \\\\\n& \\phi_i = 0.924 \\\\\n& log(\\mu_i) = -0.0475 + 0.079 \\cdot Age_i + 0.534 \\cdot Gender_i\n\\end{align}\\]Trước khi đi vào chi tiết các thành phần của mô hình, chúng tôi muốn kết luận rằng mô hình tuyến tính tổng quát có thể được sử dụng để mô hình hóa dữ liệu trong nhiều hoàn cảnh khác nhau. Việc xây dựng mô hình tuyến tính tổng quát luôn được bắt đầu bằng việc lựa chọn phân phối cho biến phụ thuộc và lựa chọn hàm số liên kết. Có các quy tắc chung trong việc lựa chọn phân phối và hàm liên kết giống như chúng tôi đã trình bày ở phần trên. Tuy nhiên để đưa ra được mô hình tuyến tính tổng quát phù hợp cho từng dữ liệu cụ thể, hoặc để có thể mở rộng được mô hình tuyến tính tổng quát trong các kiểu dữ liệu phức tạp hơn, bạn đọc cần hiểu sâu hơn về các đặc điểm kỹ thuật của các mô hình này. Các kiến thức này sẽ được trình bày trong các phần tiếp theo của chương.","code":"\ndat<-read.csv(\"../KHDL_KTKD Final/Dataset/exposure.csv\")\ndat<-mutate(dat,Ave_Amount = ifelse(Claim_Count>0,Total_Claim/Claim_Count,0))\ndat1<-filter(dat,Claim_Count>0)\ndat1$Gender<-ifelse(dat1$Gender==0,\"F\",\"M\")\np1<-dat1%>%ggplot()+geom_boxplot(aes(Gender,y = Ave_Amount))+\n  ylim(0,200)+ggtitle(\"Số tiền yêu cầu bồi thường trung bình và giới tính\")\np2<-dat1%>%ggplot(aes(x=Age,y = Ave_Amount))+geom_point(alpha=0.2)+\n  geom_smooth(col=\"black\", size = 1, se = FALSE)+ylim(0,200)+\n  ggtitle(\"Số tiền yêu cầu bồi thường trung bình và độ tuổi\")\ngrid.arrange(p1,p2,ncol=2)\ndat<-read.csv(\"../KHDL_KTKD Final/Dataset/exposure.csv\")\ndat<-mutate(dat,Ave_Amount = ifelse(Claim_Count>0,Total_Claim/Claim_Count,0))\ndat1<-filter(dat,Claim_Count>0)\nglm3<-glm(Ave_Amount~Age+Gender, family = Gamma(link = \"log\"),data = dat1)\nsummary(glm3)## \n## Call:\n## glm(formula = Ave_Amount ~ Age + Gender, family = Gamma(link = \"log\"), \n##     data = dat1)\n## \n## Coefficients:\n##              Estimate Std. Error t value Pr(>|t|)    \n## (Intercept) -0.047535   0.065517  -0.726    0.468    \n## Age          0.079089   0.001534  51.563   <2e-16 ***\n## Gender      -0.534010   0.041951 -12.730   <2e-16 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## (Dispersion parameter for Gamma family taken to be 0.9241118)\n## \n##     Null deviance: 4666.5  on 2110  degrees of freedom\n## Residual deviance: 2205.7  on 2108  degrees of freedom\n## AIC: 15710\n## \n## Number of Fisher Scoring iterations: 6"},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"các-thành-phần-của-mô-hình-tuyến-tính-tổng-quát.","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.3 Các thành phần của mô hình tuyến tính tổng quát.","text":"Như chúng ta đã thảo luận trong phần trước, mô hình tuyến tính tổng quát khắc phục hai giả thiết, cũng là hai nhược điểm của mô hình tuyến tính thông thường, đó là ) biến phụ thuộc có phân phối chuẩn, và ii) giá trị trung bình của biến phụ thuộc bằng một tổ hợp tuyến tính của các biến độc lập. Trong phần này của cuốn sách, chúng tôi sẽ thảo luận kỹ hơn vào cách tiếp cận để khắc phục các hạn chế kể trên.Thứ nhất, thay vì sử dụng phân phối chuẩn, mô hình tuyến tính tổng quát giả thiết rằng biến phụ thuộc có phân phối nằm trong họ các phân phối kiểu mũ (exponential family). Phân phối chuẩn chỉ là một trường hợp đặc biệt của họ các phân phối này.Thứ nhất, thay vì sử dụng phân phối chuẩn, mô hình tuyến tính tổng quát giả thiết rằng biến phụ thuộc có phân phối nằm trong họ các phân phối kiểu mũ (exponential family). Phân phối chuẩn chỉ là một trường hợp đặc biệt của họ các phân phối này.Thứ hai, mô hình tuyến tính tổng quát sử dụng một hàm \\(g\\), được gọi là hàm liên kết, để mô tả mối liên hệ giữa giá trị trung bình của biến phụ thuộc với tổ hợp tuyến tính của các biến độc lập. Lựa chọn hàm \\(g\\) có ý nghĩa quan trọng không chỉ trong cách luận giải kết quả của mô hình, mà còn ở việc dễ dàng ước lượng tham số của mô hình.Thứ hai, mô hình tuyến tính tổng quát sử dụng một hàm \\(g\\), được gọi là hàm liên kết, để mô tả mối liên hệ giữa giá trị trung bình của biến phụ thuộc với tổ hợp tuyến tính của các biến độc lập. Lựa chọn hàm \\(g\\) có ý nghĩa quan trọng không chỉ trong cách luận giải kết quả của mô hình, mà còn ở việc dễ dàng ước lượng tham số của mô hình.","code":""},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"họ-các-biến-ngẫu-nhiên-có-phân-phối-kiểu-mũ.","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.3.1 Họ các biến ngẫu nhiên có phân phối kiểu mũ.","text":"Thay vì giả thiết rằng \\(Y\\) có phân phối chuẩn trong mô hình tuyến tính thông thường, mô hình tuyến tính tổng quát giả thiết biến phụ thuộc \\(Y\\) nằm trong họ các biến ngẫu nhiên có phân phối kiểu mũ. Họ các biến ngẫu nhiên có phân phối kiểu mũ (exponential family) có hàm mật độ xác suất có thể viết dưới dạng như sau:\n\\[\\begin{align}\nf(y;\\theta,\\phi) = \\exp\\left[ \\cfrac{y \\theta - b(\\theta)}{(\\phi)} + c(y,\\phi) \\right]\n\\end{align}\\]\ntrong đóTham số \\(\\theta\\) được gọi là tham số \\(chính\\) \\(tắc\\) của phân phối kiểu mũ.Tham số \\(\\phi\\) được gọi là tham số \\(phân\\) \\(tán\\). Nguyên nhân là giá trị trung bình của biến ngẫu nhiên \\(Y\\) không phụ thuộc vào \\(\\phi\\). Tham số \\(\\phi\\), mà tổng quát hơn là hàm \\((\\phi)\\) sẽ xác định phương sai của biến phụ thuộc.Các hàm số \\(b(\\theta)\\), \\((\\phi)\\) và \\(c(y,\\phi)\\) sẽ quyết định kiểu phân phối của biến phụ thuộc.Giá trị trung bình và phương sai của biến phụ thuộc \\(Y\\) được cho bởi các công thức sau:\n\\[\\begin{align}\n& \\mathbb{E}(Y) = b^{'}(\\theta) \\\\\n& \\mathbb{V}(Y) = (\\phi) \\cdot b^{''}(\\theta)\n\\tag{2.25}\n\\end{align}\\]\nvới \\(b^{'}(\\theta)\\) và \\(b^{''}(\\theta)\\) lần lượt là đạo hàm bậc một và đạo hàm bậc hai của hàm số \\(b\\) theo biến \\(\\theta\\).Họ các biến ngẫu nhiên có phân phối kiểu mũ bao gồm đa số các biến ngẫu nhiên liên tục thông thường như phân phối chuẩn, phân phối mũ, phân phối Gamma, phân phối chuẩn ngược. Các biến ngẫu nhiên phân phối rời rạc như phân phối nhị thức, phân phối binomial, hoặc phân phối Poisson cũng nằm trong họ các biến ngẫu nhiên có phân phối kiểu mũ.Ví dụ 1: phân phối Poisson thường được sử dụng để mô tả phân phối của biến đếm trong mô hình tuyến tính tổng quát. Hàm phân phối của biến ngẫu nhiên Poisson với tham số \\(\\lambda\\), ký hiệu \\(\\mathcal{P}(\\lambda)\\), được cho bởi công thức\n\\[\\begin{align}\n\\mathbb{P}(Y = y; \\lambda) = exp(-\\lambda) \\ \\cfrac{\\lambda^y}{y!}\n\\end{align}\\]\nChúng ta có thể viết phân phối \\(\\mathcal{P}(\\lambda)\\) dưới dạng phân phối mũ như sau\n\\[\\begin{align}\n\\mathbb{P}(Y = y; \\theta) = exp\\left[ \\cfrac{\\theta y - exp(\\theta)}{1} - log(\\Gamma(y+1)) \\right] \\text{ với } \\lambda = exp(\\theta)\n\\end{align}\\]\nĐây là hàm phân phối của biến ngẫu nhiên nằm trong họ các phân phối kiểu mũ với \\((\\phi) = 1\\); \\(b(\\theta) = exp(\\theta)\\) và \\(c(y,\\phi) = log\\left(\\Gamma(y+1)\\right)\\). Bạn đọc có thể tính toán trung bình và phương sai của phân phối \\(\\lambda\\) dựa theo công thức (2.25)\n\\[\\begin{align}\n& \\mathbb{E}(Y) = b^{'}(\\theta) = exp(\\theta) = \\lambda \\\\\n& \\mathbb{V}(Y) = (\\phi) \\cdot b^{''}(\\theta) = 1 \\cdot exp(\\theta) = \\lambda\n\\end{align}\\]Ví dụ 1: phân phối Poisson thường được sử dụng để mô tả phân phối của biến đếm trong mô hình tuyến tính tổng quát. Hàm phân phối của biến ngẫu nhiên Poisson với tham số \\(\\lambda\\), ký hiệu \\(\\mathcal{P}(\\lambda)\\), được cho bởi công thức\n\\[\\begin{align}\n\\mathbb{P}(Y = y; \\lambda) = exp(-\\lambda) \\ \\cfrac{\\lambda^y}{y!}\n\\end{align}\\]\nChúng ta có thể viết phân phối \\(\\mathcal{P}(\\lambda)\\) dưới dạng phân phối mũ như sau\n\\[\\begin{align}\n\\mathbb{P}(Y = y; \\theta) = exp\\left[ \\cfrac{\\theta y - exp(\\theta)}{1} - log(\\Gamma(y+1)) \\right] \\text{ với } \\lambda = exp(\\theta)\n\\end{align}\\]\nĐây là hàm phân phối của biến ngẫu nhiên nằm trong họ các phân phối kiểu mũ với \\((\\phi) = 1\\); \\(b(\\theta) = exp(\\theta)\\) và \\(c(y,\\phi) = log\\left(\\Gamma(y+1)\\right)\\). Bạn đọc có thể tính toán trung bình và phương sai của phân phối \\(\\lambda\\) dựa theo công thức (2.25)\n\\[\\begin{align}\n& \\mathbb{E}(Y) = b^{'}(\\theta) = exp(\\theta) = \\lambda \\\\\n& \\mathbb{V}(Y) = (\\phi) \\cdot b^{''}(\\theta) = 1 \\cdot exp(\\theta) = \\lambda\n\\end{align}\\]Ví dụ 2: phân phối chuẩn là một biến ngẫu nhiên nằm trong họ các phân phối kiểu mũ. Thật vậy, chúng ta có hàm mật độ của biến ngẫu nhiên phân phối chuẩn với trung bình \\(\\mu\\) và độ lệch chuẩn \\(\\sigma\\), ký hiệu \\(\\mathcal{N}(\\mu,\\sigma)\\), như sau\n\\[\\begin{align}\nf(y,\\mu,\\sigma) = \\cfrac{1}{\\sqrt{2 \\pi \\sigma^2}} \\exp\\left[ \\cfrac{-(y - \\mu)^2}{2 \\ \\sigma^2} \\right]\n\\end{align}\\]\nHàm phân phối của \\(\\mathcal{N}(\\mu,\\sigma)\\) có thể được viết dưới dạng phân phối kiểu mũ\n\\[\\begin{align}\n\\cfrac{1}{\\sqrt{2 \\pi} \\sigma} \\exp\\left[ \\cfrac{-(y - \\mu)^2}{2 \\ \\sigma^2} \\right] &= \\exp\\left[ \\cfrac{-(y - \\mu)^2}{2 \\ \\sigma^2} - \\cfrac{1}{2} log(2 \\pi \\sigma^2) \\right] \\\\\n&= \\exp\\left[ \\cfrac{\\mu y - \\mu^2/2} {\\sigma^2} - \\cfrac{y^2}{2\\sigma^2} - \\cfrac{1}{2} log(2 \\pi \\sigma^2) \\right]\n\\end{align}\\]\nVới \\(\\theta = \\mu\\) và \\(\\phi = \\sigma^2\\) chúng ta có hàm mật độ của biến ngẫu nhiên \\(\\mathcal{N}(\\mu,\\sigma)\\) là hàm mật độ của biến ngẫu nhiên nằm trong họ các phân phối kiểu mũ, với \\((\\phi) = \\phi\\), \\(b(\\theta) = \\theta^2/2\\) và\n\\[\\begin{align}\nc(y,\\phi) = -\\cfrac{y^2}{2\\phi} - \\cfrac{1}{2} log(2 \\pi \\phi)\n\\end{align}\\]\nBạn đọc có thể kiểm tra giá trị trung bình và phương sai của phân phối \\(\\mathcal{N}(\\mu,\\sigma)\\) dựa theo công thức (2.25)\n\\[\\begin{align}\n& \\mathbb{E}(Y) = b^{'}(\\theta) = \\theta = \\mu \\\\\n& \\mathbb{V}(Y) = (\\phi) \\cdot b^{''}(\\theta) = \\phi \\cdot 1 = \\phi = \\sigma^2\n\\end{align}\\]Ví dụ 2: phân phối chuẩn là một biến ngẫu nhiên nằm trong họ các phân phối kiểu mũ. Thật vậy, chúng ta có hàm mật độ của biến ngẫu nhiên phân phối chuẩn với trung bình \\(\\mu\\) và độ lệch chuẩn \\(\\sigma\\), ký hiệu \\(\\mathcal{N}(\\mu,\\sigma)\\), như sau\n\\[\\begin{align}\nf(y,\\mu,\\sigma) = \\cfrac{1}{\\sqrt{2 \\pi \\sigma^2}} \\exp\\left[ \\cfrac{-(y - \\mu)^2}{2 \\ \\sigma^2} \\right]\n\\end{align}\\]\nHàm phân phối của \\(\\mathcal{N}(\\mu,\\sigma)\\) có thể được viết dưới dạng phân phối kiểu mũ\n\\[\\begin{align}\n\\cfrac{1}{\\sqrt{2 \\pi} \\sigma} \\exp\\left[ \\cfrac{-(y - \\mu)^2}{2 \\ \\sigma^2} \\right] &= \\exp\\left[ \\cfrac{-(y - \\mu)^2}{2 \\ \\sigma^2} - \\cfrac{1}{2} log(2 \\pi \\sigma^2) \\right] \\\\\n&= \\exp\\left[ \\cfrac{\\mu y - \\mu^2/2} {\\sigma^2} - \\cfrac{y^2}{2\\sigma^2} - \\cfrac{1}{2} log(2 \\pi \\sigma^2) \\right]\n\\end{align}\\]\nVới \\(\\theta = \\mu\\) và \\(\\phi = \\sigma^2\\) chúng ta có hàm mật độ của biến ngẫu nhiên \\(\\mathcal{N}(\\mu,\\sigma)\\) là hàm mật độ của biến ngẫu nhiên nằm trong họ các phân phối kiểu mũ, với \\((\\phi) = \\phi\\), \\(b(\\theta) = \\theta^2/2\\) và\n\\[\\begin{align}\nc(y,\\phi) = -\\cfrac{y^2}{2\\phi} - \\cfrac{1}{2} log(2 \\pi \\phi)\n\\end{align}\\]\nBạn đọc có thể kiểm tra giá trị trung bình và phương sai của phân phối \\(\\mathcal{N}(\\mu,\\sigma)\\) dựa theo công thức (2.25)\n\\[\\begin{align}\n& \\mathbb{E}(Y) = b^{'}(\\theta) = \\theta = \\mu \\\\\n& \\mathbb{V}(Y) = (\\phi) \\cdot b^{''}(\\theta) = \\phi \\cdot 1 = \\phi = \\sigma^2\n\\end{align}\\]Ví dụ 3: phân phối \\(Gamma(\\alpha,\\gamma)\\) nằm trong họ các phân phối kiểu mũ. Thật vậy\n\\[\\begin{align}\nf(y) &= \\cfrac{\\gamma^\\alpha}{\\Gamma(\\alpha)} \\ y^{\\alpha-1} \\ e^{-\\gamma \\cdot y} \\\\\n&= \\exp\\left[ -\\gamma \\cdot y + \\alpha \\log(\\gamma) - \\log(\\Gamma(\\alpha)) - (\\alpha-1) \\cdot \\log(y)    \\right]\n\\end{align}\\]\nVới \\(\\theta = -\\gamma/\\alpha\\) và \\(\\phi = 1/\\alpha\\) ta có\n\\[\\begin{align}\nf(y) & = \\exp\\left[ \\cfrac{\\theta y + \\log(-\\theta)}{1/\\alpha} - \\cfrac{\\log(\\alpha)}{1/\\alpha} - \\log(\\Gamma(\\alpha)) - (\\alpha-1) \\cdot \\log(y)    \\right] \\\\\n& = \\exp\\left[ \\cfrac{\\theta y + \\log(-\\theta)}{\\phi} + \\cfrac{\\log(\\phi)}{\\phi} - \\log(\\Gamma(1/\\phi)) - (1/\\phi-1) \\cdot \\log(y)    \\right]\n\\end{align}\\]\nChúng ta có phân phối kiểu mũ với \\((\\phi) = \\phi\\), \\(b(\\theta) = \\log(-\\theta)\\), và\n\\[\\begin{align}\nc(y,\\phi) = \\cfrac{\\log(\\phi)}{\\phi} - \\log(\\Gamma(1/\\phi)) - (1/\\phi-1) \\cdot \\log(y)\n\\end{align}\\]\nChúng ta kiểm tra giá trị trung bình và phương sai của phân phối \\(Gamma(\\alpha,\\beta)\\) theo công thức (2.25)\n\\[\\begin{align}\n& \\mathbb{E}(Y) = b^{'}(\\theta) = - \\cfrac{1}{\\theta} = \\cfrac{\\alpha}{\\gamma} \\\\\n& \\mathbb{V}(Y) = (\\phi) \\cdot b^{''}(\\theta) = \\cfrac{1}{\\alpha} \\cdot \\cfrac{\\alpha^2}{\\gamma^2} = \\cfrac{\\alpha}{\\gamma^2}\n\\end{align}\\]Ví dụ 3: phân phối \\(Gamma(\\alpha,\\gamma)\\) nằm trong họ các phân phối kiểu mũ. Thật vậy\n\\[\\begin{align}\nf(y) &= \\cfrac{\\gamma^\\alpha}{\\Gamma(\\alpha)} \\ y^{\\alpha-1} \\ e^{-\\gamma \\cdot y} \\\\\n&= \\exp\\left[ -\\gamma \\cdot y + \\alpha \\log(\\gamma) - \\log(\\Gamma(\\alpha)) - (\\alpha-1) \\cdot \\log(y)    \\right]\n\\end{align}\\]\nVới \\(\\theta = -\\gamma/\\alpha\\) và \\(\\phi = 1/\\alpha\\) ta có\n\\[\\begin{align}\nf(y) & = \\exp\\left[ \\cfrac{\\theta y + \\log(-\\theta)}{1/\\alpha} - \\cfrac{\\log(\\alpha)}{1/\\alpha} - \\log(\\Gamma(\\alpha)) - (\\alpha-1) \\cdot \\log(y)    \\right] \\\\\n& = \\exp\\left[ \\cfrac{\\theta y + \\log(-\\theta)}{\\phi} + \\cfrac{\\log(\\phi)}{\\phi} - \\log(\\Gamma(1/\\phi)) - (1/\\phi-1) \\cdot \\log(y)    \\right]\n\\end{align}\\]\nChúng ta có phân phối kiểu mũ với \\((\\phi) = \\phi\\), \\(b(\\theta) = \\log(-\\theta)\\), và\n\\[\\begin{align}\nc(y,\\phi) = \\cfrac{\\log(\\phi)}{\\phi} - \\log(\\Gamma(1/\\phi)) - (1/\\phi-1) \\cdot \\log(y)\n\\end{align}\\]\nChúng ta kiểm tra giá trị trung bình và phương sai của phân phối \\(Gamma(\\alpha,\\beta)\\) theo công thức (2.25)\n\\[\\begin{align}\n& \\mathbb{E}(Y) = b^{'}(\\theta) = - \\cfrac{1}{\\theta} = \\cfrac{\\alpha}{\\gamma} \\\\\n& \\mathbb{V}(Y) = (\\phi) \\cdot b^{''}(\\theta) = \\cfrac{1}{\\alpha} \\cdot \\cfrac{\\alpha^2}{\\gamma^2} = \\cfrac{\\alpha}{\\gamma^2}\n\\end{align}\\]Trong trường hợp hàm số \\((\\phi)\\) là hàm số tuyến tính theo \\(\\phi\\), nghĩa là tồn tại số \\(\\omega\\) sao cho \\((\\phi) = \\cfrac{\\phi}{\\omega}\\) chúng ta có hàm mật độ của biến ngẫu nhiên có phân phối kiểu mũ như sau\n\\[\\begin{align}\nf(y;\\theta,\\phi) = \\exp\\left[ \\cfrac{y \\theta - b(\\theta)}{\\phi/\\omega} + c(y,\\phi) \\right]\n\\end{align}\\]\nGiá trị trung bình và phương sai của biến ngẫu nhiên \\(Y\\) trong trường hợp này được xác định như sau:\n\\[\\begin{align}\n& \\mathbb{E}(Y) = b^{'}(\\theta) \\\\\n& \\mathbb{V}(Y) = \\cfrac{\\phi}{\\omega} \\cdot b^{''}(\\theta)\n\\end{align}\\]Giả sử hàm \\(b^{'}(.)\\) là hàm số đơn điệu và tồn tại hàm số ngược \\({b^{'}}^{-1}(.)\\) thì \\(\\theta = {b^{'}}^{-1}\\left(\\mathbb{E}(Y)\\right)\\). đó mối liên hệ giữa phương sai của biến ngẫu nhiên \\(Y\\) và giá trị trung bình của biến \\(Y\\) được thể hiện qua công thức sau\n\\[\\begin{align}\n\\mathbb{V}(Y) = \\cfrac{\\phi}{\\omega} \\cdot b^{''}({b^{'}}^{-1}(\\mathbb{E}(Y)))\n\\end{align}\\]Hàm số \\(V(\\cdot) = b^{''}({b^{'}}^{-1}(\\cdot))\\) được gọi là hàm phương sai của phân phối kiểu mũ. Tại sao chúng ta cần định nghĩa một hàm số phức tạp như vậy? Bởi vì hàm \\(V(\\cdot)\\) là cơ sở để người xây dựng mô hình kiểm soát phương sai của biến ngẫu nhiên kiểu mũ.Giả sử biến phụ thuộc quan sát được là \\(Y_1, Y_2, \\cdots, Y_n\\) có cùng phân phối kiểu mũ với cùng tham số \\(\\phi\\), cùng hàm \\(b(\\cdot)\\) và \\(c(\\cdot)\\), nhưng có giá trị \\(\\omega_i\\) khác nhau. Giá trị trung bình của biến \\(Y_i\\), ký hiệu là \\(\\mu_i\\) được giải thích thông qua các biến độc lập và không phụ thuộc vào \\(\\omega_i\\), trong khi phương sai của biến \\(Y_i\\) phụ thuộc vào \\(\\omega_i\\) và giá trị trung bình \\(\\mu_i\\):\n\\[\\begin{align}\n\\mathbb{V}(Y_i) = \\cfrac{\\phi}{\\omega_i} \\cdot V(\\mu_i)\n\\end{align}\\]Khi ước lượng mô hình tuyến tính tổng quát trên một dữ liệu cụ thể, giá trị hàm phương sai \\(V\\) phụ thuộc vào cách chúng ta lựa chọn hàm \\(b\\) và giá trị trung bình của \\(Y_i\\). Tham số \\(\\phi\\) không phụ thuộc vào quan sát \\(Y_i\\), đó hệ số \\(w_i\\) có ý nghĩa quyết định trong xác định phương sai của \\(Y_i\\). Chúng ta có thể lựa chọn đơn giản là cho \\(w_i\\) bằng 1 với mọi \\(\\), nếu chúng ta tin rằng tỷ lệ \\(\\cfrac{V(\\mu_i)}{\\mathbb{V}(Y_i)}\\) là hằng số. Trong một số trường hợp, \\(\\cfrac{V(\\mu_i)}{\\mathbb{V}(Y_i)}\\) thay đổi theo \\(\\), đó là lúc chúng ta cần lựa chọn \\(w_i\\) để cho kết quả tốt nhất. Chúng ta sẽ tiếp tục thảo luận về hàm phương sai của biến phụ thuộc trong phần hàm hợp lý tối đa của biến ngẫu nhiên nằm trong họ phân phối các phân phối kiểu mũ.","code":""},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"hàm-liên-kết.","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.3.2 Hàm liên kết.","text":"Hàm số liên kết \\(g(\\cdot)\\) liên kết giá trị trung bình của biến phụ thuộc với tổ hợp tuyến tính của các biến độc lập luôn được lựa chọn trong nhóm các hàm số đơn điệu và có đạo hàm trên miền xác định của hàm số đó. Các giả thiết này đảm bảo để hàm liên kết có hàm số ngược \\(g^{-1}(\\cdot)\\) cũng là hàm đơn điệu và có đạo hàm trên miền xác định. Một yếu tố quan trọng khác khi lựa chọn hàm liên kết đó là \\(g(\\cdot)\\) có miền xác định trùng với miền xác định của giá trị trung bình của biến phụ thuộc và miền giá trị của \\(g(\\cdot)\\) là tập số thực \\(\\mathbb{R}\\).Xin được nhắc lại rằng mối liên hệ giữa trung bình của biến phụ thuộc và tổ hợp tuyến tính của biến độc lập được mô tả thông qua hàm liên kết như sau:\n\\[\\begin{align}\n& g(\\mu_i) = \\beta_0 + \\beta_1 \\cdot x_{,1} +  \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,d} \\\\\n& \\mu_i = g^{-1}\\left( beta_0 + \\beta_1 \\cdot x_{,1} +  \\beta_2 \\cdot x_{,2} + \\cdots + \\beta_p \\cdot x_{,d} \\right)\n\\end{align}\\]Danh sách các hàm số thường được sử dụng làm hàm liên kết được cho trong bảng dưới đâyVí dụ 1: khi \\(Y\\) mô tả số lần khách hàng gửi yêu cầu bảo hiểm, giá trị trung bình của \\(Y\\) sẽ là số thực dương. Các hàm số có miền xác định là tập các số thực dương sẽ phù hợp trong trường hợp này. Có thể thấy trong bảng trên các hàm \\(g(\\mu) = \\log(\\mu)\\) và hàm \\(g(\\mu) = 1/\\mu^2\\) là các hàm số có thể lựa chọn là hàm liên kết.Ví dụ 1: khi \\(Y\\) mô tả số lần khách hàng gửi yêu cầu bảo hiểm, giá trị trung bình của \\(Y\\) sẽ là số thực dương. Các hàm số có miền xác định là tập các số thực dương sẽ phù hợp trong trường hợp này. Có thể thấy trong bảng trên các hàm \\(g(\\mu) = \\log(\\mu)\\) và hàm \\(g(\\mu) = 1/\\mu^2\\) là các hàm số có thể lựa chọn là hàm liên kết.Ví dụ 2: khi \\(Y\\) mô tả khách hàng có gửi yêu cầu bảo hiểm hay không, hoặc mô tả sự kiện tai nạn có xảy ra hay không, giá trị trung bình của \\(Y\\) nằm trong khoảng \\((0,1)\\). đó các hàm \\(Logit\\), hàm \\(Probit\\), hàm \\(Log-Log\\), hoặc hàm \\(Cauchit\\) sẽ là lựa chọn phù hợp cho hàm liên kết.Ví dụ 2: khi \\(Y\\) mô tả khách hàng có gửi yêu cầu bảo hiểm hay không, hoặc mô tả sự kiện tai nạn có xảy ra hay không, giá trị trung bình của \\(Y\\) nằm trong khoảng \\((0,1)\\). đó các hàm \\(Logit\\), hàm \\(Probit\\), hàm \\(Log-Log\\), hoặc hàm \\(Cauchit\\) sẽ là lựa chọn phù hợp cho hàm liên kết.Khi lựa chọn hàm liên kết bạn đọc cần cân nhắc đến khả năng giải thích của mô hình và sự khó khăn có thể gặp phải khi ước lượng của tham số trong mô hình. Ví dụ như khi biến mục tiêu chỉ nhận giá trị 0 hoặc 1, hàm logit thường xuyên được sử dụng bởi vì khả năng giải thích tốt hơn hàm \\(Probit\\) hay \\(Log-Log\\). Hoặc khi cân nhắc lựa chọn giữa hàm \\(log\\) và hàm \\(inverse\\) \\(squared\\), hàm \\(log\\) thường được ưu tiên lựa chọn. Có thể sánh mối liên hệ giữa \\(\\mu_i\\) với các biến độc lập như dưới đây thông qua hàm \\(log\\) hoặc hàm \\(inverse\\) \\(squared\\) như sau\n\\[\\begin{align}\n&\\text{ Hàm log: } \\mu_i = exp(\\beta_0) \\cdot exp(\\beta_1 \\cdot x_{,1}) \\cdots exp(\\beta_p \\cdot x_{,p}) \\\\\n&\\text{ Inverse squared: } \\mu_i = \\cfrac{1}{\\sqrt{\\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots + \\beta_p \\cdot x_{,p}}}\n\\end{align}\\]\nKhi sử dụng hàm \\(log\\), mỗi biến độc lập tác động lên giá trị trung bình của biến phụ thuộc một cách độc lập với nhau theo quy tắc nhân, trong khi đó không dễ để đánh giá tác động của một biến độc lập lên biến phụ thuộc trong công thức của hàm \\(inverse\\) \\(squared\\). Hay nói cách khác, sử dụng hàm \\(log\\) thường sẽ dễ dàng giải thích kết quả hơn với khi sử dụng hàm \\(inverse\\) \\(squared\\).Với \\(Y\\) là biến ngẫu nhiên nằm trong họ các phân phối kiểu mũ ta có \\(\\mathbb{E}(Y_i) = b^{'}(\\theta_i)\\). Khi chúng ta lựa chọn hàm liên kết là \\(g(\\cdot) = (b^{'})^{-1}(\\cdot)\\) thì mối liên hệ giữa tham số chính tắc \\(\\theta_i\\) với các biến độc lập sẽ là tuyến tính. Thật vậy,\n\\[\\begin{align}\n& \\mu_i = g^{-1}(\\theta_i) \\\\\n& g(\\mu_i) = \\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots + \\beta_p \\cdot x_{,p}\\\\\n& \\rightarrow \\theta_i = \\beta_0 + \\beta_1 \\cdot x_{,1} + \\beta_2 \\cdot x_{,2} \\cdots + \\beta_p \\cdot x_{,p}\n\\end{align}\\]Như vậy, với lựa chọn hàm liên kết \\(g(\\cdot) = (b^{'})^{-1}(\\cdot)\\), tham số chính tắc \\(\\theta_i\\) của biến ngẫu nhiên phân phối mũ \\(Y_i\\) bằng tổ hợp tuyến tính của các biến độc lập. Trong trường hợp này, hàm liên kết \\((b^{'})^{-1}(\\cdot)\\) còn được gọi là hàm liên kết chính tắc của biến phụ thuộc \\(Y\\).Ví dụ 1: khi \\(Y\\) là biến ngẫu nhiên có phân phối chuẩn \\(\\mathcal{N}(\\mu, \\sigma)\\), chúng ta có \\(b(\\mu) = \\mu^2/2\\) và \\(b^{'}(\\mu) = \\mu\\) đó hàm liên kết chính tắc của biến ngẫu nhiên phân phối chuẩn \\(\\mathcal{N}(\\mu, \\sigma)\\) là \\(g(\\mu) = \\mu\\).Ví dụ 1: khi \\(Y\\) là biến ngẫu nhiên có phân phối chuẩn \\(\\mathcal{N}(\\mu, \\sigma)\\), chúng ta có \\(b(\\mu) = \\mu^2/2\\) và \\(b^{'}(\\mu) = \\mu\\) đó hàm liên kết chính tắc của biến ngẫu nhiên phân phối chuẩn \\(\\mathcal{N}(\\mu, \\sigma)\\) là \\(g(\\mu) = \\mu\\).Ví dụ 2: khi \\(Y\\) là biến ngẫu nhiên có phân phối \\(gamma(\\alpha,\\gamma)\\), chúng ta có \\(b(\\mu) = \\log(-\\mu)\\), và \\(b^{'}(\\mu) = -1/\\mu\\), đó hàm liên kết chính tắc của biến ngẫu nhiên phân phối gamma là \\(g(\\mu) = -1/\\mu\\). Trong trường hợp này hàm liên kết không có miền xác định là tập các số thực dương. Có thể thấy rằng lựa chọn hàm liên kết chính tắc không phải là một lựa chọn phù hợp.Ví dụ 2: khi \\(Y\\) là biến ngẫu nhiên có phân phối \\(gamma(\\alpha,\\gamma)\\), chúng ta có \\(b(\\mu) = \\log(-\\mu)\\), và \\(b^{'}(\\mu) = -1/\\mu\\), đó hàm liên kết chính tắc của biến ngẫu nhiên phân phối gamma là \\(g(\\mu) = -1/\\mu\\). Trong trường hợp này hàm liên kết không có miền xác định là tập các số thực dương. Có thể thấy rằng lựa chọn hàm liên kết chính tắc không phải là một lựa chọn phù hợp.","code":""},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"hàm-hợp-lý-tối-đa-và-ước-lượng-mô-hình.","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.4 Hàm hợp lý tối đa và ước lượng mô hình.","text":"Hệ số tuyến tính của các biến độc lập \\(\\boldsymbol{\\beta} = (\\beta_0, \\beta_1, \\cdots, \\beta_p)\\) được ước lượng từ dữ liệu \\(\\textbf{y} = (y_1, y_2, \\cdots y_n)\\) và \\(\\textbf{x} = (\\textbf{x}_1, \\textbf{x}_2, \\cdots \\textbf{x}_n)\\) bằng phương pháp tối đa hóa hàm hợp lý, hay còn gọi là hàm likelihood. Khi biến mục tiêu \\(Y_i\\) có phân phối kiểu mũ, hàm likelihood được viết như sau\n\\[\\begin{align}\nL(\\textbf{y},\\boldsymbol{\\beta}) = \\prod\\limits_{=1}^n \\ \\exp\\left[ \\cfrac{y_i \\theta - b(\\theta)}{a_i(\\phi)} + c_i(y_i,\\phi) \\right]\n\\end{align}\\]\nTrong hầu hết các trường hợp, chúng ta sẽ thực hiện tính toán trên hàm Log-likelihood thay vì hàm likelihood. Hàm Log-likelihood được ký hiệu \\(l(\\textbf{y},\\beta)\\) được xác định như sau\\[\\begin{align}\nl(\\textbf{y},\\beta) &= \\log \\left( \\prod\\limits_{=1}^n \\ \\exp\\left[ \\cfrac{y_i \\theta_i - b(\\theta_i)}{a_i(\\phi)} + c_i(y_i,\\phi) \\right] \\right) \\\\\n&= \\sum\\limits_{=1}^n  \\left(\\cfrac{y_i \\theta_i - b(\\theta_i)}{a_i(\\phi)} + c_i(y_i,\\phi)\\right)\n\\end{align}\\]\nVéc-tơ hệ số \\(\\boldsymbol{\\beta}\\) được ước lượng sao cho giá trị của hàm Log-likelihood đạt giá trị lớn nhất. Như vậy \\(\\boldsymbol{\\beta}\\) là nghiệm của hệ phương trình\n\\[\\begin{align}\n\\cfrac{\\partial l(\\textbf{y},\\boldsymbol{\\beta})}{\\partial \\beta_j} & = 0 \\ \\ \\forall j = 1,2, \\cdots, p\n\\end{align}\\]\nLưu ý rằng \\(b^{'}(\\theta_i) = \\mu_i\\) nên trong các thành phần của hàm mật độ xác suất của biến \\(Y_i\\) chỉ có hàm số \\(b(\\cdot)\\) và tham số \\(\\theta_i\\) phụ thuộc vào hệ số \\(\\boldsymbol{\\beta}\\). Đạo hàm của hàm Log-likelihood theo \\(\\beta\\) có thể viết được như sau\n\\[\\begin{align}\n\\cfrac{\\partial l(\\textbf{y},\\beta)}{\\partial \\beta_j} & = \\sum\\limits_{=1}^n  \\cfrac{1}{a_i(\\phi)} \\left(y_i \\cfrac{\\partial \\theta_i}{\\partial \\beta_j} - \\cfrac{\\partial b(\\theta_i)}{\\partial \\beta_j} \\right) \\\\\n& = \\sum\\limits_{=1}^n  \\cfrac{y_i - b^{'}(\\theta_i)}{a_i(\\phi)} \\cfrac{\\partial \\theta_i}{\\partial \\beta_j}\n\\end{align}\\]Lưu ý rằng \\(\\mu_i = b^{'}(\\theta_i)\\), đo đó\n\\[\\begin{align}\n\\theta_i = (b^{'})^{-1}(\\mu_i) = (b^{'})^{-1}\\left(g^{-1}(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots \\beta_p \\cdot x_{,p})\\right)\n\\end{align}\\]\nđồng thời, đạo hàm của hàm ngược được của các hàm \\(b^{'}(\\cdot)\\) và \\(g(\\cdot)\\) được xác định như sau\n\\[\\begin{align}\n& \\left((b^{'})^{-1}\\right)^{'}(\\mu_i) = \\cfrac{1}{(b^{''}\\left((b^{'})^{-1}(\\mu_i)\\right)} = \\cfrac{1}{b^{''}(\\theta_i)} \\\\\n& (g^{-1}(\\psi_i))^{'} = \\cfrac{1}{(g^{'}(g^{-1}(\\psi_i))} =  \\cfrac{1}{g^{'}(\\mu_i)}\n\\end{align}\\]\nvới \\(\\psi_i = \\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots \\beta_p \\cdot x_{,p}\\).Như vậy, đạo hàm của \\(\\theta_i\\) theo \\(\\beta_j\\) được tính như sau\n\\[\\begin{align}\n\\cfrac{\\partial \\theta_i}{\\partial \\beta_j} = \\cfrac{\\partial (b^{'})^{-1}(g^{-1}(\\psi_i(\\beta_j)))}{\\partial \\beta_j} = \\cfrac{x_{,j}}{b^{''}(\\theta_i) \\cdot g^{'}(\\mu_i)}\n\\end{align}\\]Ta có đạo hàm của hàm Log-likelihood theo các tham số \\(\\beta_j\\)\n\\[\\begin{align}\n\\cfrac{\\partial l(\\textbf{y},\\beta)}{\\partial \\beta_j} = \\sum\\limits_{=1}^n  \\cfrac{(y_i - \\mu_i) \\cdot x_{,j}}{a_i(\\phi) \\cdot b^{''}(\\theta_i) \\cdot g^{'}(\\mu_i)}\n\\end{align}\\]Với lựa chọn \\(a_i(\\phi) = \\cfrac{\\phi}{\\omega_i}\\), phương sai của biến phụ thuộc là \\(a_i(\\phi) \\cdot b^{''}(\\theta_i)\\) nên ta có thể viết hàm Log-likelihood theo các tham số \\(\\beta_j\\) theo giá trị trung bình và phương sai của biến phụ thuộc\n\\[\\begin{align}\n\\cfrac{\\partial l(\\textbf{y},\\boldsymbol{\\beta})}{\\partial \\beta_j} &= \\sum\\limits_{=1}^n  \\cfrac{(y_i - \\mu_i) \\cdot x_{,j}}{\\mathbb{V}(y_i) \\cdot g^{'}(\\mu_i)} \\\\\n& = \\sum\\limits_{=1}^n w_i \\cfrac{(y_i - \\mu_i) \\cdot x_{,j}}{\\phi V(\\mu_i) \\cdot g^{'}(\\mu_i)} \\\\\n& =\\cfrac{1}{\\phi} \\sum\\limits_{=1}^n w_i \\cfrac{x_{,j}}{V(\\mu_i) \\cdot g^{'}(\\mu_i)} (y_i - \\mu_i)\n\\end{align}\\]\nCó thể thầy rằng:Thứ nhất, \\(\\beta_j\\) là nghiệm của phương trình \\(\\cfrac{\\partial l(\\textbf{y},\\beta)}{\\partial \\beta_j} = 0\\) sẽ không phụ thuộc vào giá trị của tham số phân tán \\(\\phi\\).Thứ nhất, \\(\\beta_j\\) là nghiệm của phương trình \\(\\cfrac{\\partial l(\\textbf{y},\\beta)}{\\partial \\beta_j} = 0\\) sẽ không phụ thuộc vào giá trị của tham số phân tán \\(\\phi\\).Thứ hai, giá trị của \\(\\mu_i\\) phụ thuộc vào giá trị của các biến độc lập \\(\\textbf{x}_i\\) và phụ thuộc vào các hệ số \\(\\boldsymbol{\\beta}\\), đó giá trị \\(\\cfrac{x_{,j}}{V(\\mu_i) \\cdot g^{'}(\\mu_i)}\\) không phụ thuộc hoàn toàn vào cách chúng ta xây dựng mô hình.Thứ hai, giá trị của \\(\\mu_i\\) phụ thuộc vào giá trị của các biến độc lập \\(\\textbf{x}_i\\) và phụ thuộc vào các hệ số \\(\\boldsymbol{\\beta}\\), đó giá trị \\(\\cfrac{x_{,j}}{V(\\mu_i) \\cdot g^{'}(\\mu_i)}\\) không phụ thuộc hoàn toàn vào cách chúng ta xây dựng mô hình.Thứ ba, giá trị \\(w_i\\) không phụ thuộc vào dữ liệu đó có thể được sử dụng linh hoạt để ước lượng mô hình có kết quả tốt nhất.Thứ ba, giá trị \\(w_i\\) không phụ thuộc vào dữ liệu đó có thể được sử dụng linh hoạt để ước lượng mô hình có kết quả tốt nhất.Giải hệ phương trình với ẩn là véc-tơ tham số \\(\\boldsymbol{\\beta}\\) như trên thường phải sử dụng các phương pháp giải số. Phương pháp thường được sử dụng là thuật toán Newton Raphson.Hàm glm() sử dụng xuyên suốt trong chương sách cho phép bạn đọc ước lượng mô hình tuyến tính tổng quát cho đa số các phân phối thường gặp của \\(Y_i\\). Tham số \\(weight\\) trong hàm glm() là véc-tơ tham số \\(w_i\\) như chúng ta đã trình bày ở trên. Lựa chọn giá trị cho \\(w_i\\) hoàn toàn cách tiếp cận của người xây dựng mô hình.Ví dụ 1: khi lựa chọn \\(Y_i\\) có phân phối Poisson với tham số \\(\\lambda_i = exp(\\theta_i)\\) và hàm liên kết là hàm \\(g(\\cdot) = log(\\cdot)\\). Chúng ta có \\((\\phi) = 1\\) đó \\(w_i = 1 \\forall \\).\n\\[\\begin{align}\n& g(\\mu_i) = log(\\mu_i) \\rightarrow g^{'}(\\mu_i) = 1/\\mu_i \\\\\n& b(\\theta) = exp(\\theta) \\rightarrow b^{'}(\\theta) = b^{''}(\\theta) = exp(\\theta) \\rightarrow (b^{'})^{-1}(\\theta) = \\log(\\theta) \\rightarrow V(\\theta) = b^{''}(b^{'})^{-1})(\\theta) = \\theta\n\\end{align}\\]\nĐạo hàm của hàm Log-likelihood theo \\(\\beta_j\\) trở thành\n\\[\\begin{align}\n\\sum\\limits_{=1}^n w_i \\cdot \\cfrac{x_{,j}}{\\phi V(\\mu_i) \\cdot g^{'}(\\mu_i)} (y_i - \\mu_i) &= \\sum\\limits_{=1}^n x_{,j} (y_i - \\mu_i) \\\\\n&= \\sum\\limits_{=1}^n x_{,j} \\left[y_i - \\exp(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots + \\beta_p \\cdot x_{,p})\\right]\n\\end{align}\\]\nhay nói một cách khác, véc-tơ tham số \\(\\beta\\) để tối đa hóa giá trị của hàm Log-likelihood là nghiệm của hệ phương trình\n\\[\\begin{align}\n\\sum\\limits_{=1}^n x_{,j} \\left[y_i - \\exp \\left(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots + \\beta_p \\cdot x_{,p} \\right) \\right] = 0 \\ \\forall j\n\\end{align}\\]Ví dụ 1: khi lựa chọn \\(Y_i\\) có phân phối Poisson với tham số \\(\\lambda_i = exp(\\theta_i)\\) và hàm liên kết là hàm \\(g(\\cdot) = log(\\cdot)\\). Chúng ta có \\((\\phi) = 1\\) đó \\(w_i = 1 \\forall \\).\n\\[\\begin{align}\n& g(\\mu_i) = log(\\mu_i) \\rightarrow g^{'}(\\mu_i) = 1/\\mu_i \\\\\n& b(\\theta) = exp(\\theta) \\rightarrow b^{'}(\\theta) = b^{''}(\\theta) = exp(\\theta) \\rightarrow (b^{'})^{-1}(\\theta) = \\log(\\theta) \\rightarrow V(\\theta) = b^{''}(b^{'})^{-1})(\\theta) = \\theta\n\\end{align}\\]\nĐạo hàm của hàm Log-likelihood theo \\(\\beta_j\\) trở thành\n\\[\\begin{align}\n\\sum\\limits_{=1}^n w_i \\cdot \\cfrac{x_{,j}}{\\phi V(\\mu_i) \\cdot g^{'}(\\mu_i)} (y_i - \\mu_i) &= \\sum\\limits_{=1}^n x_{,j} (y_i - \\mu_i) \\\\\n&= \\sum\\limits_{=1}^n x_{,j} \\left[y_i - \\exp(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots + \\beta_p \\cdot x_{,p})\\right]\n\\end{align}\\]\nhay nói một cách khác, véc-tơ tham số \\(\\beta\\) để tối đa hóa giá trị của hàm Log-likelihood là nghiệm của hệ phương trình\n\\[\\begin{align}\n\\sum\\limits_{=1}^n x_{,j} \\left[y_i - \\exp \\left(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots + \\beta_p \\cdot x_{,p} \\right) \\right] = 0 \\ \\forall j\n\\end{align}\\]Ví dụ 2: khi \\(Y_i\\) có phân phối Gamma với tham số \\(\\alpha\\), \\(\\gamma_i\\) chúng ta có \\(b(\\theta_i) = log(-\\theta_i)\\) với \\(\\theta_i = - \\cfrac{\\gamma_i}{\\alpha}\\) đồng thời \\((\\phi) = \\phi\\) đó \\(w_i = 1\\) \\(\\forall \\). Giả sử hàm liên kết được lựa chọn là hàm \\(log\\): \\(g(\\cdot) = log(\\cdot)\\).\n\\[\\begin{align}\n& g(\\mu_i) = log(\\mu_i) \\rightarrow g^{'}(\\mu_i) = 1/\\mu_i \\\\\n& b(\\theta_i) = log(-\\theta_i) \\rightarrow b^{'}(\\theta_i) = -1/\\theta_i \\rightarrow b^{''}(\\theta) = 1/\\theta^2 \\rightarrow (b^{'})^{-1}(\\theta) = -1/\\theta \\rightarrow V(\\mu) = b^{''}(b^{'})^{-1})(\\mu) = \\mu^2\n\\end{align}\\]\nĐạo hàm của hàm Log-likelihood theo \\(\\beta_j\\) trở thành\n\\[\\begin{align}\n\\sum\\limits_{=1}^n w_i \\cdot \\cfrac{x_{,j}}{\\phi V(\\mu_i) \\cdot g^{'}(\\mu_i)} (y_i - \\mu_i) &= \\sum\\limits_{=1}^n \\cfrac{x_{,j}}{\\mu_i} (y_i - \\mu_i)\n\\end{align}\\]\nvéc-tơ tham số \\(\\boldsymbol{\\beta}\\) để tối đa hóa giá trị của hàm Log-likelihood là nghiệm của hệ phương trình\n\\[\\begin{align}\n\\sum\\limits_{=1}^n x_{,j} \\left\\{y_i \\cdot \\exp\\left[-(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots + \\beta_p \\cdot x_{,p}) \\right] - 1 \\right\\} = 0 \\ \\forall j\n\\end{align}\\]Ví dụ 2: khi \\(Y_i\\) có phân phối Gamma với tham số \\(\\alpha\\), \\(\\gamma_i\\) chúng ta có \\(b(\\theta_i) = log(-\\theta_i)\\) với \\(\\theta_i = - \\cfrac{\\gamma_i}{\\alpha}\\) đồng thời \\((\\phi) = \\phi\\) đó \\(w_i = 1\\) \\(\\forall \\). Giả sử hàm liên kết được lựa chọn là hàm \\(log\\): \\(g(\\cdot) = log(\\cdot)\\).\n\\[\\begin{align}\n& g(\\mu_i) = log(\\mu_i) \\rightarrow g^{'}(\\mu_i) = 1/\\mu_i \\\\\n& b(\\theta_i) = log(-\\theta_i) \\rightarrow b^{'}(\\theta_i) = -1/\\theta_i \\rightarrow b^{''}(\\theta) = 1/\\theta^2 \\rightarrow (b^{'})^{-1}(\\theta) = -1/\\theta \\rightarrow V(\\mu) = b^{''}(b^{'})^{-1})(\\mu) = \\mu^2\n\\end{align}\\]\nĐạo hàm của hàm Log-likelihood theo \\(\\beta_j\\) trở thành\n\\[\\begin{align}\n\\sum\\limits_{=1}^n w_i \\cdot \\cfrac{x_{,j}}{\\phi V(\\mu_i) \\cdot g^{'}(\\mu_i)} (y_i - \\mu_i) &= \\sum\\limits_{=1}^n \\cfrac{x_{,j}}{\\mu_i} (y_i - \\mu_i)\n\\end{align}\\]\nvéc-tơ tham số \\(\\boldsymbol{\\beta}\\) để tối đa hóa giá trị của hàm Log-likelihood là nghiệm của hệ phương trình\n\\[\\begin{align}\n\\sum\\limits_{=1}^n x_{,j} \\left\\{y_i \\cdot \\exp\\left[-(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots + \\beta_p \\cdot x_{,p}) \\right] - 1 \\right\\} = 0 \\ \\forall j\n\\end{align}\\]Ví dụ 3: khi \\(Y_i\\) là số tiền bồi thường trung bình cho 1 tai nạn trong vòng 1 năm của một khách hàng, biết rằng khách hàng được bồi thường \\(n_i\\) lần trong năm và số tiền bồi thường của một vụ tai nạn là biến ngẫu nhiên \\(Y^*_i\\) phân phối Gamma với tham số \\(\\alpha\\), \\(\\beta_i\\). \\(Y_i\\) là giá trị trung bình của \\(n_i\\) biến phân phối Gamma độc lập với cùng tham số \\(\\alpha\\), \\(\\beta_i\\) nên \\(Y_i\\) sẽ có phân phối Gamma với tham số \\((n_i \\alpha)\\) và \\((n_i \\beta_i)\\). Khi viết \\(Y_i\\) dưới dạng phân phối kiểu mũ, chúng ta có \\(b(\\theta_i) = log(-\\theta_i)\\) với \\(\\theta_i = - \\cfrac{\\beta_i}{\\alpha}\\) và \\((\\phi) = \\phi/n_i\\). Véc-tơ tham số \\(\\boldsymbol{\\beta}\\) để tối đa hóa giá trị của hàm Log-likelihood là nghiệm của hệ phương trình\n\\[\\begin{align}\n\\sum\\limits_{=1}^n n_i \\cdot \\ x_{,j} \\cdot  \\left[y_i \\cdot \\exp\\left(-(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots + \\beta_p \\cdot x_{,p}) \\right) - 1 \\right] = 0 \\ \\forall j\n\\end{align}\\]Ví dụ 3: khi \\(Y_i\\) là số tiền bồi thường trung bình cho 1 tai nạn trong vòng 1 năm của một khách hàng, biết rằng khách hàng được bồi thường \\(n_i\\) lần trong năm và số tiền bồi thường của một vụ tai nạn là biến ngẫu nhiên \\(Y^*_i\\) phân phối Gamma với tham số \\(\\alpha\\), \\(\\beta_i\\). \\(Y_i\\) là giá trị trung bình của \\(n_i\\) biến phân phối Gamma độc lập với cùng tham số \\(\\alpha\\), \\(\\beta_i\\) nên \\(Y_i\\) sẽ có phân phối Gamma với tham số \\((n_i \\alpha)\\) và \\((n_i \\beta_i)\\). Khi viết \\(Y_i\\) dưới dạng phân phối kiểu mũ, chúng ta có \\(b(\\theta_i) = log(-\\theta_i)\\) với \\(\\theta_i = - \\cfrac{\\beta_i}{\\alpha}\\) và \\((\\phi) = \\phi/n_i\\). Véc-tơ tham số \\(\\boldsymbol{\\beta}\\) để tối đa hóa giá trị của hàm Log-likelihood là nghiệm của hệ phương trình\n\\[\\begin{align}\n\\sum\\limits_{=1}^n n_i \\cdot \\ x_{,j} \\cdot  \\left[y_i \\cdot \\exp\\left(-(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots + \\beta_p \\cdot x_{,p}) \\right) - 1 \\right] = 0 \\ \\forall j\n\\end{align}\\]","code":""},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"so-sánh-và-lựa-chọn-mô-hình-tuyến-tính-tổng-quát.","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.5 So sánh và lựa chọn mô hình tuyến tính tổng quát.","text":"Nắm được các nguyên tắc chung bạn đọc có thể tự xây dựng nhiều mô hình tuyến tính tổng quát khác nhau cho một dữ liệu cụ thể. Thách thức đặt ra là một mô hình liệu có thực sự có tốt hơn các mô hình khác, hay trong số các mô hình bạn lựa chọn mô hình nào là phù hợp nhất? Phần này của chương sẽ thảo luận về vấn đề sánh mô hình và lựa chọn mô hình. Các chỉ tiêu thống kê được sủ dụng để sánh mô hình sẽ xoay quanh giá trị của hàm hợp lý tối đa, bao gồm có thước đo deviance, chỉ tiêu AIC, AICC, hay BIC.","code":""},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"thước-đo-deviance","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.5.1 Thước đo deviance","text":"Thước đo được gọi là deviance thường được sử dụng để đánh giá và sánh các mô hình tuyến tính tổng quát có cùng phân phối của biến độc lập. Chỉ tiêu này được tính toán dựa trên giá trị hàm Log-likelihood. Khi \\(Y\\) là biến ngẫu nhiên trong nhóm các phân phối mũ, hàm log-likelihood được viết như sau\n\\[\\begin{align}\nl(\\textbf{y},\\theta) & = \\sum\\limits_{=1}^n  \\left(\\cfrac{y_i \\theta_i - b(\\theta_i)}{a_i(\\phi)} + c_i(y_i,\\phi)\\right)\n\\end{align}\\]\nvới \\(\\boldsymbol{\\theta}\\) là véc-tơ các tham số chính tắc, \\(\\boldsymbol{\\theta} = (\\theta_1, \\theta_2, \\cdots, \\theta_n)\\). Sau khi phân phối của \\(Y\\) và hàm liên kết được lựa chọn, chúng ta ước lượng được véc-tơ tham số \\(\\boldsymbol{\\beta}\\) là hệ số của các biến độc lập bằng cách tối đa hóa hàm log-likelihood. Sau khi đã xác định được véc-tơ tham số \\(\\boldsymbol{\\beta}\\), với mỗi lựa chọn cho phân phối của \\(Y\\) và hàm liên kết, chúng ta sẽ tính toán được các tham số chính tắc của mô hình tuyến tính tổng quát. Nếu hàm liên kết được lựa chọn là hàm liên kết chính tắc, \\(g(\\cdot) = (b^{'})^{-1}(\\cdot)\\), chúng ta có các tham số chính tắc chính là tổ hợp tuyến tính của các biến độc lập \\(\\boldsymbol{\\theta}^M = (\\theta^M_1, \\theta^M_2, \\cdots, \\theta^M_n)\\) với\n\\[\\begin{align}\n\\theta^M_i = \\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots + \\beta_p \\cdot x_{,p}\n\\tag{2.26}\n\\end{align}\\]Với mỗi lựa chọn cho mô hình tuyến tính tổng quát, bao gồm lựa chọn cho phân phối của \\(Y\\) và hàm liên kết \\(g\\), tạm gọi là mô hình \\(M\\), chúng ta gọi \\(l(\\textbf{y},\\boldsymbol{\\theta}^M)\\) là giá trị của hàm Log-likelihood tại tham số \\(\\boldsymbol{\\theta}^M\\) được xác định qua phương trình (2.26). Lưu ý rằng véc-tơ \\(\\boldsymbol{\\theta}^M\\) có độ dài là \\(n\\), bằng với kích thước của dữ liệu, tuy nhiên các tham số này được tính toán từ \\((p+1)\\) giá trị \\(\\beta\\) ước lượng được và giá trị của biến độc lập.Điều gì xảy ra nếu tham số chính tắc \\(\\boldsymbol{\\theta}\\) hoàn toàn tự và không phụ thuộc vào biến độc lập? Hàm Log-likelihood sẽ đạt giá trị cực đại tại \\(\\theta^S = (\\theta^S_1, \\theta^S_2, \\cdots, \\theta^S_n)\\) với \\(\\theta^S_i\\) là giá trị sao cho đạo hàm của hàm Log-likelihood tại \\(\\theta^S_i\\) bằng 0. \\(\\theta\\) hoàn toàn tự nên chỉ có thành phần thứ \\(\\) của hàm Log-likelihood phụ thuộc vào \\(\\theta^S_i\\)\n\\[\\begin{align}\n\\cfrac{\\partial l(\\textbf{y},\\theta)}{\\partial \\theta_i} & =  \\cfrac{y_i - b^{'}(\\theta_i)}{a_i(\\phi)}\n\\end{align}\\]\nCho đạo hàm của \\(l(\\textbf{y},\\theta)\\) theo \\(\\theta_i\\) bằng 0 chúng ta có \\(y_i - b^{'}(\\theta^S_i) = 0\\) hay \\(\\theta^S_i = (b^{'})^{-1}(y_i)\\).Bạn đọc lưu ý rằng giá trị hàm Log-likelihood đạt cực đại tại \\(\\boldsymbol{\\theta}^S\\) không có nghĩa là tham số \\(\\boldsymbol{\\theta}^S\\) là lựa chọn tốt nhất cho mô hình tuyến tính tổng quát bởi tham số có đến \\(n\\) bậc tự . \\(\\boldsymbol{\\theta}^S\\) cho chúng ta thông tin về giá trị cận trên của \\(l(\\textbf{y},\\theta)\\) khi \\(\\theta\\) thay đổi. Thước đo deviance của mô hình \\(M\\), ký hiệu \\(D*(y,\\theta^M)\\) được định nghĩa là hai lần khoảng cách từ \\(l(\\textbf{y},\\boldsymbol{\\theta}^M)\\) đến giá trị tối đa \\(l(\\textbf{y},\\boldsymbol{\\theta}^S)\\). Deviance của một mô hình cho biết mô hình được lựa chọn gần với phân phối quan sát được như thế nào, và mô hình có deviance càng nhỏ thì càng giải thích tốt hơn biến phụ thuộc\n\\[\\begin{align}\nD^{*}(y, \\theta^M) &= 2 \\left( l(\\textbf{y},\\theta^S) - l(\\textbf{y},\\theta^M) \\right) \\\\\n& = 2 \\sum\\limits_{=1}^n  \\cfrac{y_i (\\theta^S_i - \\theta^M_i) - (b(\\theta^S_i) - b(\\theta^M_i))}{a_i(\\phi)}\n\\end{align}\\]Trong trường hợp hàm \\(a_i(\\phi)\\) là tuyến tính theo \\(\\phi\\); \\(a_i(\\phi) = \\cfrac{\\phi}{w_i}\\), ta có\n\\[\\begin{align}\nD^{*}(y, \\theta^M) & = \\cfrac{1}{\\phi} \\sum\\limits_{=1}^n 2w_i \\cdot \\left[y_i (\\theta^S_i - \\theta^M_i) - (b(\\theta^S_i) - b(\\theta^M_i)) \\right]  = \\cfrac{D(y, \\theta^M)}{\\phi}\n\\end{align}\\]\nvới\n\\[\\begin{align}\nD(y, \\theta^M) & = \\sum\\limits_{=1}^n 2w_i \\cdot \\left[y_i (\\theta^S_i - \\theta^M_i) - (b(\\theta^S_i) - b(\\theta^M_i)) \\right]\n\\end{align}\\]\ntrong đó \\(D(y, \\theta^M)\\) là thước đo deviance bỏ qua ảnh hưởng của tham số dispersion \\(\\phi\\).Ví dụ 1: biến mục tiêu \\(Y_i\\) có phân phối chuẩn: \\(Y_i \\sim \\mathcal{N}(\\mu_i, \\sigma)\\) và hàm liên kết \\(g(x) = x\\). Có thể viết hàm mật độ của \\(Y_i\\) dưới dạng phân phối mũ như sau\n\\[\\begin{align}\nf(y, \\theta_i, \\phi) & = \\exp\\left[ \\cfrac{\\theta_i y - \\theta_i^2/2} {\\phi} - \\cfrac{y^2}{2\\phi} - \\cfrac{1}{2} log(2 \\pi \\phi) \\right]\n\\end{align}\\]\nvới \\(\\theta_i = \\mu_i\\) và \\(\\phi = \\sigma^2\\). Ta có \\(\\theta^S_i = (b^{'})^{-1}(y_i) = y_i\\), đó deviance tính trên quan sát \\(\\textbf{y}\\) được xác định như sau\n\\[\\begin{align}\nD(y, \\theta^M) & = \\sum\\limits_{=1}^n 2 \\cdot \\left[y_i (\\theta^S_i - \\theta^M_i) - (b(\\theta^S_i) - b(\\theta^M_i)) \\right] \\\\\n& = \\sum\\limits_{=1}^n (y_i - \\theta^M_i)^2 \\\\\n& = \\sum\\limits_{=1}^n \\left[y_i -  (\\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots + \\beta_p \\cdot x_{p,1}) \\right]^2\n\\end{align}\\]\nTrong trường hợp hồi quy tuyến tính thông thường, deviance chính là tổng bình phương sai số.Ví dụ 1: biến mục tiêu \\(Y_i\\) có phân phối chuẩn: \\(Y_i \\sim \\mathcal{N}(\\mu_i, \\sigma)\\) và hàm liên kết \\(g(x) = x\\). Có thể viết hàm mật độ của \\(Y_i\\) dưới dạng phân phối mũ như sau\n\\[\\begin{align}\nf(y, \\theta_i, \\phi) & = \\exp\\left[ \\cfrac{\\theta_i y - \\theta_i^2/2} {\\phi} - \\cfrac{y^2}{2\\phi} - \\cfrac{1}{2} log(2 \\pi \\phi) \\right]\n\\end{align}\\]\nvới \\(\\theta_i = \\mu_i\\) và \\(\\phi = \\sigma^2\\). Ta có \\(\\theta^S_i = (b^{'})^{-1}(y_i) = y_i\\), đó deviance tính trên quan sát \\(\\textbf{y}\\) được xác định như sau\n\\[\\begin{align}\nD(y, \\theta^M) & = \\sum\\limits_{=1}^n 2 \\cdot \\left[y_i (\\theta^S_i - \\theta^M_i) - (b(\\theta^S_i) - b(\\theta^M_i)) \\right] \\\\\n& = \\sum\\limits_{=1}^n (y_i - \\theta^M_i)^2 \\\\\n& = \\sum\\limits_{=1}^n \\left[y_i -  (\\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots + \\beta_p \\cdot x_{p,1}) \\right]^2\n\\end{align}\\]\nTrong trường hợp hồi quy tuyến tính thông thường, deviance chính là tổng bình phương sai số.Ví dụ 2: biến mục tiêu \\(Y_i\\) có phân phối Poisson \\(Y_i \\sim \\mathcal{P}(\\lambda_i)\\) và hàm liên kết \\(g(\\cdot) = log(\\cdot)\\).\n\\[\\begin{align}\nf(y; \\theta_i) = exp\\left[ \\cfrac{\\theta_i y - exp(\\theta_i)}{1} - log(\\Gamma(y+1)) \\right] \\text{ với } \\lambda_i = exp(\\theta_i)\n\\end{align}\\]\nTa có \\(\\theta^S_i = (b^{'})^{-1}(y_i) = log(y_i)\\), đó deviance tính trên quan sát \\(\\textbf{y}\\) được xác định như sau\n\\[\\begin{align}\nD(y, \\theta^M) & = \\sum\\limits_{=1}^n 2 \\cdot \\left[y_i (\\theta^S_i - \\theta^M_i) - (b(\\theta^S_i) - b(\\theta^M_i)) \\right] \\\\\n& = \\sum\\limits_{=1}^n 2 \\cdot \\left[y_i (log(y_i) - \\theta^M_i) - (y_i - exp(\\theta^M_i)) \\right] \\\\\n& = \\sum\\limits_{=1}^n 2 \\cdot \\left[y_i \\left(log(y_i) - log(\\mu^M_i)\\right) - (y_i - \\mu^M_i) \\right]\n\\end{align}\\]\nvới \\(\\mu^M_i = \\exp(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots + \\beta_p \\cdot x_{p,1})\\).Ví dụ 2: biến mục tiêu \\(Y_i\\) có phân phối Poisson \\(Y_i \\sim \\mathcal{P}(\\lambda_i)\\) và hàm liên kết \\(g(\\cdot) = log(\\cdot)\\).\n\\[\\begin{align}\nf(y; \\theta_i) = exp\\left[ \\cfrac{\\theta_i y - exp(\\theta_i)}{1} - log(\\Gamma(y+1)) \\right] \\text{ với } \\lambda_i = exp(\\theta_i)\n\\end{align}\\]\nTa có \\(\\theta^S_i = (b^{'})^{-1}(y_i) = log(y_i)\\), đó deviance tính trên quan sát \\(\\textbf{y}\\) được xác định như sau\n\\[\\begin{align}\nD(y, \\theta^M) & = \\sum\\limits_{=1}^n 2 \\cdot \\left[y_i (\\theta^S_i - \\theta^M_i) - (b(\\theta^S_i) - b(\\theta^M_i)) \\right] \\\\\n& = \\sum\\limits_{=1}^n 2 \\cdot \\left[y_i (log(y_i) - \\theta^M_i) - (y_i - exp(\\theta^M_i)) \\right] \\\\\n& = \\sum\\limits_{=1}^n 2 \\cdot \\left[y_i \\left(log(y_i) - log(\\mu^M_i)\\right) - (y_i - \\mu^M_i) \\right]\n\\end{align}\\]\nvới \\(\\mu^M_i = \\exp(\\beta_0 + \\beta_1 \\cdot x_{,1} + \\cdots + \\beta_p \\cdot x_{p,1})\\).Kết quả ước lượng khi sử dụng hàm glm() trong R hiển thị hai giá trị là Null deviance và Residual deviance. Null deviance được tính toán với giả thiết là chỉ có hệ số chặn \\(\\beta_0\\), còn Residual deviance được tính toán với véc-tơ \\(\\boldsymbol{\\beta}\\) đầy đủ.Giá trị Residual deviance ngoài sử dụng để sánh hai mô hình có cùng phân phối của biến phụ thuộc còn được sử dụng để lựa chọn biến trong mô hình. Giả sử hai mô hình \\(M1\\) và \\(M2\\) có cùng phân phối cho biến phụ thuộc và có cùng hàm liên kết \\(g(.)\\), mô hình \\(M1\\) có \\(m_1\\) biến độc lập trong khi mô hình \\(M_2\\) có \\(m_2\\) biến độc lập, bao gồm tất cả các biến độc lập của mô hình \\(M1\\). Nói một cách khác, \\(M_2\\) có nhiều hơn \\(M_1\\) là \\((m_2 - m_1)\\) biến độc lập. Mô hình \\(M_2\\) sẽ có deviance lớn hơn mô hình \\(M_1\\) có nhiều biến độc lập hơn, tuy nhiên việc thêm \\((m_2 - m_1)\\) biến độc lập vào mô hình có ý nghĩa thống kê nếu hiệu số giữa \\(D^*(y, \\theta^{M_2})\\) và \\(D^*(y, \\theta^{M_1})\\) là đủ lớn.Có thể chứng minh được rằng khi kích thước dữ liệu đủ lớn, hiệu số giữa \\(D^*(y, \\theta^{M_2})\\) và \\(D^*(y, \\theta^{M_1})\\) là một biến ngẫu nhiên phân phối xấp xỉ phân phối \\(\\chi^2\\) với bậc tự \\((m_2 - m_1)\\)\n\\[\\begin{align}\nD^{*}(y, \\theta^{M_1}) - D^{*}(y, \\theta^{M_2}) = 2 \\cdot \\log\\left( \\cfrac{L(y,\\theta^{M_2})}{L(y,\\theta^{M_1})} \\right) \\sim \\chi^2(m_2 - m_1)\n\\end{align}\\]Ví dụ 3: trong dữ liệu \\(exposure.csv\\), khi biến \\(Claim\\_Count\\) được giả thiết có phân phối Poisson và giá trị trung bình được giải thích bằng độ tuổi, hoặc giới tính của người được bảo hiểm, hoặc cả hai biến. Chúng ta gọi mô hình \\(M_1\\) là mô hình mà giá trị trung bình của biến phụ thuộc được giải thích bằng biến độ tuổi, mô hình \\(M_2\\) là mô hình mà giá trị trung bình của biến phụ thuộc được giải thích bằng cả biến giới tính, và mô hình \\(M_3\\) là mô hình mà biến phụ thuộc phụ thuộc vào cả độ tuổi và giới tính của khách hàng.Mô hình \\(M_1\\) và \\(M_2\\) đều chỉ có một biến độc lập và \\(M_1\\) có deviance nhỏ hơn \\(M_2\\) đó mô hình \\(M_1\\) tốt hơn \\(M_2\\). sánh mô hình \\(M_1\\) với 1 biến độc lập là age với mô hình \\(M_3\\) có 2 biến độc lập là age và \\(Gender\\) cần dựa trên kiểm định \\(\\chi^2\\). Ta có \\(D^{*}(y, \\theta^{M_1}) - D^{*}(y, \\theta^{M_2}) = 8324.2 - 8316.8 = 7.4\\). Giá trị 7.4 tương ứng với mức xác suất \\(0.994\\) của phân phối \\(\\chi^2(1)\\). Điều này có ý nghĩa là ở mức độ tin cậy 99%, có thể kết luận rằng thêm biến \\(Gender\\) vào mô hình \\(M_1\\) là có ý nghĩa thống kê, tuy nhiên việc thêm biến \\(Gender\\) lại không có ý nghĩa thống kê ở mức độ tin cậy \\(99.5\\%\\).","code":"\ndat<-read.csv(\"../KHDL_KTKD Final/Dataset/exposure.csv\")\n\nglm_M1<-glm(Claim_Count~Age, family = poisson(link=\"log\"), data = dat)\nglm_M2<-glm(Claim_Count~Gender, family = poisson(link=\"log\"), data = dat)\nglm_M3<-glm(Claim_Count~Age+Gender, family = poisson(link=\"log\"), data = dat)\n\nsummary(glm_M1)\nsummary(glm_M2)\nsummary(glm_M3)"},{"path":"mô-hình-tuyến-tính-tổng-quát..html","id":"giá-trị-hàm-log-likelihood-aic-và-bic","chapter":"Chương 2 Mô hình tuyến tính tổng quát.","heading":"2.5.2 Giá trị hàm log-likelihood, AIC và BIC","text":"Deviance là một thước đo hữu ích trong sánh các mô hình có cùng phân phối của biến phụ thuộc và hàm liên kết. Khi các mô hình cần sánh không có chung phân phối của biến phụ thuộc thì hiệu giữa hai hàm log-likelihood sẽ không có phân phối \\(\\chi^2\\) và khi đó việc sánh các mô hình là không thế thực hiện được.Trong phần trước, chúng ta đã định nghĩa \\(l(y,\\theta^M)\\) là giá trị tối đa của hàm log-likelihood cho mô hình M với tập hợp các biến độc lập đã lựa chọn. Nhìn chung, giá trị của \\(l(y,\\theta^M)\\) không cho biết nhiều thông tin về độ phù hợp của mô hình, nhưng người xây dựng mô hình thường mong muốn giá trị này càng lớn thì càng tốt. Tuy nhiên, có một vấn đề khi sánh trực tiếp giá trị \\(l(y,\\theta^M)\\) giữa các mô hình là: một mô hình bao gồm nhiều biến độc lập hơn thì rất có thể có giá trị \\(l(y,\\theta^M)\\) lớn hơn. Để giải quyết vấn đề này, có ba thước đo được điều chỉnh từ \\(l(y,\\theta^M)\\) thường được sử dụng cho mô hình tuyến tính tổng quát với mục đích đánh giá và sánh giữa các mô hình là AIC, AICC và BIC.Chỉ tiêu AIC, viết tắt của Akaike information criterion, là chỉ tiêu đơn giản nhất được tính toán từ công thức như sau\n\\[\\begin{align}\nAIC = 2 \\left(-l(y,\\theta^M)+r\\right)\n\\end{align}\\]\ntrong đó \\(r\\) là số lượng tham số cần ước lượng trong mô hình. Giá trị \\(AIC\\) càng nhỏ thì mô hình càng khớp hơn với dữ liệu.Chỉ tiêu AICC (hoặc AICs) được điều chỉnh từ AIC, được sử dụng khi kích thước dữ liệu không quá lớn để thay thế cho AIC, và được tính bởi công thức như sau\n\\[\\begin{align}\nAICC = AIC + \\cfrac{2r(r+1)}{n-r-1}\n\\end{align}\\]\nKhi kích thước dữ liệu \\(n\\) lớn, AIC và AICC sẽ tương đương nhau \\(\\cfrac{2r(r+1)}{n-r-1}\\) nhỏ.Chỉ tiêu thứ ba là BIC, là viết tắt của Bayesian information criterion. Trong một vài tài liệu BIC còn được gọi là SBC. Cũng giống như AIC và AICC, BIC là chỉ tiêu được tính toán từ giá trị cực đại của hàm log-likelihood điểu chỉnh để phản ánh số lượng tham số sử dụng trong mô hình là nhiều hay ít\n\\[\\begin{align}\nBIC = 2 \\left(-l(y,\\theta^M)+r log(n)\\right)\n\\end{align}\\]Cơ sở lý thuyết cho các chỉ tiêu AIC, AICC, và BIC bạn đọc có thể tìm thấy trong bất kỳ tài liệu thống kê toán nào, đó chúng tôi sẽ không trình bày trong cuốn sách này. Chúng tôi muốn nhấn mạnh vào góc độ ứng dụng của các chỉ tiêu này khi sử dụng để sánh các mô hình.Ví dụ 1: chúng ta quay trở lại dữ liệu “MotoInsurance.csv” khi biến mục tiêu \\(Y\\) chỉ nhận hai giá trị là '' hoặc 'Yes'. Biến \\(Y\\) có thể là biến dạng nhị phân hoặc vừa có thể là biến dạng đếm nếu chúng ta cho tương đương giá trị '' tương đương với 0 và giá trị 'Yes' tương ứng với 1. Khi xây dựng mô hình tuyến tính tổng quát, chúng ta có thể sử dụng phân phối Poisson cho biến mục tiêu với hàm liên kết \\(g(\\cdot) = log(\\cdot)\\).\\(Y\\) là biến nhị phân nên một cách tự nhiên, bạn đọc sẽ cân nhắc sử dụng phân phối nhị phân cho \\(Y\\). Chúng ta xây dựng mô hình tuyến tính tổng quát với phân phối nhị thức cho \\(Y\\) và hàm liên kết là hàm \\(logit\\). Thay vì sử dụng cả 4 biến độc lập, chúng ta chỉ sử dụng hai biến độc lập là age và sex,Tương tự như mô hình \\(glm.pois\\), mô hình \\(glm.binom.logit\\) cũng có tất cả các hệ số của biến độc lập khác 0. Làm thế nào để biết rằng mô hình \\(glm.pois\\) sử dụng phân phối Poisson với 4 biến độc lập hay mô hình \\(glm.binom.logit\\) với phân phối nhị thức cho \\(Y\\) và 2 biến độc lập là tốt hơn? Nếu chúng ta sử dụng thước đo deviance thì kết quả sẽ không chính xác vì các mô hình có phân phối của biến phụ thuộc khác nhau. Chỉ tiêu \\(AIC\\) được tính toán sẵn từ hàm \\(glm\\) có thể được sử dụng để sánh hai mô hình trong trường hợp này. Chỉ tiêu AIC của \\(glm.pois\\) là 5202.7 trong khi chỉ tiêu AIC của \\(glm.binom.logit\\) là 4941.3. Mô hình \\(glm.binom.logit\\) có AIC nhỏ hơn nên sẽ tốt hơn để mô hình hóa dữ liệu trong trường hợp này.Ví dụ 2: chúng ta sẽ tiếp tục với dữ liệu “MotoInsurance.csv”. Một cách tự nhiên, khi sử dụng phân phối nhị thức cho biến phụ thuộc, bạn đọc sử dụng hàm liên kết là hàm \\(logit\\). Liệu lựa chọn này có là tốt nhất để mô hình hóa dữ liệu mà chúng ta đang nghiên cứu? Bạn đọc có thể sử dụng chỉ tiêu AIC để lựa chọn hàm liên kết phù hợp. Chúng ta sẽ sử dụng 4 biến độc lập là age, sex, urban, và seniority để giải thích giá trị trung bình của biến phụ thuộc khi xây dựng mô hìnhMô hình \\(glm.binom.probit\\) có deviance và AIC nhỏ hơn \\(glm.binom.logit\\), điều này cho biết sử dụng hàm liên kết \\(probit\\) sẽ cho kết quả tốt hơn với hàm liên kết \\(logit\\).1. Annette J. Dobson Adrian G. Barnett (2018). Introduction Generalized Linear Models.2. Alan Agresti. (2015). Foundations Linear Generalized Linear Models.","code":"\ndat<-read.csv(\"../KHDL_KTKD Final/Dataset/MotoInsurance.csv\")\ndat$Y<-ifelse(dat$Y==\"Yes\",1,0)\ndat$sex<-as.factor(dat$sex)\ndat$urban<-as.factor(dat$urban)\nglm.pois<-glm(Y~age+sex+urban+seniority,data=dat, family = poisson(link = \"log\"))\nsummary(glm.pois)## \n## Call:\n## glm(formula = Y ~ age + sex + urban + seniority, family = poisson(link = \"log\"), \n##     data = dat)\n## \n## Coefficients:\n##              Estimate Std. Error z value Pr(>|z|)    \n## (Intercept) -0.286511   0.105615  -2.713  0.00667 ** \n## age         -0.034131   0.002546 -13.406  < 2e-16 ***\n## sexM        -0.491418   0.057331  -8.572  < 2e-16 ***\n## urban1       0.625032   0.053999  11.575  < 2e-16 ***\n## seniority    0.070888   0.004257  16.652  < 2e-16 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## (Dispersion parameter for poisson family taken to be 1)\n## \n##     Null deviance: 2938.1  on 3999  degrees of freedom\n## Residual deviance: 2418.7  on 3995  degrees of freedom\n## AIC: 5202.7\n## \n## Number of Fisher Scoring iterations: 5\ndat$Y<-as.factor(dat$Y) # đổi biến Y thành factor\nglm.binom.logit<-glm(Y~age+sex,data=dat, family = binomial(link = \"logit\"))\nsummary(glm.binom.logit)## \n## Call:\n## glm(formula = Y ~ age + sex, family = binomial(link = \"logit\"), \n##     data = dat)\n## \n## Coefficients:\n##              Estimate Std. Error z value Pr(>|z|)    \n## (Intercept)  1.109828   0.130876   8.480   <2e-16 ***\n## age         -0.026603   0.002709  -9.822   <2e-16 ***\n## sexM        -0.723479   0.076585  -9.447   <2e-16 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## (Dispersion parameter for binomial family taken to be 1)\n## \n##     Null deviance: 5163.3  on 3999  degrees of freedom\n## Residual deviance: 4935.3  on 3997  degrees of freedom\n## AIC: 4941.3\n## \n## Number of Fisher Scoring iterations: 4\nglm.binom.logit<-glm(Y~age+sex+seniority+urban,data=dat, family = binomial(link = \"logit\"))\nglm.binom.probit<-glm(Y~age+sex+seniority+urban,data=dat, family = binomial(link = \"probit\"))\nsummary(glm.binom.logit)## \n## Call:\n## glm(formula = Y ~ age + sex + seniority + urban, family = binomial(link = \"logit\"), \n##     data = dat)\n## \n## Coefficients:\n##              Estimate Std. Error z value Pr(>|z|)    \n## (Intercept)  0.793757   0.144541   5.492 3.98e-08 ***\n## age         -0.058754   0.003525 -16.668  < 2e-16 ***\n## sexM        -0.983040   0.085377 -11.514  < 2e-16 ***\n## seniority    0.133569   0.006808  19.618  < 2e-16 ***\n## urban1       1.174515   0.078060  15.046  < 2e-16 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## (Dispersion parameter for binomial family taken to be 1)\n## \n##     Null deviance: 5163.3  on 3999  degrees of freedom\n## Residual deviance: 4295.8  on 3995  degrees of freedom\n## AIC: 4305.8\n## \n## Number of Fisher Scoring iterations: 4\nsummary(glm.binom.probit)## \n## Call:\n## glm(formula = Y ~ age + sex + seniority + urban, family = binomial(link = \"probit\"), \n##     data = dat)\n## \n## Coefficients:\n##              Estimate Std. Error z value Pr(>|z|)    \n## (Intercept)  0.449579   0.085724   5.244 1.57e-07 ***\n## age         -0.034482   0.002009 -17.163  < 2e-16 ***\n## sexM        -0.577303   0.050821 -11.360  < 2e-16 ***\n## seniority    0.077888   0.003890  20.021  < 2e-16 ***\n## urban1       0.697759   0.046129  15.126  < 2e-16 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## (Dispersion parameter for binomial family taken to be 1)\n## \n##     Null deviance: 5163.3  on 3999  degrees of freedom\n## Residual deviance: 4292.4  on 3995  degrees of freedom\n## AIC: 4302.4\n## \n## Number of Fisher Scoring iterations: 5"}]
