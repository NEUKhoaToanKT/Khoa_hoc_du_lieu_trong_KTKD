<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chương 2 Nhập dữ liệu vào phần mềm R | Khoa Học Dữ Liệu trong Kinh tế và Kinh doanh</title>
<meta name="author" content="Nguyễn Quang Huy">
<meta name="description" content="Trong phần này của cuốn sách, bạn đọc sẽ được tìm hiểu về các kỹ thuật phân tích dữ liệu, bao gồm tiền xử lý dữ liệu, sắp xếp dữ liệu và trực quan hóa dữ liệu. Tiền xử lý dữ liệu bao gồm tất cả...">
<meta name="generator" content="bookdown 0.38 with bs4_book()">
<meta property="og:title" content="Chương 2 Nhập dữ liệu vào phần mềm R | Khoa Học Dữ Liệu trong Kinh tế và Kinh doanh">
<meta property="og:type" content="book">
<meta property="og:description" content="Trong phần này của cuốn sách, bạn đọc sẽ được tìm hiểu về các kỹ thuật phân tích dữ liệu, bao gồm tiền xử lý dữ liệu, sắp xếp dữ liệu và trực quan hóa dữ liệu. Tiền xử lý dữ liệu bao gồm tất cả...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chương 2 Nhập dữ liệu vào phần mềm R | Khoa Học Dữ Liệu trong Kinh tế và Kinh doanh">
<meta name="twitter:description" content="Trong phần này của cuốn sách, bạn đọc sẽ được tìm hiểu về các kỹ thuật phân tích dữ liệu, bao gồm tiền xử lý dữ liệu, sắp xếp dữ liệu và trực quan hóa dữ liệu. Tiền xử lý dữ liệu bao gồm tất cả...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Lora-0.4.9/font.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Source%20Code%20Pro:wght@400;450&amp;display=swap" rel="stylesheet">
<script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script>
        $(function() {
            $("#toc h2").html("Trong chương sách"); // Change text for "View source"
        });
    </script><script>
        document.addEventListener('DOMContentLoaded', function() {
            var viewSourceElement = document.getElementById('book-source');
            var editPageElement = document.getElementById('book-edit');
            var viewBookSourceElement = document.getElementById('book-repo');

            if (viewSourceElement) {
                viewSourceElement.innerText = 'Xem nguồn trang'; // Change text for "View source"
            }

            if (editPageElement) {
                editPageElement.innerText = 'Chỉnh sửa trang'; // Change text for "Edit this page"
            }

            if (viewBookSourceElement) {
                viewBookSourceElement.innerText = 'Xem nguồn sách'; // Change text for "View book source"
            }
        });
    </script><script>
        document.addEventListener('DOMContentLoaded', (event) => {
          var tocElement = document.querySelector('nav[aria-label="Table of contents"] h2');
          if (tocElement) {
            tocElement.textContent = 'Mục lục'; // Replace 'Mục lục' (Table of contents) with your desired text
          }
        });
    </script><script>
      document.addEventListener('DOMContentLoaded', (event) => {
        var tocElement = document.querySelector('nav[aria-label="Table of contents"] h2');
        if (tocElement) {
          tocElement.textContent = 'Trong chương này'; // Ensure "Trong chương này" text remains
        }
      });
    </script><script>
        document.addEventListener('DOMContentLoaded', (event) => {
          // Find the paragraph containing the original text and date
          const paragraph = document.querySelector('footer.bg-primary.text-light div.container div.row div.col-12.col-md-6.mt-3 p');

          if (paragraph) {
            // Extract the date using a regular expression
            const dateRegex = /(\d{4}-\d{2}-\d{2})/;
            const matches = paragraph.innerHTML.match(dateRegex);

            if (matches && matches.length > 1) {
              // Reformat the date from yyyy-mm-dd to dd/mm/yyyy
              const originalDate = matches[1];
              const [year, month, day] = originalDate.split('-');
              const newDate = `${day}/${month}/${year}`;

              // Replace the entire paragraph content with the new Vietnamese format
              paragraph.innerHTML = `"${paragraph.querySelector('strong').innerText}" được viết bởi ${paragraph.innerHTML.split('was written by ')[1].split('. ')[0]}. Phiên bản này được cập nhật lần cuối vào ${newDate}.`;
            }
          }
        });
    </script><script>
        document.addEventListener('DOMContentLoaded', (event) => {
          // Find the paragraph containing the specific text
          const paragraphs = document.querySelectorAll('footer.bg-primary.text-light div.container div.row div.col-12.col-md-6.mt-3 p');
          paragraphs.forEach(paragraph => {
            if(paragraph.innerHTML.includes('This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.')) {
              // Replace the paragraph content
              paragraph.innerHTML = 'Quyển sách này được viết bằng ngôn ngữ R, dựa trên gói lệnh bookdown.';
            }
          });
        });
    </script><script src="local_edit.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Khoa Học Dữ Liệu trong Kinh tế và Kinh doanh</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Lời nói đầu</a></li>
<li><a class="" href="gi%E1%BB%9Bi-thi%E1%BB%87u-chung.html"><span class="header-section-number">1</span> Giới thiệu chung</a></li>
<li><a class="active" href="nh%E1%BA%ADp-d%E1%BB%AF-li%E1%BB%87u-v%C3%A0o-ph%E1%BA%A7n-m%E1%BB%81m-r.html"><span class="header-section-number">2</span> Nhập dữ liệu vào phần mềm R</a></li>
<li><a class="" href="ti%E1%BB%81n-x%E1%BB%AD-l%C3%BD-d%E1%BB%AF-li%E1%BB%87u.html"><span class="header-section-number">3</span> Tiền xử lý dữ liệu</a></li>
<li><a class="" href="bi%E1%BA%BFn-%C4%91%E1%BB%95i-v%C3%A0-s%E1%BA%AFp-x%E1%BA%BFp-d%E1%BB%AF-li%E1%BB%87u.html"><span class="header-section-number">4</span> Biến đổi và sắp xếp dữ liệu</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/NEUKhoaToanKT/Khoa_hoc_du_lieu_trong_KTKD">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="nhập-dữ-liệu-vào-phần-mềm-r" class="section level1" number="2">
<h1>
<span class="header-section-number">Chương 2</span> Nhập dữ liệu vào phần mềm R<a class="anchor" aria-label="anchor" href="#nh%E1%BA%ADp-d%E1%BB%AF-li%E1%BB%87u-v%C3%A0o-ph%E1%BA%A7n-m%E1%BB%81m-r"><i class="fas fa-link"></i></a>
</h1>
<p>Trong phần này của cuốn sách, bạn đọc sẽ được tìm hiểu về các kỹ thuật phân tích dữ liệu, bao gồm tiền xử lý dữ liệu, sắp xếp dữ liệu và trực quan hóa dữ liệu.</p>
<ul>
<li>Tiền xử lý dữ liệu bao gồm tất cả các kỹ thuật biến đổi dữ liệu thô thành định dạng để có thể thực hiện phân tích. Dữ liệu thô bao gồm dữ liệu nhận được từ người khác hoặc dữ liệu mà người phân tích tự tìm kiếm từ các nguồn khác nhau.</li>
<li>Sắp xếp và tổ chức dữ liệu bao gồm các bước biến đổi, chuyển hóa dữ liệu thành định dạng để có thể trực quan hóa, thực hiện phân tích tính toán và xây dựng mô hình trên dữ liệu.</li>
<li>Trực quan hóa dữ liệu là một nghệ thuật biến đổi dữ liệu (thường được hiển thị dưới dạng các con số, chuỗi ký tự,…) thành các biểu đồ, đồ thị hay hình ảnh sử dụng hình dạng, màu sắc, khoảng cách để con người dễ dàng nhận thức và hiểu về dữ liệu. Trực quan hóa dữ liệu còn có thể giúp người phân tích tìm ra những giá trị ẩn chứa trong dữ liệu.</li>
</ul>
<p>Tuy nhiên, trước khi có thể bắt đầu bước tiền xử lý, chúng ta cần nhập dữ liệu vào R trước. Trong một vài trường hợp, nhập dữ liệu cần nhập chỉ đơn giản là một bảng Excel có sẵn. Trong một số trường hợp khác, quá trình nhập dữ liệu có thể phức tạp hơn, chẳng hạn như từ một (vài) phần nào đó trong một hoặc nhiều bảng Excel, hoặc từ một cơ sở dữ liệu được lưu trữ trong các máy tính server, hoặc đôi khi cần viết các vòng lặp để lấy dữ liệu từ các trình duyệt web. Đây là chủ đề mà chúng ta sẽ thảo luận trong chương đầu của phần phân tích dữ liệu.</p>
<div id="đối-tượng-dùng-để-lưu-dữ-liệu-trong-r" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Đối tượng dùng để lưu dữ liệu trong R<a class="anchor" aria-label="anchor" href="#%C4%91%E1%BB%91i-t%C6%B0%E1%BB%A3ng-d%C3%B9ng-%C4%91%E1%BB%83-l%C6%B0u-d%E1%BB%AF-li%E1%BB%87u-trong-r"><i class="fas fa-link"></i></a>
</h2>
<p>Hai kiểu đối tượng thường được dùng để lưu dữ liệu trong R là <span style="color: #640514; font-family: Source Code Pro;">data.frame</span> và tibble. Chúng ta sẽ thảo luận về <span style="color: #640514; font-family: Source Code Pro;">data.frame</span> trước vì đây là kiểu lưu dữ liệu phổ biến và xuất hiện trước. Đối tượng kiểu tibble, với một vài ưu điểm hơn <span style="color: #640514; font-family: Source Code Pro;">data.frame</span>, sẽ được thảo luận trong phần tiếp theo.</p>
<div id="data.frame-là-gì" class="section level3" number="2.1.1">
<h3>
<span class="header-section-number">2.1.1</span> <span style="color: #640514; font-family: Source Code Pro;">data.frame</span> là gì?<a class="anchor" aria-label="anchor" href="#data.frame-l%C3%A0-g%C3%AC"><i class="fas fa-link"></i></a>
</h3>
<p><span style="color: #640514; font-family: Source Code Pro;">data.frame</span> là đối tượng phổ biến nhất để lưu trữ dữ liệu trên môi trường làm việc của R. Hiểu một cách đơn giản, một <span style="color: #640514; font-family: Source Code Pro;">data.frame</span> giống như một bảng excel mà mỗi cột tương ứng với một véc-tơ và mỗi dòng tương ứng với một quan sát. Ngay khi cài đặt R, đã có nhiều đối tượng là dữ liệu kiểu đã được lưu trữ trong R và đã sẵn sàng được sử dụng mà không cần gọi thư viện bổ sung. Để biết trên cửa sổ Rstudio đang sử dụng có những dữ liệu nào, bạn đọc sử dụng câu lệnh <code><a href="https://rdrr.io/r/utils/data.html">data()</a></code></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Bạn đọc có thể thấy trên cửa sổ <span class="math inline">\(script\)</span> xuất hiện một cửa sổ mới với danh sách tất cả các dữ liệu sẵn có trong R và những dữ liệu sẵn có trong các thư viện được cài đặt thêm đang được gọi ra trên cửa sổ làm việc. Để biết trong một thư viện đang được gọi ra trên cửa sổ Rstudio có những dữ liệu nào, bạn đọc có thể sử dụng lệnh <code><a href="https://rdrr.io/r/utils/data.html">data()</a></code> kèm với tùy chọn <code>package</code> như sau:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dslabs</span><span class="op">)</span> <span class="co"># Gọi thư viện dslabs </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"dslabs"</span><span class="op">)</span> <span class="co"># Liệt kê những data trong dslabs</span></span></code></pre></div>
<p>Trong danh sách dữ liệu của thư viện <span class="math inline">\(\textf{dslabs}\)</span>, bạn đọc có thể thấy một đối tượng có tên <span class="math inline">\(\textbf{murders}\)</span>. Đây là một . Thật vậy, bạn đọc có thể kiểm tra kiểu của đối tượng này bằng hàm <code><a href="https://rdrr.io/r/base/class.html">class()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">murders</span><span class="op">)</span> <span class="co"># Trả lại kết quả là một data frame</span></span></code></pre></div>
<pre><code>## [1] "data.frame"</code></pre>
<p>Thông thường để có hiểu biết ban đầu về một đối tượng kiểu , bạn đọc nên bắt đầu bằng đọc mô tả về dữ liệu (nếu có) bằng cách sử dụng <code>?</code> nếu đây là một dữ liệu có sẵn trong các thư viện của R:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span> <span class="va">murders</span> <span class="co"># Cửa sổ help sẽ hiển thị mô tả về murders</span></span></code></pre></div>
<p>Nhóm các câu lệnh dưới đây giúp bạn đọc hiểu được cấu trúc của dữ liệu trong một :</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/View.html">View</a></span><span class="op">(</span><span class="va">murders</span><span class="op">)</span> <span class="co"># Hiển thị data.frame dưới dạng bảng </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">murders</span>,k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># Hiển thị k dòng đầu tiên của data.frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">murders</span><span class="op">)</span> <span class="co"># Hiển thị cấu trúc của data.frame</span></span></code></pre></div>
<ul>
<li><p>Hàm <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> hiển thị nhanh các dòng đầu tiên của dữ liệu cho bạn đọc cái nhìn ban đầu, tuy nhiên hàm <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> không hiệu quả khi dữ liệu có nhiều cột.</p></li>
<li><p>Hàm <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code> cho hiển thị về dữ liệu dễ nhìn nhất. Hàm <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code> có hạn chế khi dữ liệu có quá nhiều dòng hoặc nhiều cột và thời gian hiển thị lâu hơn so với <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p></li>
<li><p>Hàm <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> là cách hiển thị dữ liệu một cách tổng quát và hiệu quả hơn so với <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> hoặc <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code>. Kết quả từ hàm <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> với dữ liệu <span class="math inline">\(\textbf{murders}\)</span> cho thấy đây là một dữ liệu dạng bảng với 5 cột (còn gọi là variables) và 51 dòng (còn gọi là observations). Ngoài ra, sử dụng hàm <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> bạn đọc có thể thấy được kiểu dữ liệu của từng cột; chẳng hạn như cột state là cột chứa dữ liệu kiểu chuỗi ký tự; cột region có kiểu dữ liệu là factor,…</p></li>
</ul>
<p>Một hàm số hiệu quả khác thường được sử dụng để bạn đọc có cái nhìn tổng quan về dữ liệu là hàm <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>. Chúng ta có thể quan sát kết quả khi sử dụng hàm <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> với dữ liệu <span class="math inline">\(\textbf{murders}\)</span> như sau</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">murders</span><span class="op">)</span></span></code></pre></div>
<pre><code>##     state               abb                      region     population      
##  Length:51          Length:51          Northeast    : 9   Min.   :  563626  
##  Class :character   Class :character   South        :17   1st Qu.: 1696962  
##  Mode  :character   Mode  :character   North Central:12   Median : 4339367  
##                                        West         :13   Mean   : 6075769  
##                                                           3rd Qu.: 6636084  
##                                                           Max.   :37253956  
##      total       
##  Min.   :   2.0  
##  1st Qu.:  24.5  
##  Median :  97.0  
##  Mean   : 184.4  
##  3rd Qu.: 268.0  
##  Max.   :1257.0</code></pre>
<p>Hàm <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> cho biết thông chi tiết hơn về giá trị trong mỗi cột.</p>
<ul>
<li><p>Cột state và cột abb là cột mà giá trị trong đó là kiểu chuỗi ký tự;</p></li>
<li><p>Cột region là kiểu factor, có thể nhận một trong bốn giá trị là Northeast, South, North Central, hoặc West và cho biết mỗi giá trị xuất hiện bao nhiêu lần trong cột dữ liệu.</p></li>
<li><p>Các cột population và total là các cột kiểu số. Chúng ta có thể thấy các giá trị lớn nhất, nhỏ nhất, giá trị trung bình và các giá trị tứ phân vị. Bạn đọc có thể hình dung ra phân phối của các giá trị trong cột giá trị kiểu số.</p></li>
<li><p>Trong trường hợp cột có giá trị không quan sát được, hàm <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> cũng sẽ cho biết có bao nhiêu giá trị này trong mỗi cột.</p></li>
</ul>
<p>Để lấy ra một cột dữ liệu của một chúng ta sử dụng <span class="math inline">\(\$\)</span>. Chẳng hạn như để lấy giá trị cột population của dữ liệu murders:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">murders</span><span class="op">$</span><span class="va">population</span> <span class="co"># in ra màn hình cột population của data.frame murders</span></span></code></pre></div>
<p>Như chúng tôi đã đề cập, kiểu dữ liệu của cột <span class="math inline">\(region\)</span> là kiểu <span class="math inline">\(factor\)</span>. Về bản chất, véc-tơ kiểu <span class="math inline">\(factor\)</span> là một véc-tơ kiểu chuỗi ký tự nhưng được lưu theo một cách hiệu quả hơn, tiết kiệm bộ nhớ, và thuận lợi cho người sử dụng khi phân tích dữ liệu.</p>
<ul>
<li>Véc-tơ kiểu factor sẽ tương ứng với véc-tơ kiểu chuỗi ký tự nhưng được lưu dưới dạng vec-tơ số tự nhiên, bắt đầu từ 1 đến số lượng chuỗi ký tự khác biệt xuất hiện trong véc-tơ và mỗi chuỗi ký tự sẽ được cho tương ứng với một số tự nhiên. Các lưu này hiệu quả hơn về bộ nhớ khi làm việc với các véc-tơ kiểu chuỗi ký tự nếu có nhiều chuỗi ký tự bị lặp lại trong véc-tơ. Để biết một vec-tơ dạng factor có bao nhiêu giá trị riêng biệt, mỗi giá trị riêng biệt được cho tương ứng với số tự nhiên nào, và mỗi giá trị riêng biệt được lặp lại bao nhiêu lần trong véc-tơ, bạn đọc sử dụng hàm <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> hoặc hàm <code><a href="https://rdrr.io/r/base/table.html">table()</a></code>
</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># summary(murders$region) # Tổng hợp thông tin của vec-tơ dạng factor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">murders</span><span class="op">$</span><span class="va">region</span><span class="op">)</span> <span class="co"># cho kết quả tương tự như summary</span></span></code></pre></div>
<pre><code>## 
##     Northeast         South North Central          West 
##             9            17            12            13</code></pre>
<p>Kết quả từ hàm <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> cho thấy cột <span class="math inline">\(region\)</span> có 4 giá trị; cách cho tương ứng mỗi chuỗi ký tự với các số lần lượt là <span class="math inline">\(Northeast \rightarrow 1\)</span> ; <span class="math inline">\(South \rightarrow 2\)</span>; <span class="math inline">\(North Central \rightarrow 3\)</span>, và <span class="math inline">\(West \rightarrow 4\)</span>; tần suất xuất hiện của mỗi giá trị cũng được cho trong bảng: có 9 giá trị <span class="math inline">\(Northeast\)</span>, có 17 giá trị <span class="math inline">\(South\)</span>, có 12 giá trị <span class="math inline">\(North Central\)</span>, và 13 giá trị <span class="math inline">\(West\)</span>.</p>
<p>Một lưu ý khác khi sử dụng véc-tơ kiểu factor thay vì kiểu chuỗi ký tự nghĩa là bạn đọc đang định nghĩa dữ liệu là kiểu biến rời rạc hay các biến định tính. Các biến này có thể trực tiếp đưa vào các mô hình và không cần thực hiện thêm biến đổi nào khác.</p>
<p>Trong hầu hết các trường hợp, bạn đọc sẽ dùng R để xử lý dữ liệu từ nguồn ngoài vào. Chúng ta sẽ sử dụng các hàm có sẵn trong R đọc dữ liệu và kết quả đầu ra của hàm này sẽ là các <span style="color: #640514; font-family: Source Code Pro;">data.frame</span>. Trong một vài trường hợp, bạn đọc sẽ phải tự tạo <span style="color: #640514; font-family: Source Code Pro;">data.frame</span>. Câu lệnh để tạo một <span style="color: #640514; font-family: Source Code Pro;">data.frame</span> (tên <span class="math inline">\(df\)</span>) với các cột có tên lần lượt là <span class="math inline">\(id\)</span>, <span class="math inline">\(names\)</span>, <span class="math inline">\(grades\)</span>, và <span class="math inline">\(result\)</span> được viết như sau:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> <span class="co"># Hàm data.frame() dùng để tạo data.frame tên df</span></span>
<span>      id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SV"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="co"># Cột có tên là ID nhận giá trị "SV1",...,"SV5"</span></span>
<span>      names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"You"</span>, <span class="st">"Me"</span>, <span class="st">"Him"</span>, <span class="st">"Her"</span>, <span class="st">"John"</span><span class="op">)</span>, <span class="co"># Cột names</span></span>
<span>      grades <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5.5</span>, <span class="fl">1.5</span>, <span class="fl">10.0</span>, <span class="fl">9.0</span>, <span class="fl">7.6</span><span class="op">)</span>, <span class="co"># Cột grades</span></span>
<span>      result <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>,<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co"># Cột result</span></span></code></pre></div>
<p>Đối tượng kiểu <span style="color: #640514; font-family: Source Code Pro;">data.frame</span> có một vài nhược điểm khi sử dụng để lưu dữ liệu từ các nguồn khác nhau vào R. Do đó kiểu đối tượng mới được phát triển để khắc phục các nhược điểm này, đó là <span class="math inline">\(tibble\)</span>. Phần tiếp theo chúng ta sẽ thảo luận về đối tượng này.</p>
</div>
<div id="tibble-là-một-cải-tiến-của-data.frame" class="section level3" number="2.1.2">
<h3>
<span class="header-section-number">2.1.2</span> <span class="math inline">\(tibble\)</span> là một cải tiến của <span style="color: #640514; font-family: Source Code Pro;">data.frame</span>?<a class="anchor" aria-label="anchor" href="#tibble-l%C3%A0-m%E1%BB%99t-c%E1%BA%A3i-ti%E1%BA%BFn-c%E1%BB%A7a-data.frame"><i class="fas fa-link"></i></a>
</h3>
<p>Về cơ bản một <span class="math inline">\(tibble\)</span> là cũng có thể hiểu là một <span style="color: #640514; font-family: Source Code Pro;">data.frame</span> với một vài điều chỉnh để giúp việc lấy dữ liệu từ nguồn bên ngoài vào và phân tích trở nên dễ dàng hơn. Thực tế thì ở mức độ phân tích dữ liệu thông thường, sự khác khác nhau giữa <span class="math inline">\(tibble\)</span> và <span style="color: #640514; font-family: Source Code Pro;">data.frame</span> là không đáng kể. Để liệt kê ra sự khác nhau cơ bản giữu hai đối tượng này thì có thể kể đến:</p>
<ul>
<li>Thứ nhất: khi in một <span class="math inline">\(tibble\)</span> ra màn hình sẽ chỉ có 10 dòng đầu được hiển thị và số lượng cột của một <span class="math inline">\(tibble\)</span> luôn luôn khớp với kích thước cửa sổ R Console, đồng thời kiểu dữ liệu của mỗi cột sẽ được hiển thị ngay dưới tên cột</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span></span>
<span><span class="va">trump_tweets</span> <span class="co"># in một data frame ra màn hình sẽ không hiệu quả</span></span>
<span><span class="co"># Hàm as_tibble đổi data.frame sang tibble</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">trump_tweets</span><span class="op">)</span> <span class="co"># Hiển thị 1 tibble hiệu quả hơn.</span></span></code></pre></div>
<ul>
<li><p>Thứ hai: khi lấy dữ liệu từ bên ngoài vào trong R, <span class="math inline">\(tibble\)</span> không đổi tên cột dù tên cột không phải là kiểu tên được phép trong R. Đồng thời, khi tạo một <span class="math inline">\(tibble\)</span>, bạn đọc có thể đặt tên cột là một kiểu tên không được phép sử dụng với tên biến thông thường.</p></li>
<li><p>Cuối cùng, khi dữ liệu từ bên ngoài được lưu vào một <span class="math inline">\(tibble\)</span>, kiểu dữ liệu sẽ không thay đổi.</p></li>
</ul>
<p>Để tạo một <span class="math inline">\(tibble\)</span>, bạn đọc có thể sử dụng hàm <code><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble()</a></code>. Bạn đọc có thể tạo ra một dữ liệu có 3 cột mà tên các cột đều không thể được sử dụng làm tên biến trong R như sau</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tib</span><span class="op">&lt;-</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span> <span class="co"># hàm tibble dùng để tạo tibble</span></span>
<span>  <span class="st">":D"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="co"># có thể dùng tên cột là ":D"</span></span>
<span>  <span class="st">":p"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="st">"Y"</span>,<span class="st">"Z"</span><span class="op">)</span>, <span class="co"># có thể dùng tên cột là ":p"</span></span>
<span>  <span class="st">"1"</span> <span class="op">=</span> <span class="fl">2</span> <span class="co"># có thể dùng tên cột là "1"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">tib</span></span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##    `:D` `:p`    `1`
##   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
## 1     1 X         2
## 2     2 Y         2
## 3     3 Z         2</code></pre>
<p>Nếu thay thế đoạn lệnh trên bằng hàm <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> thì hàm <span style="color: #640514; font-family: Source Code Pro;">data.frame</span> được tạo thành sẽ tự động thay đổi tên cột</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> <span class="co"># tạo data.frame thay vì tibble</span></span>
<span>  <span class="st">":D"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="co"># data.frame sẽ đổi tên cột cho phù hợp</span></span>
<span>  <span class="st">":p"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="st">"Y"</span>,<span class="st">"Z"</span><span class="op">)</span>, <span class="co"># data.frame sẽ đổi tên cột cho phù hợp</span></span>
<span>  <span class="st">"1"</span> <span class="op">=</span> <span class="fl">2</span> <span class="co"># data.frame sẽ đổi tên cột cho phù hợp</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="co"># hãy quan sát xem tên cột của df thay đổi như thế nào</span></span></code></pre></div>
<pre><code>##   X.D X.p X1
## 1   1   X  2
## 2   2   Y  2
## 3   3   Z  2</code></pre>
<p>Bạn đọc có thể thấy rằng dữ liệu có tên <span class="math inline">\(df\)</span> nếu được lưu dưới dạng <span style="color: #640514; font-family: Source Code Pro;">data.frame</span> thì tên các cột đã được tự động thay đổi cho thích hợp với tên biến. Những điểm khác nhau giữa <span class="math inline">\(tibble\)</span> và <span style="color: #640514; font-family: Source Code Pro;">data.frame</span> sẽ được tiếp tục thảo luận ở các phần tiếp theo khi chúng tôi giới thiệu về các hàm dùng để nhập dữ liệu vào R.</p>
</div>
</div>
<div id="nhập-dữ-liệu-bằng-hàm-sẵn-có." class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Nhập dữ liệu bằng hàm sẵn có.<a class="anchor" aria-label="anchor" href="#nh%E1%BA%ADp-d%E1%BB%AF-li%E1%BB%87u-b%E1%BA%B1ng-h%C3%A0m-s%E1%BA%B5n-c%C3%B3."><i class="fas fa-link"></i></a>
</h2>
Danh sách các hàm sẵn có trong R và kiểu dữ liệu tương ứng có thể nhập được liệt kê trong các bảng <a href="#tab:tbptdl001"><strong>??</strong></a>
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
(#tab:tbptdl001 )(#tab:tbptdl001 )Danh sách hàm có sẵn để lấy dữ liệu từ nguồn bên ngoài
</caption>
<thead><tr>
<th style="text-align:left;">
Hàm số
</th>
<th style="text-align:left;">
Sử dụng trong trường hợp
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
read.table()
</td>
<td style="text-align:left;">
Đọc các file có đuôi dạng .txt
</td>
</tr>
<tr>
<td style="text-align:left;">
read.csv()
</td>
<td style="text-align:left;">
file dạng csv mà giá trị được ngăn cách bằng dấu ‘,’
</td>
</tr>
<tr>
<td style="text-align:left;">
read.csv2()
</td>
<td style="text-align:left;">
file dạng csv mà giá trị được ngăn cách bằng dấu ‘;’
</td>
</tr>
<tr>
<td style="text-align:left;">
read.delim()
</td>
<td style="text-align:left;">
Các file dạng text, các giá trị cách nhau bởi ký tự mà bạn đọc định nghĩa
</td>
</tr>
<tr>
<td style="text-align:left;">
readRDS()
</td>
<td style="text-align:left;">
Dữ liệu được lưu dưới dạng .rds
</td>
</tr>
<tr>
<td style="text-align:left;">
load()
</td>
<td style="text-align:left;">
Dữ liệu kiểu data có sẵn trong R
</td>
</tr>
</tbody>
</table></div>
<p>Khi lấy dữ liệu từ các nguồn bên ngoài vào bằng các câu lệnh có sẵn, tên của các cột dữ liệu có thể bị thay đổi do một số tên cột không thể được dùng để đặt tên của <span style="color: #640514; font-family: Source Code Pro;">data.frame</span>. Do đó, bạn đọc hãy luôn kiểm tra lại tên các cột dữ liệu sau khi đọc. Hàm <code><a href="https://rdrr.io/r/base/names.html">names()</a></code> cho biết tên các cột của một <span style="color: #640514; font-family: Source Code Pro;">data.frame</span>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span>header <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>              text <span class="op">=</span> <span class="st">"@1,@2 </span></span>
<span><span class="st">                      1,2 </span></span>
<span><span class="st">                      3,4"</span><span class="op">)</span> <span class="co"># sử dụng read.csv để đọc đoạn text</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="co"># hiển thị tên của các cột</span></span></code></pre></div>
<pre><code>## [1] "X.1" "X.2"</code></pre>
<p>Để đổi tên của <span style="color: #640514; font-family: Source Code Pro;">data.frame</span> ở trên, bạn đọc cần gán <span class="math inline">\(names(df)\)</span> bằng một véc-tơ chứa tên các cột. Hãy đảm bảo rằng độ dài của vec-tơ chứa tên cột bằng số cột của <span style="color: #640514; font-family: Source Code Pro;">data.frame</span></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"@1"</span>,<span class="st">"@2"</span><span class="op">)</span> <span class="co"># đổi tên 2 cột của data.frame df</span></span>
<span><span class="va">df</span> <span class="co"># in data.frame df</span></span></code></pre></div>
<pre><code>##   @1 @2
## 1  1  2
## 2  3  4</code></pre>
</div>
<div id="nhập-dữ-liệu-bằng-thư-viện-textbfreadr." class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Nhập dữ liệu bằng thư viện <span class="math inline">\(\textbf{readr}\)</span>.<a class="anchor" aria-label="anchor" href="#nh%E1%BA%ADp-d%E1%BB%AF-li%E1%BB%87u-b%E1%BA%B1ng-th%C6%B0-vi%E1%BB%87n-textbfreadr."><i class="fas fa-link"></i></a>
</h2>
<p>Các câu lệnh để đọc dữ liệu của thư viện <span class="math inline">\(readr\)</span> tương tự như các câu lệnh sẵn có, nhưng đặc biệt hiệu quả hơn về thời gian đọc dữ liệu. Chẳng hạn như hàm số dùng để đọc các file định dạng <span class="math inline">\(csv\)</span> trong thư viện <span class="math inline">\(readr\)</span> là hàm <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> được dùng thay thế cho <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> khi chúng ta cần đọc các file có dung lượng lớn. Để so sánh thời gian đọc dữ liệu của hàm <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> và hàm <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> bạn đọc có thể thực hiện ví dụ sau: chúng ta sẽ tạo hai file dữ liệu bao gồm <code>test1.csv</code> và <code>test2.csv</code> là các file chứa các số được sinh ngẫu nhiên. Dữ liệu <code>test1.csv</code> có <span class="math inline">\(10^2\)</span> hàng và <span class="math inline">\(10^4\)</span> cột trong khi dữ liệu <code>test2.csv</code> có <span class="math inline">\(10^2\)</span> hàng và <span class="math inline">\(10^5\)</span> cột. Các dữ liệu này có thể được tạo và lưu bằng các câu lệnh dưới đây:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span><span class="op">)</span>,<span class="fl">10</span><span class="op">^</span><span class="fl">2</span>,<span class="fl">10</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span> <span class="co"># Ma trận 100 hàng, 10^4 cột</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">x</span>,<span class="st">"test1.csv"</span><span class="op">)</span> <span class="co"># Ma tran thanh file .csv</span></span>
<span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">7</span><span class="op">)</span>,<span class="fl">10</span><span class="op">^</span><span class="fl">2</span>,<span class="fl">10</span><span class="op">^</span><span class="fl">5</span><span class="op">)</span> <span class="co"># Ma trận 100 hàng, 10^5 cột</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">x</span>,<span class="st">"test2.csv"</span><span class="op">)</span> <span class="co"># Ma tran thanh file .csv</span></span></code></pre></div>
<p>Bạn đọc có thể kiểm tra kích thước của các file <span class="math inline">\(test1.csv\)</span> và <span class="math inline">\(test2.csv\)</span> trên máy tính để thấy rằng dung lượng của các file lần lượt là 18 Mega byte và 180 Mega byte. Chúng ta sẽ kiểm tra thời gian mà các hàm <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> và <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> nhập dữ liệu đối với dữ liệu test1.csv trước:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">start</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html">proc.time</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># lưu lại thời điểm trước khi chạy read.csv</span></span>
<span><span class="va">dat</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"test1.csv"</span><span class="op">)</span> <span class="co"># dùng hàm read.csv để load dữ liệu </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html">proc.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">start</span> <span class="co"># tính thời gian hàm read.csv chạy</span></span>
<span></span>
<span><span class="va">start</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html">proc.time</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># lưu lại thời điểm trước khi chạy read_csv</span></span>
<span><span class="va">dat</span><span class="op">&lt;-</span><span class="fu">read_csv</span><span class="op">(</span><span class="st">"test1.csv"</span><span class="op">)</span> <span class="co"># dùng hàm read_csv để load dữ liệu </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html">proc.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">start</span> <span class="co"># tính thời gian hàm read_csv chạy</span></span></code></pre></div>
<p>Đối với dữ liệu <code>test1.csv</code> thì thời gian nhập dữ liệu của <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> có nhanh hơn nhưng không có sự khác biệt đáng kể. Tuy nhiên sự khác biệt sẽ rõ ràng khi nhập dữ liệu <span class="math inline">\(test2.csv\)</span>. Bạn đọc cân nhắc khi dùng hàm <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> đọc dữ liệu bởi thời gian nhập dữ liệu với những file có dung lượng hơn 100 Mega bytes có thể lên đến hơn 20 phút.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">start</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html">proc.time</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># lưu lại thời điểm trước khi chạy read.csv</span></span>
<span><span class="va">dat</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"test2.csv"</span><span class="op">)</span> <span class="co"># !!! THỜI GIAN CHẠY CÓ THỂ LÊN ĐẾN 20-25 phút</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html">proc.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">start</span> <span class="co"># tính thời gian hàm read.csv chạy</span></span>
<span></span>
<span><span class="va">start</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html">proc.time</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># lưu lại thời điểm trước khi chạy read_csv</span></span>
<span><span class="va">dat</span><span class="op">&lt;-</span><span class="fu">read_csv</span><span class="op">(</span><span class="st">"test2.csv"</span><span class="op">)</span> <span class="co"># dùng hàm read_csv để load dữ liệu </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html">proc.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">start</span> <span class="co"># tính thời gian hàm read_csv chạy</span></span></code></pre></div>
<p>Trên máy tính của chúng tôi, hàm <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> sẽ mất khoảng 2 phút để đọc dữ liệu <code>test2.csv</code>, nghĩa là thời gian tiết kiêm lên đến hơn 10 lần. Ngoài hàm <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code>, thư viện <span class="math inline">\(\textbf{readr}\)</span> còn có các hàm để đọc các kiểu định dạng file khác nhau. Danh sách các hàm thường hay dùng được liệt kê trong bảng <a href="#tab:tbptdl002"><strong>??</strong></a></p>
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-18">Bảng 2.1: </span><span id="tab:unnamed-chunk-18">Bảng 2.2: </span>Danh sách hàm đọc dữ liệu của thư viện readr
</caption>
<thead><tr>
<th style="text-align:left;">
Hàm số
</th>
<th style="text-align:left;">
Sử dụng trong trường hợp
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
read_csv()
</td>
<td style="text-align:left;">
file dạng csv mà giá trị được ngăn cách bằng dấu ‘,’
</td>
</tr>
<tr>
<td style="text-align:left;">
read_csv2()
</td>
<td style="text-align:left;">
file dạng csv mà giá trị được ngăn cách bằng dấu ‘;’
</td>
</tr>
<tr>
<td style="text-align:left;">
read_tsv()
</td>
<td style="text-align:left;">
Các file dạng text mà các giá trị cách nhau bởi khoảng trống
</td>
</tr>
<tr>
<td style="text-align:left;">
read_delim()
</td>
<td style="text-align:left;">
Các file dạng text mà các giá trị cách nhau bởi ký tự bất kỳ
</td>
</tr>
</tbody>
</table></div>
<p>Một sự khác biệt cơ bản khác của các hàm đọc dữ liệu trong thư viện <span class="math inline">\(\textbf{readr}\)</span> đó là dữ liệu được lưu vào một tibble thay vì một data.frame. Điều này giúp cho dữ liệu không bị thay đổi định dạng và giữ nguyên tên cột. Các lưu ý khác khi bạn đọc sử dụng các hàm số đọc dữ liệu của thư viện <span class="math inline">\(\textbf{readr}\)</span> là</p>
<ul>
<li>Các hàm số trong thư viện <span class="math inline">\(\textbf{readr}\)</span> luôn hiểu hàng đầu tiên của dữ liệu là tên của mỗi cột. Do đó, bạn đọc cần sử dụng tham số <span class="math inline">\(col_names = FALSE\)</span> nếu không muốn R tự động hiểu hàng đầu tiên là tên của mỗi cột dữ liệu. Ví dụ, hãy quan sát sự khác nhau giữa việc có và không sử dụng <code>col_names = FALSE</code>:</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="co"># Kết quả sẽ là một Tibble 1 hàng và 3 cột</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"1,2,3 </span></span>
<span><span class="st">         4,5,6"</span><span class="op">)</span> <span class="co"># Tên các cột là "1", "2", và "3"</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##     `1`   `2`   `3`
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     4     5     6</code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Kết quả sẽ là một Tibble 2 hàng và 3 cột</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"1,2,3 </span></span>
<span><span class="st">         4,5,6"</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##      X1    X2    X3
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1     2     3
## 2     4     5     6</code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># readr tự động đặt tên các cột X1, X2, X3</span></span></code></pre></div>
<p>bạn đọc có thể thấy rằng khi không sử dụng <code>col_names = FALSE</code>, hàm <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> sẽ hiểu hàng đầu tiên, tương ứng với các số 1, 2, và 3, là tên các cột và hàng thứ hai là dữ liệu. Điều này giải thích tại sao tibble chỉ có 1 hàng. Khi chúng ta sử dụng <code>col_names = FALSE</code>, hàm <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> sẽ tự động đặt tên các cột là “X1”, “X2”, “X3” và dữ liệu sẽ có 2 hàng.</p>
<ul>
<li>Trong nhiều file dữ liệu, người gửi thường sử dụng các hàng đầu tiên để mô tả về dữ liệu. Do đó khi sử dụng các hàm trong thư viện <span class="math inline">\(\textbf{readr}\)</span>, bạn đọc có thể sử dụng tham số <code>skip = k</code> để loại bỏ <span class="math inline">\(k\)</span> dòng đầu tiên của file dữ liệu. Ví dụ:</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Kết quả sẽ là một Tibble 2 hàng và 3 cột</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Trường ĐHKTQD</span></span>
<span><span class="st">        Khoa toán Kinh tế</span></span>
<span><span class="st">         1,2,3 </span></span>
<span><span class="st">         4,5,6"</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span>, skip <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># readr sẽ không đọc 2 dòng đầu</span></span></code></pre></div>
<pre><code>## Rows: 2 Columns: 3
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: ","
## dbl (3): X1, X2, X3
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre><code>## # A tibble: 2 × 3
##      X1    X2    X3
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1     2     3
## 2     4     5     6</code></pre>
<p>Bạn đọc cũng có thể sử dụng tham số <span class="math inline">\(col_names\)</span> để gán giá trị cho tên các cột ngay trong hàm <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code>. Tuy nhiên để tránh sự phức tạp, chúng tôi khuyên bạn đọc hãy đặt tên cho các cột bằng hàm <code><a href="https://rdrr.io/r/base/names.html">names()</a></code> sau khi lưu dữ liệu vào tibble.</p>
<p>Cách sử dụng các hàm khác ngoài <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> bạn đọc có thể tham khảo trong hướng dẫn của thư viện <span class="math inline">\(\textbf{readr}\)</span>. Sau khi đọc qua hướng dẫn, bạn đọc hãy thử kiểm tra xem các câu lệnh sau có vấn đề gì và nếu có thể, bạn đọc hãy thử lựa chọn hàm hoặc thêm tham số phù hợp để đọc dữ liệu.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"x,y\n1,2,3\n4,5,6"</span><span class="op">)</span> <span class="co"># \n thay cho xuống dòng</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"x,y,z\n1,2\n1,2,3,4"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"x,y\n\",1,\n,a,b"</span>,col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"x;y\n1;2\nx;y"</span><span class="op">)</span> <span class="co"># Thử hàm số khác</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"x|y\n1|2"</span><span class="op">)</span> <span class="co"># Thử hàm số khác</span></span></code></pre></div>
</div>
<div id="tương-tác-giữa-r-với-microsoft-excel" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> Tương tác giữa R với Microsoft Excel<a class="anchor" aria-label="anchor" href="#t%C6%B0%C6%A1ng-t%C3%A1c-gi%E1%BB%AFa-r-v%E1%BB%9Bi-microsoft-excel"><i class="fas fa-link"></i></a>
</h2>
<p>Microsoft Excel là rất phổ biến trong môi trường làm việc công sở. Do đó, người phân tích dữ liệu thường xuyên nhận được dữ liệu trong các file có xls, xlsx, xlsb, hoặc xlsm. Tất nhiên, bạn đọc có thể sử dụng trực tiếp Microsoft Excel để thực hiện những phân tích và tính toán đơn giản. Nhưng để thực hiện các yêu cầu phức tạp hơn, chẳng hạn như làm việc với nhiều file Excel, hoặc thực hiện xây dựng các mô hình trên dữ liệu bạn đọc cần phải sử dụng R. Các thư viện cần cài đặt bổ sung mà chúng thôi thường sử dụng để kết nối giữa R với Microsoft Excel là thư viện <span class="math inline">\(\textbf{readxl}\)</span> và <span class="math inline">\(\textbf{openxlsx}\)</span>. Nếu như thư viện <span class="math inline">\(\textbf{readxl}\)</span> chỉ đơn thuần là để đọc dữ liệu từ Excel thì thư viện <span class="math inline">\(\textbf{openxlsx}\)</span> còn cho phép chúng ta điều khiển, tính toán, và định dạng các file có định dạnh ở trên mà không cần mở Microsoft Excel. Cách sử dụng các hàm cơ bản trong hai thư viện này được trình bày trong các phần dưới đây.</p>
<div id="đọc-dữ-liệu-lưu-dưới-định-dạng-của-excel" class="section level3" number="2.4.1">
<h3>
<span class="header-section-number">2.4.1</span> Đọc dữ liệu lưu dưới định dạng của Excel<a class="anchor" aria-label="anchor" href="#%C4%91%E1%BB%8Dc-d%E1%BB%AF-li%E1%BB%87u-l%C6%B0u-d%C6%B0%E1%BB%9Bi-%C4%91%E1%BB%8Bnh-d%E1%BA%A1ng-c%E1%BB%A7a-excel"><i class="fas fa-link"></i></a>
</h3>
<p>Hàm <code>read_excel()</code> được sử dụng để đọc các file được lưu bằng Microsoft Excel. Hàm số sẽ hỗ trợ đọc các file có định dạng xlsx, xlsm, xls. Hai biến thể khác của <code>read_excel()</code> là <code>read_xlsx()</code> và <code>read_xls()</code> được sử dụng khi chúng ta biết chính xác định dạng của file cần đọc. Các tham số thường được sử dụng trong các hàm này được liệt kê như sau:</p>
<ul>
<li><p><code>sheet</code> cho biết tên của sheet của excel workbook. Sử dụng tham số này có ý nghĩa khi workbook chúng ta cần lấy dữ liệu có nhiều sheet. Nếu không sử dụng tham số này, hàm <code>read_excel()</code> sẽ luôn luôn đọc dữ liệu trong sheet thứ nhất của excel workbook.</p></li>
<li><p><code>range</code> được sử dụng nếu bạn đọc chỉ muốn đọc dữ liệu từ một phần của của sheet. Chẳng hạn như <code>range = "A1:E100"</code> nghĩa là bạn đọc chỉ muốn lấy dữ liệu từ cell A1 đến cell E100 của sheet tương ứng.</p></li>
<li><p><code>col_names</code> nhận một trong hai giá trị là TRUE hoặc FALSE. Giá trị TRUE cho biết có sử dụng hàng đầu tiên làm tên các cột trong dữ liệu trong khi giá trị FALSE cho biết không lấy hàng đầu tiên làm tên cột.</p></li>
<li><p><code>skip</code> cho biết số lượng dòng sẽ bỏ qua trước khi bắt đầu đọc dữ liệu. Nếu có sử dụng tham số <code>range</code> thì hàm <code>read_excel()</code> sẽ bỏ qua tham số này.</p></li>
</ul>
<p>Ngoài ra hàm <code>read_excel()</code> còn có các tham số khác có thể hữu ích trong nhiều trường hợp như <code>col_types</code> hay <code>n_max</code>. Bạn đọc hãy đọc mô tả hàm số để hiểu chính xác hơn về các tham số. Đoạn lệnh dưới đây được sử dụng để đọc dữ liệu nằm trong range được giới hạn từ cell A1 đến cell E100, trong sheet có tên ws1, và workbook có tên “wb1.xlsx”</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span> <span class="co"># Đặt đường dẫn đến folder chứa file</span></span>
<span><span class="va">dat</span><span class="op">&lt;-</span><span class="fu">read_xlsx</span><span class="op">(</span><span class="st">"wb1.xlsx"</span>, </span>
<span>               sheet <span class="op">=</span> <span class="st">"ws1"</span>,</span>
<span>               range <span class="op">=</span> <span class="st">"A1:E100"</span>,</span>
<span>               col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="tương-tác-với-microsoft-excel-bằng-thư-viện-textbfopenxlsx" class="section level3" number="2.4.2">
<h3>
<span class="header-section-number">2.4.2</span> Tương tác với Microsoft Excel bằng thư viện <span class="math inline">\(\textbf{openxlsx}\)</span><a class="anchor" aria-label="anchor" href="#t%C6%B0%C6%A1ng-t%C3%A1c-v%E1%BB%9Bi-microsoft-excel-b%E1%BA%B1ng-th%C6%B0-vi%E1%BB%87n-textbfopenxlsx"><i class="fas fa-link"></i></a>
</h3>
<p>Ngoài việc lấy dữ liệu từ các file được lưu dưới định dạnh của Excel, bạn đọc cũng có thể sử dụng R để thực hiện tính toán ngay trên các worksheet và lưu lại kết quả mà không cần phải mở file. Thư viện <span class="math inline">\(openxlsx\)</span> sẽ giúp bạn đọc làm được việc này. Các hàm quan trọng sử dụng để làm việc trên các worksheet là: <code>loadWorkbook()</code>, <code>addWorksheet()</code> hàm <code>writeData()</code>, và hàm <code>saveWorkbook()</code>.</p>
<p>Hàm <code>loadWorkbook()</code> đượpc sử dụng để mở một workbook và lưu thành một đối tượng kiểu workbook trên R. Đoạn lệnh dưới đây dùng để lấy thông tin từ file có tên là “mau bd.xlsx” trong đường dẫn tương ứng và sau đó lưu thông tin vào một đối tượng kiểu workbook trên R có tên <span class="math inline">\(wb1\)</span>:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wb1</span><span class="op">&lt;-</span><span class="fu">loadWorkbook</span><span class="op">(</span><span class="st">"../KHDL_KTKD Final/Dataset/mau bd.xlsx"</span><span class="op">)</span></span></code></pre></div>
<p>Hàm <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> có thể sử dụng để xem cấu trúc của đối tượng wb1. Tuy nhiên các workbook lớn có thể làm cho kết quả của hàm <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> trở nên khó hiểu. Nhìn chung đối tượng kiểu workbook sẽ hoạt động tương đối giống như một list. Mỗi list con tương ứng với một sheet của workbook Bạn đọc có thể sử dụng hàm <code><a href="https://rdrr.io/r/base/names.html">names()</a></code> để biết wb1 có những sheet nào:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">wb1</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Workbook"
## attr(,"package")
## [1] "openxlsx"</code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">wb1</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] "Sheet"  "Sheet1"</code></pre>
<p>Hàm <code>addWorksheet()</code> được sử dụng để thêm một worksheet vào trong một đối tượng workbook. Cấu trúc câu lệnh của hàm <code>addWworksheet()</code> khá đơn giản và các tham số được sử dụng chủ yếu là để thiết kế worksheet mới thêm vào nên chúng tôi không liệt kê ở đây. Đoạn câu lệnh sau được sử dụng để thêm vào workbook wb1 một worksheet có tên là “Sheet 2”</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">addWorksheet</span><span class="op">(</span><span class="va">wb1</span>, <span class="st">"Sheet 2"</span><span class="op">)</span></span></code></pre></div>
<p>Hàm <code>writeData()</code> được sử dụng để thay đổi và sửa thông tin trên đối tượng workbook. Các tham số quan trọng với hàm <code>writeData()</code> được liệt kê ở dưới đây:</p>
<ul>
<li><p><code>startCol</code>: chỉ số của cột trên worksheet mà chúng ta bắt đầu ghi thông tin lên. Nếu không sử dụng tham số này, chỉ số cột đầu tiên sẽ luôn là 1, nghĩa là cột A của workssheet.</p></li>
<li><p><code>statRow</code>: chỉ số của hàng trên worksheet mà chúng ta bắt đầu ghi thông tin lên. Nếu không sử dụng tham số này, chỉ số hàng đầu tiên sẽ luôn là 1.</p></li>
<li><p><code>colNames</code>: nhận giá trị bằng TRUE hoặc FALSE. Giá trị TRUE cho biết có ghi nhận thông tin tên cột của dữ liệu (hoặc véc-tơ) vào hàng đầu tiên. Giá trị FALSE nghĩa là không ghi nhận tên cột của dữ liệu hay véc-tơ vào hàng đầu tiên.</p></li>
<li><p><code>rowNames</code>: : nhận giá trị bằng TRUE hoặc FALSE. Giá trị TRUE cho biết có ghi nhận thông tin tên hàng của dữ liệu (hoặc véc-tơ) vào cột đầu tiên của worksheet. Giá trị FALSE nghĩa là không ghi nhận tên hàng của dữ liệu hay véc-tơ vào hàng đầu tiên của worksheet.</p></li>
</ul>
<p>Đoạn câu lệnh sau sẽ lưu thông tin của một data.frame có tên là <span class="math inline">\(\textbf{women}\)</span> bắt đầu từ hàng thứ nhất, cột thứ nhất (cell A1) vào sheet có tên là “Sheet 2” của workbook wb1:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">writeData</span><span class="op">(</span><span class="va">wb1</span>, <span class="st">"Sheet 2"</span>, <span class="va">women</span>, startCol <span class="op">=</span> <span class="fl">1</span>, startRow <span class="op">=</span> <span class="fl">1</span>, colNames <span class="op">=</span> <span class="cn">TRUE</span>, rowNames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Hàm số <code>saveWorkbook()</code> được sử dụng để lưu một đối tượng workbook (của R) thành một excel workbook.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">saveWorkbook</span><span class="op">(</span><span class="va">wb1</span>, <span class="st">"mau bd1.xlsx"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Bạn đọc có thể sử dụng Microsoft excel để mở workbook có tên “mau bd1.xlsx” và xem thông tin về dữ liệu <span class="math inline">\(\textbf{women}\)</span> ở trong worksheet có tên là “Sheet 2” của workbook này. Tham số <code>overwrite</code> nhận giá trị TRUE có nghĩa là nếu trong đường dẫn tương ứng đã có file có tên trùng với tên workbook mới thì sẽ lưu workbook mới thay thế cho workbook cũ có trùng tên.</p>
</div>
</div>
<div id="kết-nối-r-với-cơ-sở-dữ-liệu" class="section level2" number="2.5">
<h2>
<span class="header-section-number">2.5</span> Kết nối R với cơ sở dữ liệu<a class="anchor" aria-label="anchor" href="#k%E1%BA%BFt-n%E1%BB%91i-r-v%E1%BB%9Bi-c%C6%A1-s%E1%BB%9F-d%E1%BB%AF-li%E1%BB%87u"><i class="fas fa-link"></i></a>
</h2>
<p>Có thể sử dụng R như một công cụ để kết nối và thực hiện các câu lệnh truy vấn vào các cơ sở dữ liệu. Để làm được điều này, trước tiên, bạn đọc cần phải cài đặt một Open Database Connectivity (ODBC), được gọi là kết nối cơ sở dữ liệu mở. Kết nối này giúp cho hệ điều hành máy tính tương thích với hệ quản lý cơ sở dữ liệu mà bạn sử dụng. Nhóm tác giả sử dụng hệ điều hành Windows và hệ quản trị cơ sở dữ liệu MySQL nên chúng tôi sẽ lựa chọn ODBC phù hợp. Bạn đọc tham khảo tại địa chỉ <a href="https://dev.mysql.com/downloads/connector/odbc/" class="uri">https://dev.mysql.com/downloads/connector/odbc/</a>. Tại thời điểm nhóm tác giả viết cuốn sách này ODBC cho hệ điều hành Windows đang là phiên bản 8.0</p>
<p>Sau khi cài đặt ODBC lên hệ điều hành, bạn đọc đã có thể sử dụng R để truy cập vào một cơ sở dữ liệu và thực hiện các câu lệnh truy vấn dữ liệu trên cơ sở dữ liệu đó trên R với sự trợ giúp của thư viện <span class="math inline">\(DBI\)</span>. Sau khi cài đặt thư viện <span class="math inline">\(DBI\)</span>, bạn đọc cần tạo một kết nối giữa R và cơ sở dữ liệu bằng hàm <span class="math inline">\(dbConnect\)</span>.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org">DBI</a></span><span class="op">)</span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html">dbConnect</a></span><span class="op">(</span><span class="fu">odbc</span><span class="fu">::</span><span class="fu">odbc</span><span class="op">(</span><span class="op">)</span>, .connection_string <span class="op">=</span> <span class="st">"Driver={MySQL ODBC 8.0 Unicode Driver};"</span>, </span>
<span>    Server <span class="op">=</span> <span class="st">"ten_serve"</span>, Database <span class="op">=</span> <span class="st">"db_name"</span>, UID <span class="op">=</span> <span class="st">"ID"</span>, PWD <span class="op">=</span> <span class="st">"password"</span><span class="op">)</span></span></code></pre></div>
<p>Trong đó “ten_serve” là địa chỉ local hoặc server lưu trữ cơ sở dữ liệu, “db_name” là tên của cơ sở dữ liệu, ID và password lần lượt là tên và password mà bạn đọc tự tạo hoặc được cấp để truy cập vào cơ sở dữ liệu. Sau khi đã tạo được kết nối, bạn đọc có thể thực hiện bất kỳ câu lệnh truy vấn dữ liệu nào từ R với hàm “DBI::dbGetQuery()”. Chẳng hạn, bạn đọc muốn lấy ra thông tin của tất cả những người có ngày sinh là ngày 01 tháng 01 năm 2000 từ một bảng có tên là Life_Insured từ một cơ sở dữ liệu tên là <span class="math inline">\(tktdb\)</span>, bạn đọc thực hiện như sau</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sql</span><span class="op">&lt;-</span><span class="st">"select * from tktdb.Life_Insured </span></span>
<span><span class="st">      where DOB = '2000-01-01'"</span> <span class="co"># Viết đúng câu lệnh truy vấn từ MySQL</span></span>
<span><span class="va">df</span><span class="op">&lt;-</span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html">dbGetQuery</a></span><span class="op">(</span><span class="va">sql</span><span class="op">)</span> <span class="co"># data.frame df sẽ lưu kết quả của câu lệnh truy vấn</span></span></code></pre></div>
<p>Khi làm việc với dữ liệu được trích xuất từ một hệ cơ sở dữ liệu, bạn đọc hãy cố gắng thực hiện các phép biến đổi, sắp xếp dữ liệu bằng SQL thay vì thực hiện biến đổi trên R vì các hệ quản trị cơ sở dữ liệu thực hiện các chức năng này nhanh hơn.</p>
</div>
<div id="thu-thập-dữ-liệu-từ-các-website" class="section level2" number="2.6">
<h2>
<span class="header-section-number">2.6</span> Thu thập dữ liệu từ các website<a class="anchor" aria-label="anchor" href="#thu-th%E1%BA%ADp-d%E1%BB%AF-li%E1%BB%87u-t%E1%BB%AB-c%C3%A1c-website"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="phụ-lục" class="section level2" number="2.7">
<h2>
<span class="header-section-number">2.7</span> Phụ lục<a class="anchor" aria-label="anchor" href="#ph%E1%BB%A5-l%E1%BB%A5c"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="bài-tập" class="section level2" number="2.8">
<h2>
<span class="header-section-number">2.8</span> Bài tập<a class="anchor" aria-label="anchor" href="#b%C3%A0i-t%E1%BA%ADp"><i class="fas fa-link"></i></a>
</h2>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="gi%E1%BB%9Bi-thi%E1%BB%87u-chung.html"><span class="header-section-number">1</span> Giới thiệu chung</a></div>
<div class="next"><a href="ti%E1%BB%81n-x%E1%BB%AD-l%C3%BD-d%E1%BB%AF-li%E1%BB%87u.html"><span class="header-section-number">3</span> Tiền xử lý dữ liệu</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#nh%E1%BA%ADp-d%E1%BB%AF-li%E1%BB%87u-v%C3%A0o-ph%E1%BA%A7n-m%E1%BB%81m-r"><span class="header-section-number">2</span> Nhập dữ liệu vào phần mềm R</a></li>
<li>
<a class="nav-link" href="#%C4%91%E1%BB%91i-t%C6%B0%E1%BB%A3ng-d%C3%B9ng-%C4%91%E1%BB%83-l%C6%B0u-d%E1%BB%AF-li%E1%BB%87u-trong-r"><span class="header-section-number">2.1</span> Đối tượng dùng để lưu dữ liệu trong R</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#data.frame-l%C3%A0-g%C3%AC"><span class="header-section-number">2.1.1</span> data.frame là gì?</a></li>
<li><a class="nav-link" href="#tibble-l%C3%A0-m%E1%BB%99t-c%E1%BA%A3i-ti%E1%BA%BFn-c%E1%BB%A7a-data.frame"><span class="header-section-number">2.1.2</span> \(tibble\) là một cải tiến của data.frame?</a></li>
</ul>
</li>
<li><a class="nav-link" href="#nh%E1%BA%ADp-d%E1%BB%AF-li%E1%BB%87u-b%E1%BA%B1ng-h%C3%A0m-s%E1%BA%B5n-c%C3%B3."><span class="header-section-number">2.2</span> Nhập dữ liệu bằng hàm sẵn có.</a></li>
<li><a class="nav-link" href="#nh%E1%BA%ADp-d%E1%BB%AF-li%E1%BB%87u-b%E1%BA%B1ng-th%C6%B0-vi%E1%BB%87n-textbfreadr."><span class="header-section-number">2.3</span> Nhập dữ liệu bằng thư viện \(\textbf{readr}\).</a></li>
<li>
<a class="nav-link" href="#t%C6%B0%C6%A1ng-t%C3%A1c-gi%E1%BB%AFa-r-v%E1%BB%9Bi-microsoft-excel"><span class="header-section-number">2.4</span> Tương tác giữa R với Microsoft Excel</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%C4%91%E1%BB%8Dc-d%E1%BB%AF-li%E1%BB%87u-l%C6%B0u-d%C6%B0%E1%BB%9Bi-%C4%91%E1%BB%8Bnh-d%E1%BA%A1ng-c%E1%BB%A7a-excel"><span class="header-section-number">2.4.1</span> Đọc dữ liệu lưu dưới định dạng của Excel</a></li>
<li><a class="nav-link" href="#t%C6%B0%C6%A1ng-t%C3%A1c-v%E1%BB%9Bi-microsoft-excel-b%E1%BA%B1ng-th%C6%B0-vi%E1%BB%87n-textbfopenxlsx"><span class="header-section-number">2.4.2</span> Tương tác với Microsoft Excel bằng thư viện \(\textbf{openxlsx}\)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#k%E1%BA%BFt-n%E1%BB%91i-r-v%E1%BB%9Bi-c%C6%A1-s%E1%BB%9F-d%E1%BB%AF-li%E1%BB%87u"><span class="header-section-number">2.5</span> Kết nối R với cơ sở dữ liệu</a></li>
<li><a class="nav-link" href="#thu-th%E1%BA%ADp-d%E1%BB%AF-li%E1%BB%87u-t%E1%BB%AB-c%C3%A1c-website"><span class="header-section-number">2.6</span> Thu thập dữ liệu từ các website</a></li>
<li><a class="nav-link" href="#ph%E1%BB%A5-l%E1%BB%A5c"><span class="header-section-number">2.7</span> Phụ lục</a></li>
<li><a class="nav-link" href="#b%C3%A0i-t%E1%BA%ADp"><span class="header-section-number">2.8</span> Bài tập</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/NEUKhoaToanKT/Khoa_hoc_du_lieu_trong_KTKD/blob/master/08-phan-tich-du-lieu-bang-R.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/NEUKhoaToanKT/Khoa_hoc_du_lieu_trong_KTKD/edit/master/08-phan-tich-du-lieu-bang-R.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Khoa Học Dữ Liệu trong Kinh tế và Kinh doanh</strong>" was written by Nguyễn Quang Huy. It was last built on 2024-07-23.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
